(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../../assets/mesh.js", "../../data/class-decorator.js", "../../math/index.js", "../../renderer/scene/model.js", "../../renderer/models/morph-model.js", "../../scene-graph/node-enum.js", "../../value-types/index.js", "../builtin/index.js", "./renderable-component.js", "../../data/utils/asserts.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../../assets/mesh.js"), require("../../data/class-decorator.js"), require("../../math/index.js"), require("../../renderer/scene/model.js"), require("../../renderer/models/morph-model.js"), require("../../scene-graph/node-enum.js"), require("../../value-types/index.js"), require("../builtin/index.js"), require("./renderable-component.js"), require("../../data/utils/asserts.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.mesh, global.classDecorator, global.index, global.model, global.morphModel, global.nodeEnum, global.index, global.index, global.renderableComponent, global.asserts);
    global.modelComponent = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _mesh, _classDecorator, _index, _model, _morphModel, _nodeEnum, _index2, _index3, _renderableComponent, _asserts) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ModelComponent = void 0;

  var _dec, _dec2, _dec3, _dec4, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _temp, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _class4, _class5, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _class6, _temp2;

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  /**
   * @en Shadow projection mode.
   * @zh 阴影投射方式。
   */
  var ModelShadowCastingMode = (0, _index2.Enum)({
    /**
     * @zh Disable shadow projection.
     * @zh 不投射阴影。
     */
    OFF: 0,

    /**
     * @zh Enable shadow projection.
     * @zh 开启阴影投射。
     */
    ON: 1
  });
  /**
   * @en model light map settings.
   * @zh 模型光照图设置
   */

  var ModelLightmapSettings = (_dec = (0, _classDecorator.ccclass)('cc.ModelLightmapSettings'), _dec2 = (0, _classDecorator.property)({
    visible: false
  }), _dec3 = (0, _classDecorator.property)({
    visible: false
  }), _dec4 = (0, _classDecorator.property)({
    formerlySerializedAs: '_recieveShadow'
  }), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function () {
    function ModelLightmapSettings() {
      _classCallCheck(this, ModelLightmapSettings);

      _initializerDefineProperty(this, "texture", _descriptor, this);

      _initializerDefineProperty(this, "uvParam", _descriptor2, this);

      _initializerDefineProperty(this, "_bakeable", _descriptor3, this);

      _initializerDefineProperty(this, "_castShadow", _descriptor4, this);

      _initializerDefineProperty(this, "_receiveShadow", _descriptor5, this);

      _initializerDefineProperty(this, "_lightmapSize", _descriptor6, this);
    }

    _createClass(ModelLightmapSettings, [{
      key: "bakeable",

      /**
       * @en bakeable.
       * @zh 是否可烘培。
       */
      get: function get() {
        return this._bakeable;
      },
      set: function set(val) {
        this._bakeable = val;
      }
      /**
       * @en cast shadow.
       * @zh 是否投射阴影。
       */

    }, {
      key: "castShadow",
      get: function get() {
        return this._castShadow;
      },
      set: function set(val) {
        this._castShadow = val;
      }
      /**
       * @en receive shadow.
       * @zh 是否接受阴影。
       */

    }, {
      key: "receiveShadow",
      get: function get() {
        return this._receiveShadow;
      },
      set: function set(val) {
        this._receiveShadow = val;
      }
      /**
       * @en lightmap size.
       * @zh 光照图大小
       */

    }, {
      key: "lightmapSize",
      get: function get() {
        return this._lightmapSize;
      },
      set: function set(val) {
        this._lightmapSize = val;
      }
    }]);

    return ModelLightmapSettings;
  }(), _temp), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "texture", [_dec2], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "uvParam", [_dec3], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return new _index.Vec4();
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_bakeable", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "_castShadow", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "_receiveShadow", [_dec4], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "_lightmapSize", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 64;
    }
  }), _applyDecoratedDescriptor(_class2.prototype, "bakeable", [_classDecorator.property], Object.getOwnPropertyDescriptor(_class2.prototype, "bakeable"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "castShadow", [_classDecorator.property], Object.getOwnPropertyDescriptor(_class2.prototype, "castShadow"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "receiveShadow", [_classDecorator.property], Object.getOwnPropertyDescriptor(_class2.prototype, "receiveShadow"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "lightmapSize", [_classDecorator.property], Object.getOwnPropertyDescriptor(_class2.prototype, "lightmapSize"), _class2.prototype)), _class2)) || _class);
  /**
   * 模型组件。
   * @class ModelComponent
   */

  var ModelComponent = (_dec5 = (0, _classDecorator.ccclass)('cc.ModelComponent'), _dec6 = (0, _classDecorator.help)('i18n:cc.ModelComponent'), _dec7 = (0, _classDecorator.executionOrder)(100), _dec8 = (0, _classDecorator.menu)('Components/Model'), _dec9 = (0, _classDecorator.property)({
    type: ModelShadowCastingMode,
    tooltip: 'i18n:model.shadow_casting_model'
  }), _dec10 = (0, _classDecorator.property)({
    type: _mesh.Mesh,
    tooltip: 'i18n:model.mesh'
  }), _dec11 = (0, _classDecorator.property)({
    visible: function visible() {
      return !!(this.mesh && this.mesh.struct.morph && this.mesh.struct.morph.subMeshMorphs.some(function (subMeshMorph) {
        return !!subMeshMorph;
      }));
    }
  }), _dec5(_class4 = _dec6(_class4 = _dec7(_class4 = _dec8(_class4 = (0, _classDecorator.executeInEditMode)(_class4 = (_class5 = (_temp2 = _class6 = /*#__PURE__*/function (_RenderableComponent) {
    _inherits(ModelComponent, _RenderableComponent);

    _createClass(ModelComponent, [{
      key: "shadowCastingMode",

      /**
       * @en Shadow projection mode.
       * @zh 阴影投射方式。
       */
      get: function get() {
        return this._shadowCastingMode;
      },
      set: function set(val) {
        this._shadowCastingMode = val;

        this._updateCastShadow();
      }
      /**
       * @en The mesh of the model.
       * @zh 模型的网格数据。
       */

    }, {
      key: "mesh",
      get: function get() {
        return this._mesh;
      },
      set: function set(val) {
        var _this$_mesh;

        var old = this._mesh;
        this._mesh = val;
        (_this$_mesh = this._mesh) === null || _this$_mesh === void 0 ? void 0 : _this$_mesh.initialize();

        this._watchMorphInMesh();

        this._onMeshChanged(old);

        this._updateModels();

        if (this.enabledInHierarchy) {
          this._attachToScene();
        }
      }
    }, {
      key: "model",
      get: function get() {
        return this._model;
      }
    }, {
      key: "enableMorph",
      get: function get() {
        return this._enableMorph;
      },
      set: function set(value) {
        this._enableMorph = value;
      }
    }]);

    function ModelComponent() {
      var _this;

      _classCallCheck(this, ModelComponent);

      _this = _possibleConstructorReturn(this, _getPrototypeOf(ModelComponent).call(this));

      _initializerDefineProperty(_this, "lightmapSettings", _descriptor7, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_mesh", _descriptor8, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_shadowCastingMode", _descriptor9, _assertThisInitialized(_this));

      _this._modelType = void 0;
      _this._model = null;
      _this._morphInstance = null;

      _initializerDefineProperty(_this, "_enableMorph", _descriptor10, _assertThisInitialized(_this));

      _this._modelType = _model.Model;
      return _this;
    }

    _createClass(ModelComponent, [{
      key: "onLoad",
      value: function onLoad() {
        var _this$_mesh2;

        (_this$_mesh2 = this._mesh) === null || _this$_mesh2 === void 0 ? void 0 : _this$_mesh2.initialize();

        this._watchMorphInMesh();

        this._updateModels();

        this._updateCastShadow();
      } // Redo, Undo, Prefab restore, etc.

    }, {
      key: "onRestore",
      value: function onRestore() {
        this._updateModels();
      }
    }, {
      key: "onEnable",
      value: function onEnable() {
        if (!this._model) {
          this._updateModels();
        }

        this._attachToScene();
      }
    }, {
      key: "onDisable",
      value: function onDisable() {
        if (this._model) {
          this._detachFromScene();
        }
      }
    }, {
      key: "onDestroy",
      value: function onDestroy() {
        if (this._model) {
          cc.director.root.destroyModel(this._model);
          this._model = null;
          this._models.length = 0;
        }

        if (this._morphInstance) {
          this._morphInstance.destroy();
        }
      }
    }, {
      key: "setWeights",
      value: function setWeights(weights, subMeshIndex) {
        if (this._morphInstance) {
          this._morphInstance.setWeights(subMeshIndex, weights);
        }
      }
    }, {
      key: "setInstancedAttribute",
      value: function setInstancedAttribute(name, value) {
        if (!this.model) {
          return;
        }

        var list = this.model.instancedAttributes.list;

        for (var i = 0; i < list.length; i++) {
          if (list[i].name === name) {
            list[i].view.set(value);
            break;
          }
        }
      }
    }, {
      key: "_updateLightmap",
      value: function _updateLightmap(lightmap, uOff, vOff, uScale, vScale) {
        this.lightmapSettings.texture = lightmap;
        this.lightmapSettings.uvParam.x = uOff;
        this.lightmapSettings.uvParam.y = vOff;
        this.lightmapSettings.uvParam.z = uScale;
        this.lightmapSettings.uvParam.w = vScale;

        if (this.model !== null) {
          this.model.updateLightingmap(this.lightmapSettings.texture, this.lightmapSettings.uvParam);
        }
      }
    }, {
      key: "_updateModels",
      value: function _updateModels() {
        if (!this.enabledInHierarchy || !this._mesh) {
          return;
        }

        if (this._model) {
          this._model.destroy();

          this._model.initialize(this.node);
        } else {
          this._createModel();
        }

        this._updateModelParams();

        if (this.model != null) {
          this.model.updateLightingmap(this.lightmapSettings.texture, this.lightmapSettings.uvParam);
        }
      }
    }, {
      key: "_createModel",
      value: function _createModel() {
        var preferMorphOverPlain = !!this._morphInstance; // Note we only change to use `MorphModel` if
        // we are required to render morph and the `this._modelType` is exactly the basic `Model`.
        // We do this since the `this._modelType` might be changed in classes derived from `ModelComponent`.
        // We shall not overwrite it.
        // Please notice that we do not enforce that
        // derived classes should use a morph-able model type(i.e. model type derived from `MorphModel`).
        // So we should take care of the edge case.

        var modelType = preferMorphOverPlain && this._modelType === _model.Model ? _morphModel.MorphModel : this._modelType;
        this._model = cc.director.root.createModel(modelType);
        this._model.visFlags = this.visibility;

        this._model.initialize(this.node);

        this._models.length = 0;

        this._models.push(this._model);

        if (this._morphInstance && this._model instanceof _morphModel.MorphModel) {
          this._model.setMorphRendering(this._morphInstance);
        }
      }
    }, {
      key: "_attachToScene",
      value: function _attachToScene() {
        if (!this.node.scene || !this._model) {
          return;
        }

        var scene = this._getRenderScene();

        if (this._model.scene != null) {
          this._detachFromScene();
        }

        scene.addModel(this._model);
      }
    }, {
      key: "_detachFromScene",
      value: function _detachFromScene() {
        if (this._model && this._model.scene) {
          this._model.scene.removeModel(this._model);
        }
      }
    }, {
      key: "_updateModelParams",
      value: function _updateModelParams() {
        if (!this._mesh || !this._model) {
          return;
        }

        this.node.hasChangedFlags |= _nodeEnum.TransformBit.POSITION;
        this._model.transform.hasChangedFlags |= _nodeEnum.TransformBit.POSITION;
        this._model.isDynamicBatching = this._isBatchingEnabled();
        var meshCount = this._mesh ? this._mesh.subMeshCount : 0;
        var renderingMesh = this._mesh.renderingSubMeshes;

        if (renderingMesh) {
          for (var i = 0; i < meshCount; ++i) {
            var material = this.getRenderMaterial(i);
            var subMeshData = renderingMesh[i];

            if (subMeshData) {
              this._model.initSubModel(i, subMeshData, material || this._getBuiltinMaterial());
            }
          }
        }

        this._model.createBoundingShape(this._mesh.minPosition, this._mesh.maxPosition);

        this._model.enabled = true;
      }
    }, {
      key: "_onMaterialModified",
      value: function _onMaterialModified(idx, material) {
        if (!this._model || !this._model.inited) {
          return;
        }

        this._onRebuildPSO(idx, material || this._getBuiltinMaterial());
      }
    }, {
      key: "_onRebuildPSO",
      value: function _onRebuildPSO(idx, material) {
        if (!this._model || !this._model.inited) {
          return;
        }

        this._model.isDynamicBatching = this._isBatchingEnabled();

        this._model.setSubModelMaterial(idx, material);

        this._model.updateLightingmap(this.lightmapSettings.texture, this.lightmapSettings.uvParam);
      }
    }, {
      key: "_onMeshChanged",
      value: function _onMeshChanged(old) {}
    }, {
      key: "_clearMaterials",
      value: function _clearMaterials() {
        if (!this._model) {
          return;
        }

        for (var i = 0; i < this._model.subModelNum; ++i) {
          this._onMaterialModified(i, null);
        }
      }
    }, {
      key: "_getBuiltinMaterial",
      value: function _getBuiltinMaterial() {
        // classic ugly pink indicating missing material
        return _index3.builtinResMgr.get('missing-material');
      }
    }, {
      key: "_onVisibilityChange",
      value: function _onVisibilityChange(val) {
        if (!this._model) {
          return;
        }

        this._model.visFlags = val;
      }
    }, {
      key: "_updateCastShadow",
      value: function _updateCastShadow() {
        if (!this._model) {
          return;
        }

        if (this._shadowCastingMode === ModelShadowCastingMode.OFF) {
          this._model.castShadow = false;
        } else {
          (0, _asserts.assertIsTrue)(this._shadowCastingMode === ModelShadowCastingMode.ON, "ShadowCastingMode ".concat(this._shadowCastingMode, " is not supported."));
          this._model.castShadow = true;
        }
      }
    }, {
      key: "_isBatchingEnabled",
      value: function _isBatchingEnabled() {
        for (var i = 0; i < this._materials.length; ++i) {
          var mat = this._materials[i];

          if (!mat) {
            continue;
          }

          for (var p = 0; p < mat.passes.length; ++p) {
            var pass = mat.passes[p];

            if (pass.instancedBuffer || pass.batchedBuffer) {
              return true;
            }
          }
        }

        return false;
      }
    }, {
      key: "_watchMorphInMesh",
      value: function _watchMorphInMesh() {
        if (this._morphInstance) {
          this._morphInstance.destroy();

          this._morphInstance = null;
        }

        if (!this._enableMorph) {
          return;
        }

        if (!this._mesh || !this._mesh.struct.morph || !this._mesh.morphRendering) {
          return;
        }

        var morph = this._mesh.struct.morph;
        this._morphInstance = this._mesh.morphRendering.createInstance();
        var nSubMeshes = this._mesh.struct.primitives.length;

        for (var iSubMesh = 0; iSubMesh < nSubMeshes; ++iSubMesh) {
          var subMeshMorph = morph.subMeshMorphs[iSubMesh];

          if (!subMeshMorph) {
            continue;
          }

          var initialWeights = subMeshMorph.weights || morph.weights;
          var weights = initialWeights ? initialWeights.slice() : new Array(subMeshMorph.targets.length).fill(0);

          this._morphInstance.setWeights(iSubMesh, weights);
        }

        if (this._model && this._model instanceof _morphModel.MorphModel) {
          this._model.setMorphRendering(this._morphInstance);
        }
      }
    }, {
      key: "_syncMorphWeights",
      value: function _syncMorphWeights(subMeshIndex) {
        if (!this._morphInstance) {
          return;
        }

        var subMeshMorphInstance = this._morphInstance[subMeshIndex];

        if (!subMeshMorphInstance || !subMeshMorphInstance.renderResources) {
          return;
        }

        subMeshMorphInstance.renderResources.setWeights(subMeshMorphInstance.weights);
      }
    }]);

    return ModelComponent;
  }(_renderableComponent.RenderableComponent), _class6.ShadowCastingMode = ModelShadowCastingMode, _temp2), (_descriptor7 = _applyDecoratedDescriptor(_class5.prototype, "lightmapSettings", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return new ModelLightmapSettings();
    }
  }), _descriptor8 = _applyDecoratedDescriptor(_class5.prototype, "_mesh", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  }), _descriptor9 = _applyDecoratedDescriptor(_class5.prototype, "_shadowCastingMode", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return ModelShadowCastingMode.OFF;
    }
  }), _applyDecoratedDescriptor(_class5.prototype, "shadowCastingMode", [_dec9], Object.getOwnPropertyDescriptor(_class5.prototype, "shadowCastingMode"), _class5.prototype), _applyDecoratedDescriptor(_class5.prototype, "mesh", [_dec10], Object.getOwnPropertyDescriptor(_class5.prototype, "mesh"), _class5.prototype), _applyDecoratedDescriptor(_class5.prototype, "enableMorph", [_dec11], Object.getOwnPropertyDescriptor(_class5.prototype, "enableMorph"), _class5.prototype), _descriptor10 = _applyDecoratedDescriptor(_class5.prototype, "_enableMorph", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return true;
    }
  })), _class5)) || _class4) || _class4) || _class4) || _class4) || _class4);
  _exports.ModelComponent = ModelComponent;

  (function (_ModelComponent) {})(ModelComponent || (_exports.ModelComponent = ModelComponent = {}));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvY29yZS8zZC9mcmFtZXdvcmsvbW9kZWwtY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbIk1vZGVsU2hhZG93Q2FzdGluZ01vZGUiLCJPRkYiLCJPTiIsIk1vZGVsTGlnaHRtYXBTZXR0aW5ncyIsInZpc2libGUiLCJmb3JtZXJseVNlcmlhbGl6ZWRBcyIsIl9iYWtlYWJsZSIsInZhbCIsIl9jYXN0U2hhZG93IiwiX3JlY2VpdmVTaGFkb3ciLCJfbGlnaHRtYXBTaXplIiwiVmVjNCIsInByb3BlcnR5IiwiTW9kZWxDb21wb25lbnQiLCJ0eXBlIiwidG9vbHRpcCIsIk1lc2giLCJtZXNoIiwic3RydWN0IiwibW9ycGgiLCJzdWJNZXNoTW9ycGhzIiwic29tZSIsInN1Yk1lc2hNb3JwaCIsImV4ZWN1dGVJbkVkaXRNb2RlIiwiX3NoYWRvd0Nhc3RpbmdNb2RlIiwiX3VwZGF0ZUNhc3RTaGFkb3ciLCJfbWVzaCIsIm9sZCIsImluaXRpYWxpemUiLCJfd2F0Y2hNb3JwaEluTWVzaCIsIl9vbk1lc2hDaGFuZ2VkIiwiX3VwZGF0ZU1vZGVscyIsImVuYWJsZWRJbkhpZXJhcmNoeSIsIl9hdHRhY2hUb1NjZW5lIiwiX21vZGVsIiwiX2VuYWJsZU1vcnBoIiwidmFsdWUiLCJfbW9kZWxUeXBlIiwiX21vcnBoSW5zdGFuY2UiLCJNb2RlbCIsIl9kZXRhY2hGcm9tU2NlbmUiLCJjYyIsImRpcmVjdG9yIiwicm9vdCIsImRlc3Ryb3lNb2RlbCIsIl9tb2RlbHMiLCJsZW5ndGgiLCJkZXN0cm95Iiwid2VpZ2h0cyIsInN1Yk1lc2hJbmRleCIsInNldFdlaWdodHMiLCJuYW1lIiwibW9kZWwiLCJsaXN0IiwiaW5zdGFuY2VkQXR0cmlidXRlcyIsImkiLCJ2aWV3Iiwic2V0IiwibGlnaHRtYXAiLCJ1T2ZmIiwidk9mZiIsInVTY2FsZSIsInZTY2FsZSIsImxpZ2h0bWFwU2V0dGluZ3MiLCJ0ZXh0dXJlIiwidXZQYXJhbSIsIngiLCJ5IiwieiIsInciLCJ1cGRhdGVMaWdodGluZ21hcCIsIm5vZGUiLCJfY3JlYXRlTW9kZWwiLCJfdXBkYXRlTW9kZWxQYXJhbXMiLCJwcmVmZXJNb3JwaE92ZXJQbGFpbiIsIm1vZGVsVHlwZSIsIk1vcnBoTW9kZWwiLCJjcmVhdGVNb2RlbCIsInZpc0ZsYWdzIiwidmlzaWJpbGl0eSIsInB1c2giLCJzZXRNb3JwaFJlbmRlcmluZyIsInNjZW5lIiwiX2dldFJlbmRlclNjZW5lIiwiYWRkTW9kZWwiLCJyZW1vdmVNb2RlbCIsImhhc0NoYW5nZWRGbGFncyIsIlRyYW5zZm9ybUJpdCIsIlBPU0lUSU9OIiwidHJhbnNmb3JtIiwiaXNEeW5hbWljQmF0Y2hpbmciLCJfaXNCYXRjaGluZ0VuYWJsZWQiLCJtZXNoQ291bnQiLCJzdWJNZXNoQ291bnQiLCJyZW5kZXJpbmdNZXNoIiwicmVuZGVyaW5nU3ViTWVzaGVzIiwibWF0ZXJpYWwiLCJnZXRSZW5kZXJNYXRlcmlhbCIsInN1Yk1lc2hEYXRhIiwiaW5pdFN1Yk1vZGVsIiwiX2dldEJ1aWx0aW5NYXRlcmlhbCIsImNyZWF0ZUJvdW5kaW5nU2hhcGUiLCJtaW5Qb3NpdGlvbiIsIm1heFBvc2l0aW9uIiwiZW5hYmxlZCIsImlkeCIsImluaXRlZCIsIl9vblJlYnVpbGRQU08iLCJzZXRTdWJNb2RlbE1hdGVyaWFsIiwic3ViTW9kZWxOdW0iLCJfb25NYXRlcmlhbE1vZGlmaWVkIiwiYnVpbHRpblJlc01nciIsImdldCIsImNhc3RTaGFkb3ciLCJfbWF0ZXJpYWxzIiwibWF0IiwicCIsInBhc3NlcyIsInBhc3MiLCJpbnN0YW5jZWRCdWZmZXIiLCJiYXRjaGVkQnVmZmVyIiwibW9ycGhSZW5kZXJpbmciLCJjcmVhdGVJbnN0YW5jZSIsIm5TdWJNZXNoZXMiLCJwcmltaXRpdmVzIiwiaVN1Yk1lc2giLCJpbml0aWFsV2VpZ2h0cyIsInNsaWNlIiwiQXJyYXkiLCJ0YXJnZXRzIiwiZmlsbCIsInN1Yk1lc2hNb3JwaEluc3RhbmNlIiwicmVuZGVyUmVzb3VyY2VzIiwiUmVuZGVyYWJsZUNvbXBvbmVudCIsIlNoYWRvd0Nhc3RpbmdNb2RlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNENBOzs7O0FBSUEsTUFBTUEsc0JBQXNCLEdBQUcsa0JBQUs7QUFDaEM7Ozs7QUFJQUMsSUFBQUEsR0FBRyxFQUFFLENBTDJCOztBQU1oQzs7OztBQUlBQyxJQUFBQSxFQUFFLEVBQUU7QUFWNEIsR0FBTCxDQUEvQjtBQWFBOzs7OztNQUtNQyxxQixXQURMLDZCQUFRLDBCQUFSLEMsVUFFSSw4QkFBUztBQUNOQyxJQUFBQSxPQUFPLEVBQUU7QUFESCxHQUFULEMsVUFJQSw4QkFBUztBQUNOQSxJQUFBQSxPQUFPLEVBQUU7QUFESCxHQUFULEMsVUFRQSw4QkFBUztBQUNOQyxJQUFBQSxvQkFBb0IsRUFBRTtBQURoQixHQUFULEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBT0Q7Ozs7MEJBS2dCO0FBQ1osZUFBTyxLQUFLQyxTQUFaO0FBQ0gsTzt3QkFFYUMsRyxFQUFLO0FBQ2YsYUFBS0QsU0FBTCxHQUFpQkMsR0FBakI7QUFDSDtBQUVEOzs7Ozs7OzBCQUtrQjtBQUNkLGVBQU8sS0FBS0MsV0FBWjtBQUNILE87d0JBRWVELEcsRUFBSztBQUNqQixhQUFLQyxXQUFMLEdBQW1CRCxHQUFuQjtBQUNIO0FBRUQ7Ozs7Ozs7MEJBS3FCO0FBQ2pCLGVBQU8sS0FBS0UsY0FBWjtBQUNILE87d0JBRWtCRixHLEVBQUs7QUFDcEIsYUFBS0UsY0FBTCxHQUFzQkYsR0FBdEI7QUFDSDtBQUVEOzs7Ozs7OzBCQUtvQjtBQUNoQixlQUFPLEtBQUtHLGFBQVo7QUFDSCxPO3dCQUVpQkgsRyxFQUFLO0FBQ25CLGFBQUtHLGFBQUwsR0FBcUJILEdBQXJCO0FBQ0g7Ozs7Ozs7OzthQWxFZ0MsSTs7Ozs7OzthQUlWLElBQUlJLFdBQUosRTs7Z0ZBQ3RCQyx3Qjs7Ozs7YUFD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Q0MsRzs7d2lCQXNFckRXLHdCOzs7OzthQUNzQixJOzs7OztrQ0E2UFZDLGMsK0JBQUFBLGMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gQ29weXJpZ2h0IChjKSAyMDEzLTIwMTYgQ2h1a29uZyBUZWNobm9sb2dpZXMgSW5jLlxyXG4gQ29weXJpZ2h0IChjKSAyMDE3LTIwMTggWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cDovL3d3dy5jb2NvczJkLXgub3JnXHJcblxyXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxyXG4gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xyXG4gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxyXG4gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxyXG5cclxuIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXHJcbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuXHJcbi8qKlxyXG4gKiBAY2F0ZWdvcnkgbW9kZWxcclxuICovXHJcblxyXG5pbXBvcnQgeyBUZXh0dXJlMkQgfSBmcm9tICcuLi8uLi9hc3NldHMnO1xyXG5pbXBvcnQgeyBNYXRlcmlhbCB9IGZyb20gJy4uLy4uL2Fzc2V0cy9tYXRlcmlhbCc7XHJcbmltcG9ydCB7IE1lc2ggfSBmcm9tICcuLi8uLi9hc3NldHMvbWVzaCc7XHJcbmltcG9ydCB7IGNjY2xhc3MsIGhlbHAsIGV4ZWN1dGVJbkVkaXRNb2RlLCBleGVjdXRpb25PcmRlciwgbWVudSwgcHJvcGVydHkgfSBmcm9tICcuLi8uLi9kYXRhL2NsYXNzLWRlY29yYXRvcic7XHJcbmltcG9ydCB7IFZlYzQgfSBmcm9tICcuLi8uLi9tYXRoJztcclxuaW1wb3J0IHsgTW9kZWwgfSBmcm9tICcuLi8uLi9yZW5kZXJlci9zY2VuZS9tb2RlbCc7XHJcbmltcG9ydCB7IE1vcnBoTW9kZWwgfSBmcm9tICcuLi8uLi9yZW5kZXJlci9tb2RlbHMvbW9ycGgtbW9kZWwnO1xyXG5pbXBvcnQgeyBSb290IH0gZnJvbSAnLi4vLi4vcm9vdCc7XHJcbmltcG9ydCB7IFRyYW5zZm9ybUJpdCB9IGZyb20gJy4uLy4uL3NjZW5lLWdyYXBoL25vZGUtZW51bSc7XHJcbmltcG9ydCB7IEVudW0gfSBmcm9tICcuLi8uLi92YWx1ZS10eXBlcyc7XHJcbmltcG9ydCB7IGJ1aWx0aW5SZXNNZ3IgfSBmcm9tICcuLi9idWlsdGluJztcclxuaW1wb3J0IHsgUmVuZGVyYWJsZUNvbXBvbmVudCB9IGZyb20gJy4vcmVuZGVyYWJsZS1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBNb3JwaFJlbmRlcmluZ0luc3RhbmNlIH0gZnJvbSAnLi4vLi4vYXNzZXRzL21vcnBoJztcclxuaW1wb3J0IHsgYXNzZXJ0SXNUcnVlIH0gZnJvbSAnLi4vLi4vZGF0YS91dGlscy9hc3NlcnRzJztcclxuXHJcbi8qKlxyXG4gKiBAZW4gU2hhZG93IHByb2plY3Rpb24gbW9kZS5cclxuICogQHpoIOmYtOW9seaKleWwhOaWueW8j+OAglxyXG4gKi9cclxuY29uc3QgTW9kZWxTaGFkb3dDYXN0aW5nTW9kZSA9IEVudW0oe1xyXG4gICAgLyoqXHJcbiAgICAgKiBAemggRGlzYWJsZSBzaGFkb3cgcHJvamVjdGlvbi5cclxuICAgICAqIEB6aCDkuI3mipXlsITpmLTlvbHjgIJcclxuICAgICAqL1xyXG4gICAgT0ZGOiAwLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAemggRW5hYmxlIHNoYWRvdyBwcm9qZWN0aW9uLlxyXG4gICAgICogQHpoIOW8gOWQr+mYtOW9seaKleWwhOOAglxyXG4gICAgICovXHJcbiAgICBPTjogMSxcclxufSk7XHJcblxyXG4vKipcclxuICogQGVuIG1vZGVsIGxpZ2h0IG1hcCBzZXR0aW5ncy5cclxuICogQHpoIOaooeWei+WFieeFp+Wbvuiuvue9rlxyXG4gKi9cclxuQGNjY2xhc3MoJ2NjLk1vZGVsTGlnaHRtYXBTZXR0aW5ncycpXHJcbmNsYXNzIE1vZGVsTGlnaHRtYXBTZXR0aW5ncyB7XHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgfSlcclxuICAgIHB1YmxpYyB0ZXh0dXJlOiBUZXh0dXJlMkR8bnVsbCA9IG51bGw7XHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgfSlcclxuICAgIHB1YmxpYyB1dlBhcmFtOiBWZWM0ID0gbmV3IFZlYzQoKTtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9iYWtlYWJsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX2Nhc3RTaGFkb3c6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgZm9ybWVybHlTZXJpYWxpemVkQXM6ICdfcmVjaWV2ZVNoYWRvdycsXHJcbiAgICB9KVxyXG4gICAgcHJvdGVjdGVkIF9yZWNlaXZlU2hhZG93OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfbGlnaHRtYXBTaXplOiBudW1iZXIgPSA2NDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlbiBiYWtlYWJsZS5cclxuICAgICAqIEB6aCDmmK/lkKblj6/ng5jln7njgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBnZXQgYmFrZWFibGUgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9iYWtlYWJsZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgYmFrZWFibGUgKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2Jha2VhYmxlID0gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuIGNhc3Qgc2hhZG93LlxyXG4gICAgICogQHpoIOaYr+WQpuaKleWwhOmYtOW9seOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHlcclxuICAgIGdldCBjYXN0U2hhZG93ICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FzdFNoYWRvdztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgY2FzdFNoYWRvdyAodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fY2FzdFNoYWRvdyA9IHZhbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlbiByZWNlaXZlIHNoYWRvdy5cclxuICAgICAqIEB6aCDmmK/lkKbmjqXlj5fpmLTlvbHjgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBnZXQgcmVjZWl2ZVNoYWRvdyAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlY2VpdmVTaGFkb3c7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHJlY2VpdmVTaGFkb3cgKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX3JlY2VpdmVTaGFkb3cgPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gbGlnaHRtYXAgc2l6ZS5cclxuICAgICAqIEB6aCDlhYnnhaflm77lpKflsI9cclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBnZXQgbGlnaHRtYXBTaXplICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGlnaHRtYXBTaXplO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBsaWdodG1hcFNpemUgKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2xpZ2h0bWFwU2l6ZSA9IHZhbDtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOaooeWei+e7hOS7tuOAglxyXG4gKiBAY2xhc3MgTW9kZWxDb21wb25lbnRcclxuICovXHJcbkBjY2NsYXNzKCdjYy5Nb2RlbENvbXBvbmVudCcpXHJcbkBoZWxwKCdpMThuOmNjLk1vZGVsQ29tcG9uZW50JylcclxuQGV4ZWN1dGlvbk9yZGVyKDEwMClcclxuQG1lbnUoJ0NvbXBvbmVudHMvTW9kZWwnKVxyXG5AZXhlY3V0ZUluRWRpdE1vZGVcclxuZXhwb3J0IGNsYXNzIE1vZGVsQ29tcG9uZW50IGV4dGVuZHMgUmVuZGVyYWJsZUNvbXBvbmVudCB7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTaGFkb3dDYXN0aW5nTW9kZSA9IE1vZGVsU2hhZG93Q2FzdGluZ01vZGU7XHJcblxyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwdWJsaWMgbGlnaHRtYXBTZXR0aW5ncyA9IG5ldyBNb2RlbExpZ2h0bWFwU2V0dGluZ3MoKTtcclxuXHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfbWVzaDogTWVzaCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9zaGFkb3dDYXN0aW5nTW9kZSA9IE1vZGVsU2hhZG93Q2FzdGluZ01vZGUuT0ZGO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuIFNoYWRvdyBwcm9qZWN0aW9uIG1vZGUuXHJcbiAgICAgKiBAemgg6Zi05b2x5oqV5bCE5pa55byP44CCXHJcbiAgICAgKi9cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdHlwZTogTW9kZWxTaGFkb3dDYXN0aW5nTW9kZSxcclxuICAgICAgICB0b29sdGlwOiAnaTE4bjptb2RlbC5zaGFkb3dfY2FzdGluZ19tb2RlbCcsXHJcbiAgICB9KVxyXG4gICAgZ2V0IHNoYWRvd0Nhc3RpbmdNb2RlICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hhZG93Q2FzdGluZ01vZGU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IHNoYWRvd0Nhc3RpbmdNb2RlICh2YWwpIHtcclxuICAgICAgICB0aGlzLl9zaGFkb3dDYXN0aW5nTW9kZSA9IHZhbDtcclxuICAgICAgICB0aGlzLl91cGRhdGVDYXN0U2hhZG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gVGhlIG1lc2ggb2YgdGhlIG1vZGVsLlxyXG4gICAgICogQHpoIOaooeWei+eahOe9keagvOaVsOaNruOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IE1lc2gsXHJcbiAgICAgICAgdG9vbHRpcDogJ2kxOG46bW9kZWwubWVzaCcsXHJcbiAgICB9KVxyXG4gICAgZ2V0IG1lc2ggKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tZXNoO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBtZXNoICh2YWwpIHtcclxuICAgICAgICBjb25zdCBvbGQgPSB0aGlzLl9tZXNoO1xyXG4gICAgICAgIHRoaXMuX21lc2ggPSB2YWw7XHJcbiAgICAgICAgdGhpcy5fbWVzaD8uaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIHRoaXMuX3dhdGNoTW9ycGhJbk1lc2goKTtcclxuICAgICAgICB0aGlzLl9vbk1lc2hDaGFuZ2VkKG9sZCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlTW9kZWxzKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZEluSGllcmFyY2h5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2F0dGFjaFRvU2NlbmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG1vZGVsICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbW9kZWw7XHJcbiAgICB9XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB2aXNpYmxlICh0aGlzOiBNb2RlbENvbXBvbmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISEoXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc2ggJiZcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zdHJ1Y3QubW9ycGggJiZcclxuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zdHJ1Y3QubW9ycGguc3ViTWVzaE1vcnBocy5zb21lKChzdWJNZXNoTW9ycGgpID0+ICEhc3ViTWVzaE1vcnBoKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgZ2V0IGVuYWJsZU1vcnBoICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZW5hYmxlTW9ycGg7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGVuYWJsZU1vcnBoICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX2VuYWJsZU1vcnBoID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9tb2RlbFR5cGU6IHR5cGVvZiBNb2RlbDtcclxuXHJcbiAgICBwcm90ZWN0ZWQgX21vZGVsOiBNb2RlbCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgX21vcnBoSW5zdGFuY2U6IE1vcnBoUmVuZGVyaW5nSW5zdGFuY2UgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByaXZhdGUgX2VuYWJsZU1vcnBoID0gdHJ1ZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLl9tb2RlbFR5cGUgPSBNb2RlbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb25Mb2FkICgpIHtcclxuICAgICAgICB0aGlzLl9tZXNoPy5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgdGhpcy5fd2F0Y2hNb3JwaEluTWVzaCgpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZU1vZGVscygpO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZUNhc3RTaGFkb3coKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZWRvLCBVbmRvLCBQcmVmYWIgcmVzdG9yZSwgZXRjLlxyXG4gICAgcHVibGljIG9uUmVzdG9yZSAoKSB7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlTW9kZWxzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRW5hYmxlICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX21vZGVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZU1vZGVscygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9hdHRhY2hUb1NjZW5lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRGlzYWJsZSAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX21vZGVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RldGFjaEZyb21TY2VuZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb25EZXN0cm95ICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fbW9kZWwpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3Iucm9vdC5kZXN0cm95TW9kZWwodGhpcy5fbW9kZWwpO1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RlbCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGVscy5sZW5ndGggPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fbW9ycGhJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9tb3JwaEluc3RhbmNlLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldFdlaWdodHMgKHdlaWdodHM6IG51bWJlcltdLCBzdWJNZXNoSW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9tb3JwaEluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21vcnBoSW5zdGFuY2Uuc2V0V2VpZ2h0cyhzdWJNZXNoSW5kZXgsIHdlaWdodHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0SW5zdGFuY2VkQXR0cmlidXRlIChuYW1lOiBzdHJpbmcsIHZhbHVlOiBBcnJheUxpa2U8bnVtYmVyPikge1xyXG4gICAgICAgIGlmICghdGhpcy5tb2RlbCkgeyByZXR1cm47IH1cclxuICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5tb2RlbC5pbnN0YW5jZWRBdHRyaWJ1dGVzLmxpc3Q7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChsaXN0W2ldLm5hbWUgPT09IG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIChsaXN0W2ldLnZpZXcgYXMgVHlwZWRBcnJheSkuc2V0KHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBfdXBkYXRlTGlnaHRtYXAgKGxpZ2h0bWFwOiBUZXh0dXJlMkR8bnVsbCwgdU9mZjogbnVtYmVyLCB2T2ZmOiBudW1iZXIsIHVTY2FsZTogbnVtYmVyLCB2U2NhbGU6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubGlnaHRtYXBTZXR0aW5ncy50ZXh0dXJlID0gbGlnaHRtYXA7XHJcbiAgICAgICAgdGhpcy5saWdodG1hcFNldHRpbmdzLnV2UGFyYW0ueCA9IHVPZmY7XHJcbiAgICAgICAgdGhpcy5saWdodG1hcFNldHRpbmdzLnV2UGFyYW0ueSA9IHZPZmY7XHJcbiAgICAgICAgdGhpcy5saWdodG1hcFNldHRpbmdzLnV2UGFyYW0ueiA9IHVTY2FsZTtcclxuICAgICAgICB0aGlzLmxpZ2h0bWFwU2V0dGluZ3MudXZQYXJhbS53ID0gdlNjYWxlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5tb2RlbCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnVwZGF0ZUxpZ2h0aW5nbWFwKHRoaXMubGlnaHRtYXBTZXR0aW5ncy50ZXh0dXJlLCB0aGlzLmxpZ2h0bWFwU2V0dGluZ3MudXZQYXJhbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfdXBkYXRlTW9kZWxzICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZEluSGllcmFyY2h5IHx8ICF0aGlzLl9tZXNoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9tb2RlbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RlbC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLmluaXRpYWxpemUodGhpcy5ub2RlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVNb2RlbCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fdXBkYXRlTW9kZWxQYXJhbXMoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubW9kZWwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnVwZGF0ZUxpZ2h0aW5nbWFwKHRoaXMubGlnaHRtYXBTZXR0aW5ncy50ZXh0dXJlLCB0aGlzLmxpZ2h0bWFwU2V0dGluZ3MudXZQYXJhbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfY3JlYXRlTW9kZWwgKCkge1xyXG4gICAgICAgIGNvbnN0IHByZWZlck1vcnBoT3ZlclBsYWluID0gISF0aGlzLl9tb3JwaEluc3RhbmNlO1xyXG4gICAgICAgIC8vIE5vdGUgd2Ugb25seSBjaGFuZ2UgdG8gdXNlIGBNb3JwaE1vZGVsYCBpZlxyXG4gICAgICAgIC8vIHdlIGFyZSByZXF1aXJlZCB0byByZW5kZXIgbW9ycGggYW5kIHRoZSBgdGhpcy5fbW9kZWxUeXBlYCBpcyBleGFjdGx5IHRoZSBiYXNpYyBgTW9kZWxgLlxyXG4gICAgICAgIC8vIFdlIGRvIHRoaXMgc2luY2UgdGhlIGB0aGlzLl9tb2RlbFR5cGVgIG1pZ2h0IGJlIGNoYW5nZWQgaW4gY2xhc3NlcyBkZXJpdmVkIGZyb20gYE1vZGVsQ29tcG9uZW50YC5cclxuICAgICAgICAvLyBXZSBzaGFsbCBub3Qgb3ZlcndyaXRlIGl0LlxyXG4gICAgICAgIC8vIFBsZWFzZSBub3RpY2UgdGhhdCB3ZSBkbyBub3QgZW5mb3JjZSB0aGF0XHJcbiAgICAgICAgLy8gZGVyaXZlZCBjbGFzc2VzIHNob3VsZCB1c2UgYSBtb3JwaC1hYmxlIG1vZGVsIHR5cGUoaS5lLiBtb2RlbCB0eXBlIGRlcml2ZWQgZnJvbSBgTW9ycGhNb2RlbGApLlxyXG4gICAgICAgIC8vIFNvIHdlIHNob3VsZCB0YWtlIGNhcmUgb2YgdGhlIGVkZ2UgY2FzZS5cclxuICAgICAgICBjb25zdCBtb2RlbFR5cGUgPSAocHJlZmVyTW9ycGhPdmVyUGxhaW4gJiYgdGhpcy5fbW9kZWxUeXBlID09PSBNb2RlbCkgPyBNb3JwaE1vZGVsIDogdGhpcy5fbW9kZWxUeXBlO1xyXG4gICAgICAgIHRoaXMuX21vZGVsID0gKGNjLmRpcmVjdG9yLnJvb3QgYXMgUm9vdCkuY3JlYXRlTW9kZWwobW9kZWxUeXBlKTtcclxuICAgICAgICB0aGlzLl9tb2RlbC52aXNGbGFncyA9IHRoaXMudmlzaWJpbGl0eTtcclxuICAgICAgICB0aGlzLl9tb2RlbC5pbml0aWFsaXplKHRoaXMubm9kZSk7XHJcbiAgICAgICAgdGhpcy5fbW9kZWxzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgdGhpcy5fbW9kZWxzLnB1c2godGhpcy5fbW9kZWwpO1xyXG4gICAgICAgIGlmICh0aGlzLl9tb3JwaEluc3RhbmNlICYmIHRoaXMuX21vZGVsIGluc3RhbmNlb2YgTW9ycGhNb2RlbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RlbC5zZXRNb3JwaFJlbmRlcmluZyh0aGlzLl9tb3JwaEluc3RhbmNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9hdHRhY2hUb1NjZW5lICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMubm9kZS5zY2VuZSB8fCAhdGhpcy5fbW9kZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBzY2VuZSA9IHRoaXMuX2dldFJlbmRlclNjZW5lKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX21vZGVsLnNjZW5lICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGV0YWNoRnJvbVNjZW5lKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNjZW5lLmFkZE1vZGVsKHRoaXMuX21vZGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2RldGFjaEZyb21TY2VuZSAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX21vZGVsICYmIHRoaXMuX21vZGVsLnNjZW5lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNjZW5lLnJlbW92ZU1vZGVsKHRoaXMuX21vZGVsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF91cGRhdGVNb2RlbFBhcmFtcyAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9tZXNoIHx8ICF0aGlzLl9tb2RlbCkgeyByZXR1cm47IH1cclxuICAgICAgICB0aGlzLm5vZGUuaGFzQ2hhbmdlZEZsYWdzIHw9IFRyYW5zZm9ybUJpdC5QT1NJVElPTjtcclxuICAgICAgICB0aGlzLl9tb2RlbC50cmFuc2Zvcm0uaGFzQ2hhbmdlZEZsYWdzIHw9IFRyYW5zZm9ybUJpdC5QT1NJVElPTjtcclxuICAgICAgICB0aGlzLl9tb2RlbC5pc0R5bmFtaWNCYXRjaGluZyA9IHRoaXMuX2lzQmF0Y2hpbmdFbmFibGVkKCk7XHJcbiAgICAgICAgY29uc3QgbWVzaENvdW50ID0gdGhpcy5fbWVzaCA/IHRoaXMuX21lc2guc3ViTWVzaENvdW50IDogMDtcclxuICAgICAgICBjb25zdCByZW5kZXJpbmdNZXNoID0gdGhpcy5fbWVzaC5yZW5kZXJpbmdTdWJNZXNoZXM7XHJcbiAgICAgICAgaWYgKHJlbmRlcmluZ01lc2gpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNoQ291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLmdldFJlbmRlck1hdGVyaWFsKGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3ViTWVzaERhdGEgPSByZW5kZXJpbmdNZXNoW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Yk1lc2hEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwuaW5pdFN1Yk1vZGVsKGksIHN1Yk1lc2hEYXRhLCBtYXRlcmlhbCB8fCB0aGlzLl9nZXRCdWlsdGluTWF0ZXJpYWwoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbW9kZWwuY3JlYXRlQm91bmRpbmdTaGFwZSh0aGlzLl9tZXNoLm1pblBvc2l0aW9uLCB0aGlzLl9tZXNoLm1heFBvc2l0aW9uKTtcclxuICAgICAgICB0aGlzLl9tb2RlbC5lbmFibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX29uTWF0ZXJpYWxNb2RpZmllZCAoaWR4OiBudW1iZXIsIG1hdGVyaWFsOiBNYXRlcmlhbCB8IG51bGwpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX21vZGVsIHx8ICF0aGlzLl9tb2RlbC5pbml0ZWQpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgdGhpcy5fb25SZWJ1aWxkUFNPKGlkeCwgbWF0ZXJpYWwgfHwgdGhpcy5fZ2V0QnVpbHRpbk1hdGVyaWFsKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfb25SZWJ1aWxkUFNPIChpZHg6IG51bWJlciwgbWF0ZXJpYWw6IE1hdGVyaWFsKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9tb2RlbCB8fCAhdGhpcy5fbW9kZWwuaW5pdGVkKSB7IHJldHVybjsgfVxyXG4gICAgICAgIHRoaXMuX21vZGVsLmlzRHluYW1pY0JhdGNoaW5nID0gdGhpcy5faXNCYXRjaGluZ0VuYWJsZWQoKTtcclxuICAgICAgICB0aGlzLl9tb2RlbC5zZXRTdWJNb2RlbE1hdGVyaWFsKGlkeCwgbWF0ZXJpYWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGVsLnVwZGF0ZUxpZ2h0aW5nbWFwKHRoaXMubGlnaHRtYXBTZXR0aW5ncy50ZXh0dXJlLCB0aGlzLmxpZ2h0bWFwU2V0dGluZ3MudXZQYXJhbSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9vbk1lc2hDaGFuZ2VkIChvbGQ6IE1lc2ggfCBudWxsKSB7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9jbGVhck1hdGVyaWFscyAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9tb2RlbCkgeyByZXR1cm47IH1cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX21vZGVsLnN1Yk1vZGVsTnVtOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5fb25NYXRlcmlhbE1vZGlmaWVkKGksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2dldEJ1aWx0aW5NYXRlcmlhbCAoKSB7XHJcbiAgICAgICAgLy8gY2xhc3NpYyB1Z2x5IHBpbmsgaW5kaWNhdGluZyBtaXNzaW5nIG1hdGVyaWFsXHJcbiAgICAgICAgcmV0dXJuIGJ1aWx0aW5SZXNNZ3IuZ2V0PE1hdGVyaWFsPignbWlzc2luZy1tYXRlcmlhbCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfb25WaXNpYmlsaXR5Q2hhbmdlICh2YWw6IG51bWJlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5fbW9kZWwpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgdGhpcy5fbW9kZWwudmlzRmxhZ3MgPSB2YWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF91cGRhdGVDYXN0U2hhZG93ICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX21vZGVsKSB7IHJldHVybjsgfVxyXG4gICAgICAgIGlmICh0aGlzLl9zaGFkb3dDYXN0aW5nTW9kZSA9PT0gTW9kZWxTaGFkb3dDYXN0aW5nTW9kZS5PRkYpIHtcclxuICAgICAgICAgICAgdGhpcy5fbW9kZWwuY2FzdFNoYWRvdyA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFzc2VydElzVHJ1ZShcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NoYWRvd0Nhc3RpbmdNb2RlID09PSBNb2RlbFNoYWRvd0Nhc3RpbmdNb2RlLk9OLFxyXG4gICAgICAgICAgICAgICAgYFNoYWRvd0Nhc3RpbmdNb2RlICR7dGhpcy5fc2hhZG93Q2FzdGluZ01vZGV9IGlzIG5vdCBzdXBwb3J0ZWQuYCxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdGhpcy5fbW9kZWwuY2FzdFNoYWRvdyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfaXNCYXRjaGluZ0VuYWJsZWQgKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fbWF0ZXJpYWxzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdCA9IHRoaXMuX21hdGVyaWFsc1tpXTtcclxuICAgICAgICAgICAgaWYgKCFtYXQpIHsgY29udGludWU7IH1cclxuICAgICAgICAgICAgZm9yIChsZXQgcCA9IDA7IHAgPCBtYXQucGFzc2VzLmxlbmd0aDsgKytwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXNzID0gbWF0LnBhc3Nlc1twXTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXNzLmluc3RhbmNlZEJ1ZmZlciB8fCBwYXNzLmJhdGNoZWRCdWZmZXIpIHsgcmV0dXJuIHRydWU7IH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfd2F0Y2hNb3JwaEluTWVzaCAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX21vcnBoSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5fbW9ycGhJbnN0YW5jZS5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX21vcnBoSW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9lbmFibGVNb3JwaCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRoaXMuX21lc2ggfHxcclxuICAgICAgICAgICAgIXRoaXMuX21lc2guc3RydWN0Lm1vcnBoIHx8XHJcbiAgICAgICAgICAgICF0aGlzLl9tZXNoLm1vcnBoUmVuZGVyaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHsgbW9ycGggfSA9IHRoaXMuX21lc2guc3RydWN0O1xyXG4gICAgICAgIHRoaXMuX21vcnBoSW5zdGFuY2UgPSB0aGlzLl9tZXNoLm1vcnBoUmVuZGVyaW5nLmNyZWF0ZUluc3RhbmNlKCk7XHJcbiAgICAgICAgY29uc3QgblN1Yk1lc2hlcyA9IHRoaXMuX21lc2guc3RydWN0LnByaW1pdGl2ZXMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGlTdWJNZXNoID0gMDsgaVN1Yk1lc2ggPCBuU3ViTWVzaGVzOyArK2lTdWJNZXNoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHN1Yk1lc2hNb3JwaCA9IG1vcnBoLnN1Yk1lc2hNb3JwaHNbaVN1Yk1lc2hdO1xyXG4gICAgICAgICAgICBpZiAoIXN1Yk1lc2hNb3JwaCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgaW5pdGlhbFdlaWdodHMgPSBzdWJNZXNoTW9ycGgud2VpZ2h0cyB8fCBtb3JwaC53ZWlnaHRzO1xyXG4gICAgICAgICAgICBjb25zdCB3ZWlnaHRzID0gaW5pdGlhbFdlaWdodHMgP1xyXG4gICAgICAgICAgICAgICAgaW5pdGlhbFdlaWdodHMuc2xpY2UoKSA6XHJcbiAgICAgICAgICAgICAgICBuZXcgQXJyYXk8bnVtYmVyPihzdWJNZXNoTW9ycGgudGFyZ2V0cy5sZW5ndGgpLmZpbGwoMCk7XHJcbiAgICAgICAgICAgIHRoaXMuX21vcnBoSW5zdGFuY2Uuc2V0V2VpZ2h0cyhpU3ViTWVzaCwgd2VpZ2h0cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fbW9kZWwgJiYgdGhpcy5fbW9kZWwgaW5zdGFuY2VvZiBNb3JwaE1vZGVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnNldE1vcnBoUmVuZGVyaW5nKHRoaXMuX21vcnBoSW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zeW5jTW9ycGhXZWlnaHRzIChzdWJNZXNoSW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5fbW9ycGhJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHN1Yk1lc2hNb3JwaEluc3RhbmNlID0gdGhpcy5fbW9ycGhJbnN0YW5jZVtzdWJNZXNoSW5kZXhdO1xyXG4gICAgICAgIGlmICghc3ViTWVzaE1vcnBoSW5zdGFuY2UgfHwgIXN1Yk1lc2hNb3JwaEluc3RhbmNlLnJlbmRlclJlc291cmNlcykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN1Yk1lc2hNb3JwaEluc3RhbmNlLnJlbmRlclJlc291cmNlcy5zZXRXZWlnaHRzKHN1Yk1lc2hNb3JwaEluc3RhbmNlLndlaWdodHMpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgbmFtZXNwYWNlIE1vZGVsQ29tcG9uZW50IHtcclxuICAgIGV4cG9ydCB0eXBlIFNoYWRvd0Nhc3RpbmdNb2RlID0gRW51bUFsaWFzPHR5cGVvZiBNb2RlbFNoYWRvd0Nhc3RpbmdNb2RlPjtcclxufVxyXG4iXX0=