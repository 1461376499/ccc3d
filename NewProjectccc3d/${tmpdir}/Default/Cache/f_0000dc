(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../../core/assets/index.js", "../../core/data/class-decorator.js", "../../core/platform/event-manager/event-enum.js", "../../core/math/index.js", "../../core/value-types/enum.js", "../../core/math/utils.js", "../../core/components/ui-base/ui-render-component.js", "../../core/default-constants.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../../core/assets/index.js"), require("../../core/data/class-decorator.js"), require("../../core/platform/event-manager/event-enum.js"), require("../../core/math/index.js"), require("../../core/value-types/enum.js"), require("../../core/math/utils.js"), require("../../core/components/ui-base/ui-render-component.js"), require("../../core/default-constants.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.index, global.classDecorator, global.eventEnum, global.index, global._enum, global.utils, global.uiRenderComponent, global.defaultConstants);
    global.spriteComponent = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _index, _classDecorator, _eventEnum, _index2, _enum, _utils, _uiRenderComponent, _defaultConstants) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.SpriteComponent = void 0;

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _class3, _temp;

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

  function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  /**
   * @en
   * Enum for sprite type.
   *
   * @zh
   * Sprite 类型。
   */
  var SpriteType;

  (function (SpriteType) {
    SpriteType[SpriteType["SIMPLE"] = 0] = "SIMPLE";
    SpriteType[SpriteType["SLICED"] = 1] = "SLICED";
    SpriteType[SpriteType["TILED"] = 2] = "TILED";
    SpriteType[SpriteType["FILLED"] = 3] = "FILLED";
  })(SpriteType || (SpriteType = {}));

  (0, _enum.ccenum)(SpriteType);
  /**
   * @en
   * Enum for fill type.
   *
   * @zh
   * 填充类型。
   */

  var FillType;

  (function (FillType) {
    FillType[FillType["HORIZONTAL"] = 0] = "HORIZONTAL";
    FillType[FillType["VERTICAL"] = 1] = "VERTICAL";
    FillType[FillType["RADIAL"] = 2] = "RADIAL";
  })(FillType || (FillType = {}));

  (0, _enum.ccenum)(FillType);
  /**
   * @en
   * Sprite Size can track trimmed size, raw size or none.
   *
   * @zh
   * 精灵尺寸调整模式。
   */

  var SizeMode;

  (function (SizeMode) {
    SizeMode[SizeMode["CUSTOM"] = 0] = "CUSTOM";
    SizeMode[SizeMode["TRIMMED"] = 1] = "TRIMMED";
    SizeMode[SizeMode["RAW"] = 2] = "RAW";
  })(SizeMode || (SizeMode = {}));

  (0, _enum.ccenum)(SizeMode);
  var EventType;
  /**
   * @en
   * Renders a sprite in the scene.
   *
   * @zh
   * 渲染精灵组件。
   */

  (function (EventType) {
    EventType["SPRITE_FRAME_CHANGED"] = "spriteframe-changed";
  })(EventType || (EventType = {}));

  var SpriteComponent = (_dec = (0, _classDecorator.ccclass)('cc.SpriteComponent'), _dec2 = (0, _classDecorator.help)('i18n:cc.SpriteComponent'), _dec3 = (0, _classDecorator.executionOrder)(110), _dec4 = (0, _classDecorator.menu)('UI/Render/Sprite'), _dec5 = (0, _classDecorator.property)({
    type: _index.SpriteAtlas,
    displayOrder: 4,
    tooltip: '图片资源所属的 Atlas 图集资源'
  }), _dec6 = (0, _classDecorator.property)({
    type: _index.SpriteFrame,
    displayOrder: 5,
    tooltip: '渲染 Sprite 使用的 SpriteFrame 图片资源'
  }), _dec7 = (0, _classDecorator.property)({
    type: SpriteType,
    displayOrder: 6,
    tooltip: '渲染模式：\n- 普通（Simple）：修改尺寸会整体拉伸图像，适用于序列帧动画和普通图像 \n' + '- 九宫格（Sliced）：修改尺寸时四个角的区域不会拉伸，适用于 UI 按钮和面板背景 \n' + '- 填充（Filled）：设置一定的填充起始位置和方向，能够以一定比率剪裁显示图片'
  }), _dec8 = (0, _classDecorator.property)({
    type: FillType,
    tooltip: '填充方向，可以选择横向（Horizontal），纵向（Vertical）和扇形（Radial）三种方向'
  }), _dec9 = (0, _classDecorator.property)({
    tooltip: '扇形填充时，指定扇形的中心点，取值范围 0 ~ 1'
  }), _dec10 = (0, _classDecorator.property)({
    range: [0, 1, 0.1],
    tooltip: '填充起始位置，输入一个 0 ~ 1 之间的小数表示起始位置的百分比'
  }), _dec11 = (0, _classDecorator.property)({
    range: [0, 1, 0.1],
    tooltip: '填充总量，取值范围 0 ~ 1 指定显示图像范围的百分比'
  }), _dec12 = (0, _classDecorator.property)({
    displayOrder: 8,
    tooltip: '节点约束框内是否包括透明像素区域，勾选此项会去除节点约束框内的透明区域'
  }), _dec13 = (0, _classDecorator.property)({
    type: SizeMode,
    displayOrder: 7,
    tooltip: '指定 Sprite 所在节点的尺寸，CUSTOM 表示自定义尺寸，TRIMMED 表示取原始图片剪裁透明像素后的尺寸，RAW 表示取原始图片未剪裁的尺寸'
  }), _dec(_class = _dec2(_class = _dec3(_class = _dec4(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function (_UIRenderComponent) {
    _inherits(SpriteComponent, _UIRenderComponent);

    function SpriteComponent() {
      var _getPrototypeOf2;

      var _this;

      _classCallCheck(this, SpriteComponent);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SpriteComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));

      _initializerDefineProperty(_this, "_spriteFrame", _descriptor, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_type", _descriptor2, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_fillType", _descriptor3, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_sizeMode", _descriptor4, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_fillCenter", _descriptor5, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_fillStart", _descriptor6, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_fillRange", _descriptor7, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_isTrimmedMode", _descriptor8, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_useGrayscale", _descriptor9, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_atlas", _descriptor10, _assertThisInitialized(_this));

      return _this;
    }

    _createClass(SpriteComponent, [{
      key: "__preload",
      // static State = State;
      value: function __preload() {
        if (this._useGrayscale) {
          this._instanceMaterialType = _uiRenderComponent.InstanceMaterialType.GRAYSCALE;
        }

        if (_get(_getPrototypeOf(SpriteComponent.prototype), "__preload", this)) {
          _get(_getPrototypeOf(SpriteComponent.prototype), "__preload", this).call(this);
        }

        if (_defaultConstants.EDITOR) {
          this._resized();

          this.node.on(_eventEnum.SystemEventType.SIZE_CHANGED, this._resized, this);
        }

        if (this._spriteFrame) {
          this._spriteFrame.on('load', this._markForUpdateUvDirty, this);

          this._markForUpdateUvDirty();
        }
      } // /**
      //  * Change the state of sprite.
      //  * @method setState
      //  * @see `SpriteComponent.State`
      //  * @param state {SpriteComponent.State} NORMAL or GRAY State.
      //  */
      // getState() {
      //     return this._state;
      // }
      // setState(state) {
      //     if (this._state === state) return;
      //     this._state = state;
      //     this._activateMaterial();
      // }
      // onLoad() {}

    }, {
      key: "onEnable",
      value: function onEnable() {
        _get(_getPrototypeOf(SpriteComponent.prototype), "onEnable", this).call(this); // this._flushAssembler();


        this._activateMaterial();
      }
    }, {
      key: "onDestroy",
      value: function onDestroy() {
        _get(_getPrototypeOf(SpriteComponent.prototype), "onDestroy", this).call(this);

        this.destroyRenderData();

        if (_defaultConstants.EDITOR) {
          this.node.off(_eventEnum.SystemEventType.SIZE_CHANGED, this._resized, this);
        }

        if (this._spriteFrame) {
          this._spriteFrame.off('load');
        }
      }
      /**
       * @en
       * Quickly switch to other sprite frame in the sprite atlas.
       * If there is no atlas, the switch fails.
       *
       * @zh
       * 精灵图集内的精灵替换
       *
       * @returns
       */

    }, {
      key: "changeSpriteFrameFromAtlas",
      value: function changeSpriteFrameFromAtlas(name) {
        if (!this._atlas) {
          console.warn('SpriteAtlas is null.');
          return;
        }

        var sprite = this._atlas.getSpriteFrame(name);

        this.spriteFrame = sprite;
      }
    }, {
      key: "_render",
      value: function _render(render) {
        render.commitComp(this, this._spriteFrame.getGFXTextureView(), this._assembler, this._spriteFrame.texture.getGFXSampler()); // render.commitComp(this, this._spriteFrame!.getGFXTextureView(), this._assembler!);
      }
    }, {
      key: "_canRender",
      value: function _canRender() {
        // if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {
        //     if (!this._enabled) { return false; }
        // } else {
        //     if (!this._enabled || !this._material) { return false; }
        // }
        // const spriteFrame = this._spriteFrame;
        // if (!spriteFrame || !spriteFrame.textureLoaded()) {
        //     return false;
        // }
        // return true;
        if (!_get(_getPrototypeOf(SpriteComponent.prototype), "_canRender", this).call(this)) {
          return false;
        }

        var spriteFrame = this._spriteFrame;

        if (!spriteFrame || !spriteFrame.textureLoaded()) {
          return false;
        }

        return true;
      }
    }, {
      key: "_flushAssembler",
      value: function _flushAssembler() {
        var assembler = SpriteComponent.Assembler.getAssembler(this);

        if (this._assembler !== assembler) {
          this.destroyRenderData();
          this._assembler = assembler;
        }

        if (!this._renderData) {
          if (this._assembler && this._assembler.createData) {
            this._renderData = this._assembler.createData(this);
            this._renderData.material = this._material;
            this.markForUpdateRenderData();

            this._updateColor();
          }
        }
      }
    }, {
      key: "_applySpriteSize",
      value: function _applySpriteSize() {
        if (this._spriteFrame) {
          if (SizeMode.RAW === this._sizeMode) {
            var size = this._spriteFrame.originalSize;
            this.node.setContentSize(size);
          } else if (SizeMode.TRIMMED === this._sizeMode) {
            var rect = this._spriteFrame.getRect();

            this.node.setContentSize(rect.width, rect.height);
          }

          this._activateMaterial();
        }
      }
    }, {
      key: "_resized",
      value: function _resized() {
        if (!_defaultConstants.EDITOR) {
          return;
        }

        if (this._spriteFrame) {
          var actualSize = this.node.getContentSize();
          var expectedW = actualSize.width;
          var expectedH = actualSize.height;

          if (this._sizeMode === SizeMode.RAW) {
            var size = this._spriteFrame.getOriginalSize();

            expectedW = size.width;
            expectedH = size.height;
          } else if (this._sizeMode === SizeMode.TRIMMED) {
            var rect = this._spriteFrame.getRect();

            expectedW = rect.width;
            expectedH = rect.height;
          }

          if (expectedW !== actualSize.width || expectedH !== actualSize.height) {
            this._sizeMode = SizeMode.CUSTOM;
          }
        }
      }
    }, {
      key: "_activateMaterial",
      value: function _activateMaterial() {
        var spriteFrame = this._spriteFrame;
        var material = this._material; // WebGL

        if (cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
          // if (!material) {
          //     this._material = cc.builtinResMgr.get('sprite-material');
          //     material = this._material;
          //     if (spriteFrame && spriteFrame.textureLoaded()) {
          //         material!.setProperty('mainTexture', spriteFrame);
          //         this.markForUpdateRenderData();
          //     }
          // }
          // TODO: use editor assets
          // else {
          if (spriteFrame) {
            if (material) {
              // const matTexture = material.getProperty('mainTexture');
              // if (matTexture !== spriteFrame) {
              // material.setProperty('mainTexture', spriteFrame.texture);
              this.markForUpdateRenderData(); // }
            }
          } // }


          if (this._renderData) {
            this._renderData.material = material;
          }
        } else {
          this.markForUpdateRenderData(); // this.markForRender(true);
        }
      }
      /*
          private _applyAtlas (spriteFrame: SpriteFrame | null) {
              if (!EDITOR) {
                  return;
              }
              // Set atlas
              if (spriteFrame) {
                  if (spriteFrame.atlasUuid.length > 0) {
                      if (!this._atlas || this._atlas._uuid !== spriteFrame.atlasUuid) {
                          const self = this;
                          AssetLibrary.loadAsset(spriteFrame.atlasUuid, (err, asset) => {
                              self._atlas = asset;
                          });
                      }
                  }else{
                      this._atlas = null;
                  }
              }
          }
      */

    }, {
      key: "_onTextureLoaded",
      value: function _onTextureLoaded() {
        if (!this.isValid) {
          return;
        }

        this._applySpriteSize();
      }
    }, {
      key: "_applySpriteFrame",
      value: function _applySpriteFrame(oldFrame) {
        // if (oldFrame && oldFrame.off) {
        //     oldFrame.off('load', this._onTextureLoaded, this);
        // }
        var spriteFrame = this._spriteFrame; // if (!spriteFrame || (this._material && this._material._texture) !== (spriteFrame && spriteFrame._texture)) {
        //     // disable render flow until texture is loaded
        //     this.markForRender(false);
        // }

        if (this._renderData) {
          if (oldFrame) {
            oldFrame.off('load', this._markForUpdateUvDirty);
          }

          if (spriteFrame) {
            spriteFrame.on('load', this._markForUpdateUvDirty, this);
          }

          if (!this._renderData.uvDirty) {
            if (oldFrame && spriteFrame) {
              this._renderData.uvDirty = oldFrame.uvHash !== spriteFrame.uvHash;
            } else {
              this._renderData.uvDirty = true;
            }
          }

          this._renderDataFlag = this._renderData.uvDirty;
        }

        if (spriteFrame) {
          if (!oldFrame || spriteFrame !== oldFrame) {
            // this._material.setProperty('mainTexture', spriteFrame);
            if (spriteFrame.loaded) {
              this._onTextureLoaded();
            } else {
              spriteFrame.once('load', this._onTextureLoaded, this);
            }
          }
        }
        /*
                if (EDITOR) {
                    // Set atlas
                    this._applyAtlas(spriteFrame);
                }
        */

      }
      /**
       * 强制刷新 uv。
       */

    }, {
      key: "_markForUpdateUvDirty",
      value: function _markForUpdateUvDirty() {
        if (this._renderData) {
          this._renderData.uvDirty = true;
          this._renderDataFlag = true;
        }
      }
    }, {
      key: "spriteAtlas",

      /**
       * @en
       * The sprite atlas where the sprite is.
       *
       * @zh
       * 精灵的图集。
       */
      get: function get() {
        return this._atlas;
      },
      set: function set(value) {
        if (this._atlas === value) {
          return;
        }

        this._atlas = value; //        this.spriteFrame = null;
      }
      /**
       * @en
       * The sprite frame of the sprite.
       *
       * @zh
       * 精灵的精灵帧。
       */

    }, {
      key: "spriteFrame",
      get: function get() {
        return this._spriteFrame;
      },
      set: function set(value) {
        if (this._spriteFrame === value) {
          return;
        }

        var lastSprite = this._spriteFrame;
        this._spriteFrame = value; // render & update render data flag will be triggered while applying new sprite frame

        this.markForUpdateRenderData(false);

        this._applySpriteFrame(lastSprite);

        if (_defaultConstants.EDITOR) {
          // @ts-ignore
          this.node.emit(EventType.SPRITE_FRAME_CHANGED, this);
        }
      }
      /**
       * @en
       * The sprite render type.
       *
       * @zh
       * 精灵渲染类型。
       *
       * @example
       * ```typescript
       * sprite.type = cc.SpriteComponent.Type.SIMPLE;
       * ```
       */

    }, {
      key: "type",
      get: function get() {
        return this._type;
      },
      set: function set(value) {
        if (this._type !== value) {
          this._type = value;

          this._flushAssembler();
        }
      }
      /**
       * @en
       * The fill type, This will only have any effect if the "type" is set to “SpriteComponent.Type.FILLED”.
       *
       * @zh
       * 精灵填充类型，仅渲染类型设置为 SpriteComponent.Type.FILLED 时有效。
       *
       * @example
       * ```typescript
       * sprite.fillType = cc.SpriteComponent.FillType.HORIZONTAL;
       * ```
       */

    }, {
      key: "fillType",
      get: function get() {
        return this._fillType;
      },
      set: function set(value) {
        if (this._fillType !== value) {
          if (value === FillType.RADIAL || this._fillType === FillType.RADIAL) {
            this.destroyRenderData();
            this._renderData = null;
          } else {
            if (this._renderData) {
              this.markForUpdateRenderData(true);
            }
          }
        }

        this._fillType = value;

        this._flushAssembler();
      }
      /**
       * @en
       * The fill Center, This will only have any effect if the "type" is set to “SpriteComponent.Type.FILLED”.
       *
       * @zh
       * 填充中心点，仅渲染类型设置为 SpriteComponent.Type.FILLED 时有效。
       *
       * @example
       * ```typescript
       * sprite.fillCenter = cc.v2(0, 0);
       * ```
       */

    }, {
      key: "fillCenter",
      get: function get() {
        return this._fillCenter;
      },
      set: function set(value) {
        this._fillCenter.x = value.x;
        this._fillCenter.y = value.y;

        if (this._type === SpriteType.FILLED && this._renderData) {
          this.markForUpdateRenderData();
        }
      }
      /**
       * @en
       * The fill Start, This will only have any effect if the "type" is set to “SpriteComponent.Type.FILLED”.
       *
       * @zh
       * 填充起始点，仅渲染类型设置为 SpriteComponent.Type.FILLED 时有效。
       *
       * @example
       * ```typescript
       * // -1 To 1 between the numbers
       * sprite.fillStart = 0.5;
       * ```
       */

    }, {
      key: "fillStart",
      get: function get() {
        return this._fillStart;
      },
      set: function set(value) {
        this._fillStart = (0, _utils.clamp)(value, -1, 1);

        if (this._type === SpriteType.FILLED && this._renderData) {
          this.markForUpdateRenderData();
          this._renderData.uvDirty = true;
        }
      }
      /**
       * @en
       * The fill Range, This will only have any effect if the "type" is set to “SpriteComponent.Type.FILLED”.
       *
       * @zh
       * 填充范围，仅渲染类型设置为 SpriteComponent.Type.FILLED 时有效。
       *
       * @example
       * ```typescript
       * // -1 To 1 between the numbers
       * sprite.fillRange = 1;
       * ```
       */

    }, {
      key: "fillRange",
      get: function get() {
        return this._fillRange;
      },
      set: function set(value) {
        // ??? -1 ~ 1
        this._fillRange = (0, _utils.clamp)(value, 0, 1);

        if (this._type === SpriteType.FILLED && this._renderData) {
          this.markForUpdateRenderData();
          this._renderData.uvDirty = true;
        }
      }
      /**
       * @en
       * specify the frame is trimmed or not.
       *
       * @zh
       * 是否使用裁剪模式。
       *
       * @example
       * ```typescript
       * sprite.trim = true;
       * ```
       */

    }, {
      key: "trim",
      get: function get() {
        return this._isTrimmedMode;
      },
      set: function set(value) {
        if (this._isTrimmedMode === value) {
          return;
        }

        this._isTrimmedMode = value;

        if (this._type === SpriteType.SIMPLE
        /*|| this._type === SpriteType.MESH*/
        && this._renderData) {
          this.markForUpdateRenderData(true);
        }
      }
    }, {
      key: "grayscale",
      get: function get() {
        return this._useGrayscale;
      },
      set: function set(value) {
        if (this._useGrayscale === value) {
          return;
        }

        this._useGrayscale = value;

        if (value === true) {
          this._instanceMaterialType = _uiRenderComponent.InstanceMaterialType.GRAYSCALE;
        } else {
          this._instanceMaterialType = _uiRenderComponent.InstanceMaterialType.ADDCOLORANDTEXTURE;
        }

        this._instanceMaterial();
      }
      /**
       * @en
       * Specify the size tracing mode.
       *
       * @zh
       * 精灵尺寸调整模式。
       *
       * @example
       * ```typescript
       * sprite.sizeMode = cc.SpriteComponent.SizeMode.CUSTOM;
       * ```
       */

    }, {
      key: "sizeMode",
      get: function get() {
        return this._sizeMode;
      },
      set: function set(value) {
        if (this._sizeMode === value) {
          return;
        }

        this._sizeMode = value;

        if (value !== SizeMode.CUSTOM) {
          this._applySpriteSize();
        }
      }
    }]);

    return SpriteComponent;
  }(_uiRenderComponent.UIRenderComponent), _class3.FillType = FillType, _class3.Type = SpriteType, _class3.SizeMode = SizeMode, _class3.EventType = EventType, _temp), (_applyDecoratedDescriptor(_class2.prototype, "spriteAtlas", [_dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "spriteAtlas"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "spriteFrame", [_dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "spriteFrame"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "type", [_dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "type"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "fillType", [_dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "fillType"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "fillCenter", [_dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "fillCenter"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "fillStart", [_dec10], Object.getOwnPropertyDescriptor(_class2.prototype, "fillStart"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "fillRange", [_dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "fillRange"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "trim", [_dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "trim"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "grayscale", [_classDecorator.property], Object.getOwnPropertyDescriptor(_class2.prototype, "grayscale"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "sizeMode", [_dec13], Object.getOwnPropertyDescriptor(_class2.prototype, "sizeMode"), _class2.prototype), _descriptor = _applyDecoratedDescriptor(_class2.prototype, "_spriteFrame", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "_type", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return SpriteType.SIMPLE;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_fillType", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return FillType.HORIZONTAL;
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "_sizeMode", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return SizeMode.TRIMMED;
    }
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "_fillCenter", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return new _index2.Vec2(0, 0);
    }
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "_fillStart", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 0;
    }
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "_fillRange", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 0;
    }
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "_isTrimmedMode", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return true;
    }
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "_useGrayscale", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "_atlas", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  })), _class2)) || _class) || _class) || _class) || _class);
  _exports.SpriteComponent = SpriteComponent;
  cc.SpriteComponent = SpriteComponent;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvdWkvY29tcG9uZW50cy9zcHJpdGUtY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbIlNwcml0ZVR5cGUiLCJGaWxsVHlwZSIsIlNpemVNb2RlIiwiRXZlbnRUeXBlIiwiU3ByaXRlQ29tcG9uZW50IiwidHlwZSIsIlNwcml0ZUF0bGFzIiwiZGlzcGxheU9yZGVyIiwidG9vbHRpcCIsIlNwcml0ZUZyYW1lIiwicmFuZ2UiLCJfdXNlR3JheXNjYWxlIiwiX2luc3RhbmNlTWF0ZXJpYWxUeXBlIiwiSW5zdGFuY2VNYXRlcmlhbFR5cGUiLCJHUkFZU0NBTEUiLCJFRElUT1IiLCJfcmVzaXplZCIsIm5vZGUiLCJvbiIsIlN5c3RlbUV2ZW50VHlwZSIsIlNJWkVfQ0hBTkdFRCIsIl9zcHJpdGVGcmFtZSIsIl9tYXJrRm9yVXBkYXRlVXZEaXJ0eSIsIl9hY3RpdmF0ZU1hdGVyaWFsIiwiZGVzdHJveVJlbmRlckRhdGEiLCJvZmYiLCJuYW1lIiwiX2F0bGFzIiwiY29uc29sZSIsIndhcm4iLCJzcHJpdGUiLCJnZXRTcHJpdGVGcmFtZSIsInNwcml0ZUZyYW1lIiwicmVuZGVyIiwiY29tbWl0Q29tcCIsImdldEdGWFRleHR1cmVWaWV3IiwiX2Fzc2VtYmxlciIsInRleHR1cmUiLCJnZXRHRlhTYW1wbGVyIiwidGV4dHVyZUxvYWRlZCIsImFzc2VtYmxlciIsIkFzc2VtYmxlciIsImdldEFzc2VtYmxlciIsIl9yZW5kZXJEYXRhIiwiY3JlYXRlRGF0YSIsIm1hdGVyaWFsIiwiX21hdGVyaWFsIiwibWFya0ZvclVwZGF0ZVJlbmRlckRhdGEiLCJfdXBkYXRlQ29sb3IiLCJSQVciLCJfc2l6ZU1vZGUiLCJzaXplIiwib3JpZ2luYWxTaXplIiwic2V0Q29udGVudFNpemUiLCJUUklNTUVEIiwicmVjdCIsImdldFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImFjdHVhbFNpemUiLCJnZXRDb250ZW50U2l6ZSIsImV4cGVjdGVkVyIsImV4cGVjdGVkSCIsImdldE9yaWdpbmFsU2l6ZSIsIkNVU1RPTSIsImNjIiwiZ2FtZSIsInJlbmRlclR5cGUiLCJSRU5ERVJfVFlQRV9DQU5WQVMiLCJpc1ZhbGlkIiwiX2FwcGx5U3ByaXRlU2l6ZSIsIm9sZEZyYW1lIiwidXZEaXJ0eSIsInV2SGFzaCIsIl9yZW5kZXJEYXRhRmxhZyIsImxvYWRlZCIsIl9vblRleHR1cmVMb2FkZWQiLCJvbmNlIiwidmFsdWUiLCJsYXN0U3ByaXRlIiwiX2FwcGx5U3ByaXRlRnJhbWUiLCJlbWl0IiwiU1BSSVRFX0ZSQU1FX0NIQU5HRUQiLCJfdHlwZSIsIl9mbHVzaEFzc2VtYmxlciIsIl9maWxsVHlwZSIsIlJBRElBTCIsIl9maWxsQ2VudGVyIiwieCIsInkiLCJGSUxMRUQiLCJfZmlsbFN0YXJ0IiwiX2ZpbGxSYW5nZSIsIl9pc1RyaW1tZWRNb2RlIiwiU0lNUExFIiwiQUREQ09MT1JBTkRURVhUVVJFIiwiX2luc3RhbmNlTWF0ZXJpYWwiLCJVSVJlbmRlckNvbXBvbmVudCIsIlR5cGUiLCJwcm9wZXJ0eSIsIkhPUklaT05UQUwiLCJWZWMyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXdDQTs7Ozs7OztNQU9LQSxVOzthQUFBQSxVO0FBQUFBLElBQUFBLFUsQ0FBQUEsVTtBQUFBQSxJQUFBQSxVLENBQUFBLFU7QUFBQUEsSUFBQUEsVSxDQUFBQSxVO0FBQUFBLElBQUFBLFUsQ0FBQUEsVTtLQUFBQSxVLEtBQUFBLFU7O0FBd0NMLG9CQUFPQSxVQUFQO0FBRUE7Ozs7Ozs7O01BT0tDLFE7O2FBQUFBLFE7QUFBQUEsSUFBQUEsUSxDQUFBQSxRO0FBQUFBLElBQUFBLFEsQ0FBQUEsUTtBQUFBQSxJQUFBQSxRLENBQUFBLFE7S0FBQUEsUSxLQUFBQSxROztBQTBCTCxvQkFBT0EsUUFBUDtBQUVBOzs7Ozs7OztNQU9LQyxR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QmdCO0FBQ1osZUFBTyxLQUFLOUMsU0FBWjtBQUNILE87d0JBQ2E0QixLLEVBQU87QUFDakIsWUFBSSxLQUFLNUIsU0FBTCxLQUFtQjRCLEtBQXZCLEVBQTZCO0FBQ3pCO0FBQ0g7O0FBRUQsYUFBSzVCLFNBQUwsR0FBaUI0QixLQUFqQjs7QUFDQSxZQUFJQSxLQUFLLEtBQUs1RSxRQUFRLENBQUM4RCxNQUF2QixFQUErQjtBQUMzQixlQUFLTSxnQkFBTDtBQUNIO0FBQ0o7Ozs7SUE1UmdDMkIsb0MsV0E4Um5CaEcsUSxHQUFXQSxRLFVBQ1hpRyxJLEdBQU9sRyxVLFVBQ1BFLFEsR0FBV0EsUSxVQUNYQyxTLEdBQVlBLFMsNnZDQW5EekJnRyx3QiwyVEFxREFBLHdCOzs7OzthQUM0QyxJOzs0RUFDNUNBLHdCOzs7OzthQUNpQm5HLFVBQVUsQ0FBQzhGLE07O2dGQUM1Qkssd0I7Ozs7O2FBQ3FCbEcsUUFBUSxDQUFDbUcsVTs7Z0ZBQzlCRCx3Qjs7Ozs7YUFDcUJqRyxRQUFRLENBQUNvRCxPOztrRkFDOUI2Qyx3Qjs7Ozs7YUFDNkIsSUFBSUUsWUFBSixDQUFTLENBQVQsRUFBWSxDQUFaLEM7O2lGQUM3QkYsd0I7Ozs7O2FBQ3NCLEM7O2lGQUN0QkEsd0I7Ozs7O2FBQ3NCLEM7O3FGQUN0QkEsd0I7Ozs7O2FBQzBCLEk7O29GQUMxQkEsd0I7Ozs7O2FBQ3lCLEs7OzhFQUV6QkEsd0I7Ozs7O2FBQ3NDLEk7Ozs7QUFpUzNDbEMsRUFBQUEsRUFBRSxDQUFDN0QsZUFBSCxHQUFxQkEsZUFBckIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gQ29weXJpZ2h0IChjKSAyMDEzLTIwMTYgQ2h1a29uZyBUZWNobm9sb2dpZXMgSW5jLlxyXG4gQ29weXJpZ2h0IChjKSAyMDE3LTIwMTggWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cDovL3d3dy5jb2Nvcy5jb21cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuICB3b3JsZHdpZGUsIHJveWFsdHktZnJlZSwgbm9uLWFzc2lnbmFibGUsIHJldm9jYWJsZSBhbmQgbm9uLWV4Y2x1c2l2ZSBsaWNlbnNlXHJcbiB0byB1c2UgQ29jb3MgQ3JlYXRvciBzb2xlbHkgdG8gZGV2ZWxvcCBnYW1lcyBvbiB5b3VyIHRhcmdldCBwbGF0Zm9ybXMuIFlvdSBzaGFsbFxyXG4gIG5vdCB1c2UgQ29jb3MgQ3JlYXRvciBzb2Z0d2FyZSBmb3IgZGV2ZWxvcGluZyBvdGhlciBzb2Z0d2FyZSBvciB0b29scyB0aGF0J3NcclxuICB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiAgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIENvY29zIENyZWF0b3IuXHJcblxyXG4gVGhlIHNvZnR3YXJlIG9yIHRvb2xzIGluIHRoaXMgTGljZW5zZSBBZ3JlZW1lbnQgYXJlIGxpY2Vuc2VkLCBub3Qgc29sZC5cclxuIFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLiByZXNlcnZlcyBhbGwgcmlnaHRzIG5vdCBleHByZXNzbHkgZ3JhbnRlZCB0byB5b3UuXHJcblxyXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG4gSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXHJcbiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcclxuIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXHJcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXHJcbiBUSEUgU09GVFdBUkUuXHJcbiovXHJcblxyXG4vKipcclxuICogQGNhdGVnb3J5IHVpXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgU3ByaXRlQXRsYXMsIFNwcml0ZUZyYW1lIH0gZnJvbSAnLi4vLi4vY29yZS9hc3NldHMnO1xyXG5pbXBvcnQgeyBjY2NsYXNzLCBoZWxwLCBleGVjdXRpb25PcmRlciwgbWVudSwgcHJvcGVydHkgfSBmcm9tICcuLi8uLi9jb3JlL2RhdGEvY2xhc3MtZGVjb3JhdG9yJztcclxuaW1wb3J0IHsgU3lzdGVtRXZlbnRUeXBlIH0gZnJvbSAnLi4vLi4vY29yZS9wbGF0Zm9ybS9ldmVudC1tYW5hZ2VyL2V2ZW50LWVudW0nO1xyXG5pbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoJztcclxuaW1wb3J0IHsgY2NlbnVtIH0gZnJvbSAnLi4vLi4vY29yZS92YWx1ZS10eXBlcy9lbnVtJztcclxuaW1wb3J0IHsgY2xhbXAgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgvdXRpbHMnO1xyXG5pbXBvcnQgeyBVSSB9IGZyb20gJy4uLy4uL2NvcmUvcmVuZGVyZXIvdWkvdWknO1xyXG5pbXBvcnQgeyBVSVJlbmRlckNvbXBvbmVudCwgSW5zdGFuY2VNYXRlcmlhbFR5cGUgfSBmcm9tICcuLi8uLi9jb3JlL2NvbXBvbmVudHMvdWktYmFzZS91aS1yZW5kZXItY29tcG9uZW50JztcclxuaW1wb3J0IHsgRURJVE9SIH0gZnJvbSAnaW50ZXJuYWw6Y29uc3RhbnRzJztcclxuXHJcbi8qKlxyXG4gKiBAZW5cclxuICogRW51bSBmb3Igc3ByaXRlIHR5cGUuXHJcbiAqXHJcbiAqIEB6aFxyXG4gKiBTcHJpdGUg57G75Z6L44CCXHJcbiAqL1xyXG5lbnVtIFNwcml0ZVR5cGUge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBzaW1wbGUgdHlwZS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOaZrumAmuexu+Wei+OAglxyXG4gICAgICovXHJcbiAgICBTSU1QTEUgPSAwLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBzbGljZWQgdHlwZS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWIh+eJh++8iOS5neWuq+agvO+8ieexu+Wei+OAglxyXG4gICAgICovXHJcbiAgICBTTElDRUQgPSAxLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSB0aWxlZCB0eXBlLlxyXG4gICAgICpcclxuICAgICAqIEB6aCAg5bmz6ZO657G75Z6LXHJcbiAgICAgKi9cclxuICAgIFRJTEVEID0gIDIsXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIGZpbGxlZCB0eXBlLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5aGr5YWF57G75Z6L44CCXHJcbiAgICAgKi9cclxuICAgIEZJTExFRCA9IDMsXHJcbiAgICAvLyAvKipcclxuICAgIC8vICAqIEBlbiBUaGUgbWVzaCB0eXBlLlxyXG4gICAgLy8gICogQHpoICDku6UgTWVzaCDkuInop5LlvaLnu4TmiJDnmoTnsbvlnotcclxuICAgIC8vICAqIEBwcm9wZXJ0eSB7TnVtYmVyfSBNRVNIXHJcbiAgICAvLyAgKi9cclxuICAgIC8vIE1FU0g6IDRcclxufVxyXG5cclxuY2NlbnVtKFNwcml0ZVR5cGUpO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBFbnVtIGZvciBmaWxsIHR5cGUuXHJcbiAqXHJcbiAqIEB6aFxyXG4gKiDloavlhYXnsbvlnovjgIJcclxuICovXHJcbmVudW0gRmlsbFR5cGUge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBob3Jpem9udGFsIGZpbGwuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmsLTlubPmlrnlkJHloavlhYXjgIJcclxuICAgICAqL1xyXG4gICAgSE9SSVpPTlRBTCA9IDAsXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIHZlcnRpY2FsIGZpbGwuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDlnoLnm7TmlrnlkJHloavlhYXjgIJcclxuICAgICAqL1xyXG4gICAgVkVSVElDQUwgPSAxLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSByYWRpYWwgZmlsbC5cclxuICAgICAqXHJcbiAgICAgKiBAemggIOW+hOWQkeWhq+WFhVxyXG4gICAgICovXHJcbiAgICBSQURJQUwgPSAyLFxyXG59XHJcblxyXG5jY2VudW0oRmlsbFR5cGUpO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBTcHJpdGUgU2l6ZSBjYW4gdHJhY2sgdHJpbW1lZCBzaXplLCByYXcgc2l6ZSBvciBub25lLlxyXG4gKlxyXG4gKiBAemhcclxuICog57K+54G15bC65a+46LCD5pW05qih5byP44CCXHJcbiAqL1xyXG5lbnVtIFNpemVNb2RlIHtcclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBVc2UgdGhlIGN1c3RvbWl6ZWQgbm9kZSBzaXplLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5L2/55So6IqC54K56aKE6K6+55qE5bC65a+444CCXHJcbiAgICAgKi9cclxuICAgIENVU1RPTSA9IDAsXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogTWF0Y2ggdGhlIHRyaW1tZWQgc2l6ZSBvZiB0aGUgc3ByaXRlIGZyYW1lIGF1dG9tYXRpY2FsbHkuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDoh6rliqjpgILphY3kuLrnsr7ngbXoo4HliarlkI7nmoTlsLrlr7jjgIJcclxuICAgICAqL1xyXG4gICAgVFJJTU1FRCA9IDEsXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogTWF0Y2ggdGhlIHJhdyBzaXplIG9mIHRoZSBzcHJpdGUgZnJhbWUgYXV0b21hdGljYWxseS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOiHquWKqOmAgumFjeS4uueyvueBteWOn+WbvuWwuuWvuOOAglxyXG4gICAgICovXHJcbiAgICBSQVcgPSAyLFxyXG59XHJcblxyXG5jY2VudW0oU2l6ZU1vZGUpO1xyXG5cclxuZW51bSBFdmVudFR5cGUge1xyXG4gICAgU1BSSVRFX0ZSQU1FX0NIQU5HRUQgPSAnc3ByaXRlZnJhbWUtY2hhbmdlZCcsXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAZW5cclxuICogUmVuZGVycyBhIHNwcml0ZSBpbiB0aGUgc2NlbmUuXHJcbiAqXHJcbiAqIEB6aFxyXG4gKiDmuLLmn5Pnsr7ngbXnu4Tku7bjgIJcclxuICovXHJcbkBjY2NsYXNzKCdjYy5TcHJpdGVDb21wb25lbnQnKVxyXG5AaGVscCgnaTE4bjpjYy5TcHJpdGVDb21wb25lbnQnKVxyXG5AZXhlY3V0aW9uT3JkZXIoMTEwKVxyXG5AbWVudSgnVUkvUmVuZGVyL1Nwcml0ZScpXHJcbmV4cG9ydCBjbGFzcyBTcHJpdGVDb21wb25lbnQgZXh0ZW5kcyBVSVJlbmRlckNvbXBvbmVudCB7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBzcHJpdGUgYXRsYXMgd2hlcmUgdGhlIHNwcml0ZSBpcy5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOeyvueBteeahOWbvumbhuOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFNwcml0ZUF0bGFzLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogNCxcclxuICAgICAgICB0b29sdGlwOiflm77niYfotYTmupDmiYDlsZ7nmoQgQXRsYXMg5Zu+6ZuG6LWE5rqQJyxcclxuICAgIH0pXHJcbiAgICBnZXQgc3ByaXRlQXRsYXMgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hdGxhcztcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc3ByaXRlQXRsYXMgKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2F0bGFzID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9hdGxhcyA9IHZhbHVlO1xyXG4vLyAgICAgICAgdGhpcy5zcHJpdGVGcmFtZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBzcHJpdGUgZnJhbWUgb2YgdGhlIHNwcml0ZS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOeyvueBteeahOeyvueBteW4p+OAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFNwcml0ZUZyYW1lLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogNSxcclxuICAgICAgICB0b29sdGlwOifmuLLmn5MgU3ByaXRlIOS9v+eUqOeahCBTcHJpdGVGcmFtZSDlm77niYfotYTmupAnLFxyXG4gICAgfSlcclxuICAgIGdldCBzcHJpdGVGcmFtZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nwcml0ZUZyYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBzcHJpdGVGcmFtZSAodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fc3ByaXRlRnJhbWUgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxhc3RTcHJpdGUgPSB0aGlzLl9zcHJpdGVGcmFtZTtcclxuICAgICAgICB0aGlzLl9zcHJpdGVGcmFtZSA9IHZhbHVlO1xyXG4gICAgICAgIC8vIHJlbmRlciAmIHVwZGF0ZSByZW5kZXIgZGF0YSBmbGFnIHdpbGwgYmUgdHJpZ2dlcmVkIHdoaWxlIGFwcGx5aW5nIG5ldyBzcHJpdGUgZnJhbWVcclxuICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKGZhbHNlKTtcclxuICAgICAgICB0aGlzLl9hcHBseVNwcml0ZUZyYW1lKGxhc3RTcHJpdGUpO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZW1pdChFdmVudFR5cGUuU1BSSVRFX0ZSQU1FX0NIQU5HRUQsIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIHNwcml0ZSByZW5kZXIgdHlwZS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOeyvueBtea4suafk+exu+Wei+OAglxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGB0eXBlc2NyaXB0XHJcbiAgICAgKiBzcHJpdGUudHlwZSA9IGNjLlNwcml0ZUNvbXBvbmVudC5UeXBlLlNJTVBMRTtcclxuICAgICAqIGBgYFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFNwcml0ZVR5cGUsXHJcbiAgICAgICAgZGlzcGxheU9yZGVyOiA2LFxyXG4gICAgICAgIHRvb2x0aXA6J+a4suafk+aooeW8j++8mlxcbi0g5pmu6YCa77yIU2ltcGxl77yJ77ya5L+u5pS55bC65a+45Lya5pW05L2T5ouJ5Ly45Zu+5YOP77yM6YCC55So5LqO5bqP5YiX5bin5Yqo55S75ZKM5pmu6YCa5Zu+5YOPIFxcbicgK1xyXG4gICAgICAgICctIOS5neWuq+agvO+8iFNsaWNlZO+8ie+8muS/ruaUueWwuuWvuOaXtuWbm+S4quinkueahOWMuuWfn+S4jeS8muaLieS8uO+8jOmAgueUqOS6jiBVSSDmjInpkq7lkozpnaLmnb/og4zmma8gXFxuJyArXHJcbiAgICAgICAgJy0g5aGr5YWF77yIRmlsbGVk77yJ77ya6K6+572u5LiA5a6a55qE5aGr5YWF6LW35aeL5L2N572u5ZKM5pa55ZCR77yM6IO95aSf5Lul5LiA5a6a5q+U546H5Ymq6KOB5pi+56S65Zu+54mHJyxcclxuICAgIH0pXHJcbiAgICBnZXQgdHlwZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XHJcbiAgICB9XHJcbiAgICBzZXQgdHlwZSAodmFsdWU6IFNwcml0ZVR5cGUpIHtcclxuICAgICAgICBpZiAodGhpcy5fdHlwZSAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHlwZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLl9mbHVzaEFzc2VtYmxlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIGZpbGwgdHlwZSwgVGhpcyB3aWxsIG9ubHkgaGF2ZSBhbnkgZWZmZWN0IGlmIHRoZSBcInR5cGVcIiBpcyBzZXQgdG8g4oCcU3ByaXRlQ29tcG9uZW50LlR5cGUuRklMTEVE4oCdLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog57K+54G15aGr5YWF57G75Z6L77yM5LuF5riy5p+T57G75Z6L6K6+572u5Li6IFNwcml0ZUNvbXBvbmVudC5UeXBlLkZJTExFRCDml7bmnInmlYjjgIJcclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgdHlwZXNjcmlwdFxyXG4gICAgICogc3ByaXRlLmZpbGxUeXBlID0gY2MuU3ByaXRlQ29tcG9uZW50LkZpbGxUeXBlLkhPUklaT05UQUw7XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0eXBlOiBGaWxsVHlwZSxcclxuICAgICAgICB0b29sdGlwOifloavlhYXmlrnlkJHvvIzlj6/ku6XpgInmi6nmqKrlkJHvvIhIb3Jpem9udGFs77yJ77yM57q15ZCR77yIVmVydGljYWzvvInlkozmiYflvaLvvIhSYWRpYWzvvInkuInnp43mlrnlkJEnLFxyXG4gICAgfSlcclxuICAgIGdldCBmaWxsVHlwZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGxUeXBlO1xyXG4gICAgfVxyXG4gICAgc2V0IGZpbGxUeXBlICh2YWx1ZTogRmlsbFR5cGUpIHtcclxuICAgICAgICBpZiAodGhpcy5fZmlsbFR5cGUgIT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gRmlsbFR5cGUuUkFESUFMIHx8IHRoaXMuX2ZpbGxUeXBlID09PSBGaWxsVHlwZS5SQURJQUwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVzdHJveVJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEgPSBudWxsO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JlbmRlckRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9maWxsVHlwZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuX2ZsdXNoQXNzZW1ibGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBmaWxsIENlbnRlciwgVGhpcyB3aWxsIG9ubHkgaGF2ZSBhbnkgZWZmZWN0IGlmIHRoZSBcInR5cGVcIiBpcyBzZXQgdG8g4oCcU3ByaXRlQ29tcG9uZW50LlR5cGUuRklMTEVE4oCdLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5aGr5YWF5Lit5b+D54K577yM5LuF5riy5p+T57G75Z6L6K6+572u5Li6IFNwcml0ZUNvbXBvbmVudC5UeXBlLkZJTExFRCDml7bmnInmlYjjgIJcclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgdHlwZXNjcmlwdFxyXG4gICAgICogc3ByaXRlLmZpbGxDZW50ZXIgPSBjYy52MigwLCAwKTtcclxuICAgICAqIGBgYFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHRvb2x0aXA6J+aJh+W9ouWhq+WFheaXtu+8jOaMh+WumuaJh+W9oueahOS4reW/g+eCue+8jOWPluWAvOiMg+WbtCAwIH4gMScsXHJcbiAgICB9KVxyXG4gICAgZ2V0IGZpbGxDZW50ZXIgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maWxsQ2VudGVyO1xyXG4gICAgfVxyXG4gICAgc2V0IGZpbGxDZW50ZXIgKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5fZmlsbENlbnRlci54ID0gdmFsdWUueDtcclxuICAgICAgICB0aGlzLl9maWxsQ2VudGVyLnkgPSB2YWx1ZS55O1xyXG4gICAgICAgIGlmICh0aGlzLl90eXBlID09PSBTcHJpdGVUeXBlLkZJTExFRCAmJiB0aGlzLl9yZW5kZXJEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWFya0ZvclVwZGF0ZVJlbmRlckRhdGEoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBmaWxsIFN0YXJ0LCBUaGlzIHdpbGwgb25seSBoYXZlIGFueSBlZmZlY3QgaWYgdGhlIFwidHlwZVwiIGlzIHNldCB0byDigJxTcHJpdGVDb21wb25lbnQuVHlwZS5GSUxMRUTigJ0uXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDloavlhYXotbflp4vngrnvvIzku4XmuLLmn5Pnsbvlnovorr7nva7kuLogU3ByaXRlQ29tcG9uZW50LlR5cGUuRklMTEVEIOaXtuacieaViOOAglxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGB0eXBlc2NyaXB0XHJcbiAgICAgKiAvLyAtMSBUbyAxIGJldHdlZW4gdGhlIG51bWJlcnNcclxuICAgICAqIHNwcml0ZS5maWxsU3RhcnQgPSAwLjU7XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICByYW5nZTogWzAsIDEsIDAuMV0sXHJcbiAgICAgICAgdG9vbHRpcDon5aGr5YWF6LW35aeL5L2N572u77yM6L6T5YWl5LiA5LiqIDAgfiAxIOS5i+mXtOeahOWwj+aVsOihqOekuui1t+Wni+S9jee9rueahOeZvuWIhuavlCcsXHJcbiAgICB9KVxyXG4gICAgZ2V0IGZpbGxTdGFydCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGxTdGFydDtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgZmlsbFN0YXJ0ICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuX2ZpbGxTdGFydCA9IGNsYW1wKHZhbHVlLCAtMSwgMSk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3R5cGUgPT09IFNwcml0ZVR5cGUuRklMTEVEICYmIHRoaXMuX3JlbmRlckRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5tYXJrRm9yVXBkYXRlUmVuZGVyRGF0YSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEYXRhLnV2RGlydHkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIGZpbGwgUmFuZ2UsIFRoaXMgd2lsbCBvbmx5IGhhdmUgYW55IGVmZmVjdCBpZiB0aGUgXCJ0eXBlXCIgaXMgc2V0IHRvIOKAnFNwcml0ZUNvbXBvbmVudC5UeXBlLkZJTExFROKAnS5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWhq+WFheiMg+WbtO+8jOS7hea4suafk+exu+Wei+iuvue9ruS4uiBTcHJpdGVDb21wb25lbnQuVHlwZS5GSUxMRUQg5pe25pyJ5pWI44CCXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIC8vIC0xIFRvIDEgYmV0d2VlbiB0aGUgbnVtYmVyc1xyXG4gICAgICogc3ByaXRlLmZpbGxSYW5nZSA9IDE7XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICByYW5nZTogWzAsIDEsIDAuMV0sXHJcbiAgICAgICAgdG9vbHRpcDon5aGr5YWF5oC76YeP77yM5Y+W5YC86IyD5Zu0IDAgfiAxIOaMh+WumuaYvuekuuWbvuWDj+iMg+WbtOeahOeZvuWIhuavlCcsXHJcbiAgICB9KVxyXG4gICAgZ2V0IGZpbGxSYW5nZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGxSYW5nZTtcclxuICAgIH1cclxuICAgIHNldCBmaWxsUmFuZ2UgKHZhbHVlKSB7XHJcbiAgICAgICAgLy8gPz8/IC0xIH4gMVxyXG4gICAgICAgIHRoaXMuX2ZpbGxSYW5nZSA9IGNsYW1wKHZhbHVlLCAwLCAxKTtcclxuICAgICAgICBpZiAodGhpcy5fdHlwZSA9PT0gU3ByaXRlVHlwZS5GSUxMRUQgJiYgdGhpcy5fcmVuZGVyRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEudXZEaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIHNwZWNpZnkgdGhlIGZyYW1lIGlzIHRyaW1tZWQgb3Igbm90LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5piv5ZCm5L2/55So6KOB5Ymq5qih5byP44CCXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIHNwcml0ZS50cmltID0gdHJ1ZTtcclxuICAgICAqIGBgYFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogOCxcclxuICAgICAgICB0b29sdGlwOifoioLngrnnuqbmnZ/moYblhoXmmK/lkKbljIXmi6zpgI/mmI7lg4/ntKDljLrln5/vvIzli77pgInmraTpobnkvJrljrvpmaToioLngrnnuqbmnZ/moYblhoXnmoTpgI/mmI7ljLrln58nLFxyXG4gICAgfSlcclxuICAgIGdldCB0cmltICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNUcmltbWVkTW9kZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgdHJpbSAodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5faXNUcmltbWVkTW9kZSA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5faXNUcmltbWVkTW9kZSA9IHZhbHVlO1xyXG4gICAgICAgIGlmICgodGhpcy5fdHlwZSA9PT0gU3ByaXRlVHlwZS5TSU1QTEUgLyp8fCB0aGlzLl90eXBlID09PSBTcHJpdGVUeXBlLk1FU0gqLykgJiZcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHlcclxuICAgIGdldCBncmF5c2NhbGUgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl91c2VHcmF5c2NhbGU7XHJcbiAgICB9XHJcbiAgICBzZXQgZ3JheXNjYWxlICh2YWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VHcmF5c2NhbGUgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdXNlR3JheXNjYWxlID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlTWF0ZXJpYWxUeXBlID0gSW5zdGFuY2VNYXRlcmlhbFR5cGUuR1JBWVNDQUxFOyB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlTWF0ZXJpYWxUeXBlID0gSW5zdGFuY2VNYXRlcmlhbFR5cGUuQUREQ09MT1JBTkRURVhUVVJFO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9pbnN0YW5jZU1hdGVyaWFsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFNwZWNpZnkgdGhlIHNpemUgdHJhY2luZyBtb2RlLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog57K+54G15bC65a+46LCD5pW05qih5byP44CCXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIHNwcml0ZS5zaXplTW9kZSA9IGNjLlNwcml0ZUNvbXBvbmVudC5TaXplTW9kZS5DVVNUT007XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0eXBlOiBTaXplTW9kZSxcclxuICAgICAgICBkaXNwbGF5T3JkZXI6IDcsXHJcbiAgICAgICAgdG9vbHRpcDon5oyH5a6aIFNwcml0ZSDmiYDlnKjoioLngrnnmoTlsLrlr7jvvIxDVVNUT00g6KGo56S66Ieq5a6a5LmJ5bC65a+477yMVFJJTU1FRCDooajnpLrlj5bljp/lp4vlm77niYfliaroo4HpgI/mmI7lg4/ntKDlkI7nmoTlsLrlr7jvvIxSQVcg6KGo56S65Y+W5Y6f5aeL5Zu+54mH5pyq5Ymq6KOB55qE5bC65a+4JyxcclxuICAgIH0pXHJcbiAgICBnZXQgc2l6ZU1vZGUgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplTW9kZTtcclxuICAgIH1cclxuICAgIHNldCBzaXplTW9kZSAodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2l6ZU1vZGUgPT09IHZhbHVlKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc2l6ZU1vZGUgPSB2YWx1ZTtcclxuICAgICAgICBpZiAodmFsdWUgIT09IFNpemVNb2RlLkNVU1RPTSkge1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseVNwcml0ZVNpemUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGaWxsVHlwZSA9IEZpbGxUeXBlO1xyXG4gICAgcHVibGljIHN0YXRpYyBUeXBlID0gU3ByaXRlVHlwZTtcclxuICAgIHB1YmxpYyBzdGF0aWMgU2l6ZU1vZGUgPSBTaXplTW9kZTtcclxuICAgIHB1YmxpYyBzdGF0aWMgRXZlbnRUeXBlID0gRXZlbnRUeXBlO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9zcHJpdGVGcmFtZTogU3ByaXRlRnJhbWUgfCBudWxsID0gbnVsbDtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF90eXBlID0gU3ByaXRlVHlwZS5TSU1QTEU7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfZmlsbFR5cGUgPSBGaWxsVHlwZS5IT1JJWk9OVEFMO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX3NpemVNb2RlID0gU2l6ZU1vZGUuVFJJTU1FRDtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9maWxsQ2VudGVyOiBWZWMyID0gbmV3IFZlYzIoMCwgMCk7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfZmlsbFN0YXJ0ID0gMDtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9maWxsUmFuZ2UgPSAwO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX2lzVHJpbW1lZE1vZGUgPSB0cnVlO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX3VzZUdyYXlzY2FsZSA9IGZhbHNlO1xyXG4gICAgLy8gX3N0YXRlID0gMDtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9hdGxhczogU3ByaXRlQXRsYXMgfCBudWxsID0gbnVsbDtcclxuICAgIC8vIHN0YXRpYyBTdGF0ZSA9IFN0YXRlO1xyXG5cclxuICAgIHB1YmxpYyBfX3ByZWxvYWQgKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl91c2VHcmF5c2NhbGUpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5zdGFuY2VNYXRlcmlhbFR5cGUgPSBJbnN0YW5jZU1hdGVyaWFsVHlwZS5HUkFZU0NBTEU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc3VwZXIuX19wcmVsb2FkKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLl9fcHJlbG9hZCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKEVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNpemVkKCk7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5vbihTeXN0ZW1FdmVudFR5cGUuU0laRV9DSEFOR0VELCB0aGlzLl9yZXNpemVkLCB0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX3Nwcml0ZUZyYW1lKXtcclxuICAgICAgICAgICAgdGhpcy5fc3ByaXRlRnJhbWUub24oJ2xvYWQnLCB0aGlzLl9tYXJrRm9yVXBkYXRlVXZEaXJ0eSwgdGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX21hcmtGb3JVcGRhdGVVdkRpcnR5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIC8qKlxyXG4gICAgLy8gICogQ2hhbmdlIHRoZSBzdGF0ZSBvZiBzcHJpdGUuXHJcbiAgICAvLyAgKiBAbWV0aG9kIHNldFN0YXRlXHJcbiAgICAvLyAgKiBAc2VlIGBTcHJpdGVDb21wb25lbnQuU3RhdGVgXHJcbiAgICAvLyAgKiBAcGFyYW0gc3RhdGUge1Nwcml0ZUNvbXBvbmVudC5TdGF0ZX0gTk9STUFMIG9yIEdSQVkgU3RhdGUuXHJcbiAgICAvLyAgKi9cclxuICAgIC8vIGdldFN0YXRlKCkge1xyXG4gICAgLy8gICAgIHJldHVybiB0aGlzLl9zdGF0ZTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyBzZXRTdGF0ZShzdGF0ZSkge1xyXG4gICAgLy8gICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gc3RhdGUpIHJldHVybjtcclxuICAgIC8vICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgLy8gICAgIHRoaXMuX2FjdGl2YXRlTWF0ZXJpYWwoKTtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyBvbkxvYWQoKSB7fVxyXG5cclxuICAgIHB1YmxpYyBvbkVuYWJsZSAoKSB7XHJcbiAgICAgICAgc3VwZXIub25FbmFibGUoKTtcclxuXHJcbiAgICAgICAgLy8gdGhpcy5fZmx1c2hBc3NlbWJsZXIoKTtcclxuICAgICAgICB0aGlzLl9hY3RpdmF0ZU1hdGVyaWFsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRGVzdHJveSAoKSB7XHJcbiAgICAgICAgc3VwZXIub25EZXN0cm95KCk7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95UmVuZGVyRGF0YSgpO1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLm9mZihTeXN0ZW1FdmVudFR5cGUuU0laRV9DSEFOR0VELCB0aGlzLl9yZXNpemVkLCB0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9zcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zcHJpdGVGcmFtZS5vZmYoJ2xvYWQnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFF1aWNrbHkgc3dpdGNoIHRvIG90aGVyIHNwcml0ZSBmcmFtZSBpbiB0aGUgc3ByaXRlIGF0bGFzLlxyXG4gICAgICogSWYgdGhlcmUgaXMgbm8gYXRsYXMsIHRoZSBzd2l0Y2ggZmFpbHMuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDnsr7ngbXlm77pm4blhoXnmoTnsr7ngbXmm7/mjaJcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2hhbmdlU3ByaXRlRnJhbWVGcm9tQXRsYXMgKG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIGlmICghdGhpcy5fYXRsYXMpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKCdTcHJpdGVBdGxhcyBpcyBudWxsLicpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNwcml0ZSA9IHRoaXMuX2F0bGFzLmdldFNwcml0ZUZyYW1lKG5hbWUpO1xyXG4gICAgICAgIHRoaXMuc3ByaXRlRnJhbWUgPSBzcHJpdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9yZW5kZXIgKHJlbmRlcjogVUkpIHtcclxuICAgICAgICByZW5kZXIuY29tbWl0Q29tcCh0aGlzLCB0aGlzLl9zcHJpdGVGcmFtZSEuZ2V0R0ZYVGV4dHVyZVZpZXcoKSwgdGhpcy5fYXNzZW1ibGVyISwgdGhpcy5fc3ByaXRlRnJhbWUhLnRleHR1cmUuZ2V0R0ZYU2FtcGxlcigpKTtcclxuICAgICAgICAvLyByZW5kZXIuY29tbWl0Q29tcCh0aGlzLCB0aGlzLl9zcHJpdGVGcmFtZSEuZ2V0R0ZYVGV4dHVyZVZpZXcoKSwgdGhpcy5fYXNzZW1ibGVyISk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9jYW5SZW5kZXIgKCkge1xyXG4gICAgICAgIC8vIGlmIChjYy5nYW1lLnJlbmRlclR5cGUgPT09IGNjLmdhbWUuUkVOREVSX1RZUEVfQ0FOVkFTKSB7XHJcbiAgICAgICAgLy8gICAgIGlmICghdGhpcy5fZW5hYmxlZCkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgIC8vICAgICBpZiAoIXRoaXMuX2VuYWJsZWQgfHwgIXRoaXMuX21hdGVyaWFsKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgLy8gY29uc3Qgc3ByaXRlRnJhbWUgPSB0aGlzLl9zcHJpdGVGcmFtZTtcclxuICAgICAgICAvLyBpZiAoIXNwcml0ZUZyYW1lIHx8ICFzcHJpdGVGcmFtZS50ZXh0dXJlTG9hZGVkKCkpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAoIXN1cGVyLl9jYW5SZW5kZXIoKSl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHNwcml0ZUZyYW1lID0gdGhpcy5fc3ByaXRlRnJhbWU7XHJcbiAgICAgICAgaWYgKCFzcHJpdGVGcmFtZSB8fCAhc3ByaXRlRnJhbWUudGV4dHVyZUxvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfZmx1c2hBc3NlbWJsZXIgKCkge1xyXG4gICAgICAgIGNvbnN0IGFzc2VtYmxlciA9IFNwcml0ZUNvbXBvbmVudC5Bc3NlbWJsZXIhLmdldEFzc2VtYmxlcih0aGlzKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2Fzc2VtYmxlciAhPT0gYXNzZW1ibGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveVJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgdGhpcy5fYXNzZW1ibGVyID0gYXNzZW1ibGVyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9yZW5kZXJEYXRhKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hc3NlbWJsZXIgJiYgdGhpcy5fYXNzZW1ibGVyLmNyZWF0ZURhdGEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEgPSB0aGlzLl9hc3NlbWJsZXIuY3JlYXRlRGF0YSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEhLm1hdGVyaWFsID0gdGhpcy5fbWF0ZXJpYWw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVDb2xvcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2FwcGx5U3ByaXRlU2l6ZSAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nwcml0ZUZyYW1lKSB7XHJcbiAgICAgICAgICAgIGlmIChTaXplTW9kZS5SQVcgPT09IHRoaXMuX3NpemVNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gdGhpcy5fc3ByaXRlRnJhbWUub3JpZ2luYWxTaXplO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNldENvbnRlbnRTaXplKHNpemUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKFNpemVNb2RlLlRSSU1NRUQgPT09IHRoaXMuX3NpemVNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5fc3ByaXRlRnJhbWUuZ2V0UmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnNldENvbnRlbnRTaXplKHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fYWN0aXZhdGVNYXRlcmlhbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZXNpemVkICgpIHtcclxuICAgICAgICBpZiAoIUVESVRPUikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fc3ByaXRlRnJhbWUpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsU2l6ZSA9IHRoaXMubm9kZS5nZXRDb250ZW50U2l6ZSgpO1xyXG4gICAgICAgICAgICBsZXQgZXhwZWN0ZWRXID0gYWN0dWFsU2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgbGV0IGV4cGVjdGVkSCA9IGFjdHVhbFNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fc2l6ZU1vZGUgPT09IFNpemVNb2RlLlJBVykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IHRoaXMuX3Nwcml0ZUZyYW1lLmdldE9yaWdpbmFsU2l6ZSgpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRXID0gc2l6ZS53aWR0aDtcclxuICAgICAgICAgICAgICAgIGV4cGVjdGVkSCA9IHNpemUuaGVpZ2h0O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3NpemVNb2RlID09PSBTaXplTW9kZS5UUklNTUVEKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5fc3ByaXRlRnJhbWUuZ2V0UmVjdCgpO1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWRXID0gcmVjdC53aWR0aDtcclxuICAgICAgICAgICAgICAgIGV4cGVjdGVkSCA9IHJlY3QuaGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV4cGVjdGVkVyAhPT0gYWN0dWFsU2l6ZS53aWR0aCB8fCBleHBlY3RlZEggIT09IGFjdHVhbFNpemUuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zaXplTW9kZSA9IFNpemVNb2RlLkNVU1RPTTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9hY3RpdmF0ZU1hdGVyaWFsICgpIHtcclxuICAgICAgICBjb25zdCBzcHJpdGVGcmFtZSA9IHRoaXMuX3Nwcml0ZUZyYW1lO1xyXG4gICAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5fbWF0ZXJpYWw7XHJcbiAgICAgICAgLy8gV2ViR0xcclxuICAgICAgICBpZiAoY2MuZ2FtZS5yZW5kZXJUeXBlICE9PSBjYy5nYW1lLlJFTkRFUl9UWVBFX0NBTlZBUykge1xyXG4gICAgICAgICAgICAvLyBpZiAoIW1hdGVyaWFsKSB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLl9tYXRlcmlhbCA9IGNjLmJ1aWx0aW5SZXNNZ3IuZ2V0KCdzcHJpdGUtbWF0ZXJpYWwnKTtcclxuICAgICAgICAgICAgLy8gICAgIG1hdGVyaWFsID0gdGhpcy5fbWF0ZXJpYWw7XHJcbiAgICAgICAgICAgIC8vICAgICBpZiAoc3ByaXRlRnJhbWUgJiYgc3ByaXRlRnJhbWUudGV4dHVyZUxvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgbWF0ZXJpYWwhLnNldFByb3BlcnR5KCdtYWluVGV4dHVyZScsIHNwcml0ZUZyYW1lKTtcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgLy8gVE9ETzogdXNlIGVkaXRvciBhc3NldHNcclxuICAgICAgICAgICAgLy8gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChzcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hdGVyaWFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgbWF0VGV4dHVyZSA9IG1hdGVyaWFsLmdldFByb3BlcnR5KCdtYWluVGV4dHVyZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIChtYXRUZXh0dXJlICE9PSBzcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hdGVyaWFsLnNldFByb3BlcnR5KCdtYWluVGV4dHVyZScsIHNwcml0ZUZyYW1lLnRleHR1cmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFya0ZvclVwZGF0ZVJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZW5kZXJEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJEYXRhLm1hdGVyaWFsID0gbWF0ZXJpYWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgIC8vIHRoaXMubWFya0ZvclJlbmRlcih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbi8qXHJcbiAgICBwcml2YXRlIF9hcHBseUF0bGFzIChzcHJpdGVGcmFtZTogU3ByaXRlRnJhbWUgfCBudWxsKSB7XHJcbiAgICAgICAgaWYgKCFFRElUT1IpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXQgYXRsYXNcclxuICAgICAgICBpZiAoc3ByaXRlRnJhbWUpIHtcclxuICAgICAgICAgICAgaWYgKHNwcml0ZUZyYW1lLmF0bGFzVXVpZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2F0bGFzIHx8IHRoaXMuX2F0bGFzLl91dWlkICE9PSBzcHJpdGVGcmFtZS5hdGxhc1V1aWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBBc3NldExpYnJhcnkubG9hZEFzc2V0KHNwcml0ZUZyYW1lLmF0bGFzVXVpZCwgKGVyciwgYXNzZXQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fYXRsYXMgPSBhc3NldDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdGxhcyA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiovXHJcbiAgICBwcml2YXRlIF9vblRleHR1cmVMb2FkZWQgKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2FwcGx5U3ByaXRlU2l6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2FwcGx5U3ByaXRlRnJhbWUgKG9sZEZyYW1lOiBTcHJpdGVGcmFtZSB8IG51bGwpIHtcclxuICAgICAgICAvLyBpZiAob2xkRnJhbWUgJiYgb2xkRnJhbWUub2ZmKSB7XHJcbiAgICAgICAgLy8gICAgIG9sZEZyYW1lLm9mZignbG9hZCcsIHRoaXMuX29uVGV4dHVyZUxvYWRlZCwgdGhpcyk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICBjb25zdCBzcHJpdGVGcmFtZSA9IHRoaXMuX3Nwcml0ZUZyYW1lO1xyXG4gICAgICAgIC8vIGlmICghc3ByaXRlRnJhbWUgfHwgKHRoaXMuX21hdGVyaWFsICYmIHRoaXMuX21hdGVyaWFsLl90ZXh0dXJlKSAhPT0gKHNwcml0ZUZyYW1lICYmIHNwcml0ZUZyYW1lLl90ZXh0dXJlKSkge1xyXG4gICAgICAgIC8vICAgICAvLyBkaXNhYmxlIHJlbmRlciBmbG93IHVudGlsIHRleHR1cmUgaXMgbG9hZGVkXHJcbiAgICAgICAgLy8gICAgIHRoaXMubWFya0ZvclJlbmRlcihmYWxzZSk7XHJcbiAgICAgICAgLy8gfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fcmVuZGVyRGF0YSkge1xyXG4gICAgICAgICAgICBpZihvbGRGcmFtZSl7XHJcbiAgICAgICAgICAgICAgICBvbGRGcmFtZS5vZmYoJ2xvYWQnLCB0aGlzLl9tYXJrRm9yVXBkYXRlVXZEaXJ0eSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKHNwcml0ZUZyYW1lKXtcclxuICAgICAgICAgICAgICAgIHNwcml0ZUZyYW1lLm9uKCdsb2FkJywgdGhpcy5fbWFya0ZvclVwZGF0ZVV2RGlydHksIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX3JlbmRlckRhdGEudXZEaXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9sZEZyYW1lICYmIHNwcml0ZUZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyRGF0YS51dkRpcnR5ID0gb2xkRnJhbWUudXZIYXNoICE9PSBzcHJpdGVGcmFtZS51dkhhc2g7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEhLnV2RGlydHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEYXRhRmxhZyA9IHRoaXMuX3JlbmRlckRhdGEhLnV2RGlydHlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChzcHJpdGVGcmFtZSkge1xyXG4gICAgICAgICAgICBpZiAoIW9sZEZyYW1lIHx8IHNwcml0ZUZyYW1lICE9PSBvbGRGcmFtZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fbWF0ZXJpYWwuc2V0UHJvcGVydHkoJ21haW5UZXh0dXJlJywgc3ByaXRlRnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNwcml0ZUZyYW1lLmxvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVGV4dHVyZUxvYWRlZCgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzcHJpdGVGcmFtZS5vbmNlKCdsb2FkJywgdGhpcy5fb25UZXh0dXJlTG9hZGVkLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuLypcclxuICAgICAgICBpZiAoRURJVE9SKSB7XHJcbiAgICAgICAgICAgIC8vIFNldCBhdGxhc1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseUF0bGFzKHNwcml0ZUZyYW1lKTtcclxuICAgICAgICB9XHJcbiovXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlvLrliLbliLfmlrAgdXbjgIJcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfbWFya0ZvclVwZGF0ZVV2RGlydHkgKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9yZW5kZXJEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGEudXZEaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGFGbGFnID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmNjLlNwcml0ZUNvbXBvbmVudCA9IFNwcml0ZUNvbXBvbmVudDtcclxuIl19