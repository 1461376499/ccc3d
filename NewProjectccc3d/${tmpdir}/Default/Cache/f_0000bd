(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../math/vec2.js", "../platform/event-manager/event-enum.js", "../platform/event-manager/event-manager.js", "../event/callbacks-invoker.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../math/vec2.js"), require("../platform/event-manager/event-enum.js"), require("../platform/event-manager/event-manager.js"), require("../event/callbacks-invoker.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.vec2, global.eventEnum, global.eventManager, global.callbacksInvoker);
    global.nodeEventProcessor = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _vec, _eventEnum, _eventManager, _callbacksInvoker) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.NodeEventProcessor = void 0;

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  var _cachedArray = new Array(16);

  var _currentHovered = null;
  var pos = new _vec.Vec2();
  var _touchEvents = [_eventEnum.SystemEventType.TOUCH_START.toString(), _eventEnum.SystemEventType.TOUCH_MOVE.toString(), _eventEnum.SystemEventType.TOUCH_END.toString(), _eventEnum.SystemEventType.TOUCH_CANCEL.toString()];
  var _mouseEvents = [_eventEnum.SystemEventType.MOUSE_DOWN.toString(), _eventEnum.SystemEventType.MOUSE_ENTER.toString(), _eventEnum.SystemEventType.MOUSE_MOVE.toString(), _eventEnum.SystemEventType.MOUSE_LEAVE.toString(), _eventEnum.SystemEventType.MOUSE_UP.toString(), _eventEnum.SystemEventType.MOUSE_WHEEL.toString()]; // TODO: rearrange event

  function _touchStartHandler(touch, event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return false;
    }

    touch.getUILocation(pos);

    if (node._uiProps.uiTransformComp.isHit(pos, this)) {
      event.type = _eventEnum.SystemEventType.TOUCH_START.toString();
      event.touch = touch;
      event.bubbles = true;
      node.dispatchEvent(event);
      return true;
    }

    return false;
  }

  function _touchMoveHandler(touch, event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return false;
    }

    event.type = _eventEnum.SystemEventType.TOUCH_MOVE.toString();
    event.touch = touch;
    event.bubbles = true;
    node.dispatchEvent(event);
  }

  function _touchEndHandler(touch, event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    touch.getUILocation(pos);

    if (node._uiProps.uiTransformComp.isHit(pos, this)) {
      event.type = _eventEnum.SystemEventType.TOUCH_END.toString();
    } else {
      event.type = _eventEnum.SystemEventType.TOUCH_CANCEL.toString();
    }

    event.touch = touch;
    event.bubbles = true;
    node.dispatchEvent(event);
  }

  function _touchCancelHandler(touch, event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    event.type = _eventEnum.SystemEventType.TOUCH_CANCEL.toString();
    event.touch = touch;
    event.bubbles = true;
    node.dispatchEvent(event);
  }

  function _mouseDownHandler(event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    pos = event.getUILocation();

    if (node._uiProps.uiTransformComp.isHit(pos, this)) {
      event.type = _eventEnum.SystemEventType.MOUSE_DOWN.toString();
      event.bubbles = true;
      node.dispatchEvent(event);
    }
  }

  function _mouseMoveHandler(event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    pos = event.getUILocation();

    var hit = node._uiProps.uiTransformComp.isHit(pos, this);

    if (hit) {
      if (!this._previousIn) {
        // Fix issue when hover node switched, previous hovered node won't get MOUSE_LEAVE notification
        if (_currentHovered && _currentHovered.eventProcessor.mouseListener) {
          event.type = _eventEnum.SystemEventType.MOUSE_LEAVE;

          _currentHovered.dispatchEvent(event);

          if (_currentHovered.eventProcessor.mouseListener) {
            _currentHovered.eventProcessor.mouseListener._previousIn = false;
          }
        }

        _currentHovered = node;
        event.type = _eventEnum.SystemEventType.MOUSE_ENTER.toString();
        node.dispatchEvent(event);
        this._previousIn = true;
      }

      event.type = _eventEnum.SystemEventType.MOUSE_MOVE.toString();
      event.bubbles = true;
      node.dispatchEvent(event);
    } else if (this._previousIn) {
      event.type = _eventEnum.SystemEventType.MOUSE_LEAVE.toString();
      node.dispatchEvent(event);
      this._previousIn = false;
      _currentHovered = null;
    } else {
      // continue dispatching
      return;
    } // Event processed, cleanup
    // event.propagationStopped = true;


    event.propagationStopped = true;
  }

  function _mouseUpHandler(event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    pos = event.getUILocation();

    if (node._uiProps.uiTransformComp.isHit(pos, this)) {
      event.type = _eventEnum.SystemEventType.MOUSE_UP.toString();
      event.bubbles = true;
      node.dispatchEvent(event); // event.propagationStopped = true;

      event.propagationStopped = true;
    }
  }

  function _mouseWheelHandler(event) {
    var node = this.owner;

    if (!node || !node._uiProps.uiTransformComp) {
      return;
    }

    pos = event.getUILocation();

    if (node._uiProps.uiTransformComp.isHit(pos, this)) {
      event.type = _eventEnum.SystemEventType.MOUSE_WHEEL.toString();
      event.bubbles = true;
      node.dispatchEvent(event); // event.propagationStopped = true;

      event.propagationStopped = true;
    }
  }

  function _doDispatchEvent(owner, event) {
    var target;
    var i = 0;
    event.target = owner; // Event.CAPTURING_PHASE

    _cachedArray.length = 0;
    owner.eventProcessor.getCapturingTargets(event.type, _cachedArray); // capturing

    event.eventPhase = 1;

    for (i = _cachedArray.length - 1; i >= 0; --i) {
      target = _cachedArray[i];

      if (target.eventProcessor.capturingTargets) {
        event.currentTarget = target; // fire event

        target.eventProcessor.capturingTargets.emit(event.type, event, _cachedArray); // check if propagation stopped

        if (event.propagationStopped) {
          _cachedArray.length = 0;
          return;
        }
      }
    }

    _cachedArray.length = 0; // Event.AT_TARGET
    // checks if destroyed in capturing callbacks

    event.eventPhase = 2;
    event.currentTarget = owner;

    if (owner.eventProcessor.capturingTargets) {
      owner.eventProcessor.capturingTargets.emit(event.type, event);
    }

    if (!event.propagationImmediateStopped && owner.eventProcessor.bubblingTargets) {
      owner.eventProcessor.bubblingTargets.emit(event.type, event);
    }

    if (!event.propagationStopped && event.bubbles) {
      // Event.BUBBLING_PHASE
      owner.eventProcessor.getBubblingTargets(event.type, _cachedArray); // propagate

      event.eventPhase = 3;

      for (i = 0; i < _cachedArray.length; ++i) {
        target = _cachedArray[i];

        if (target.eventProcessor.bubblingTargets) {
          event.currentTarget = target; // fire event

          target.eventProcessor.bubblingTargets.emit(event.type, event); // check if propagation stopped

          if (event.propagationStopped) {
            _cachedArray.length = 0;
            return;
          }
        }
      }
    }

    _cachedArray.length = 0;
  }

  function _searchMaskInParent(node) {
    var Mask = cc.MaskComponent;

    if (Mask) {
      var index = 0;

      for (var curr = node; curr && cc.Node.isNode(curr); curr = curr.parent, ++index) {
        if (curr.getComponent(Mask)) {
          return {
            index: index,
            node: curr
          };
        }
      }
    }

    return null;
  }

  function _checkListeners(node, events) {
    if (!node._persistNode) {
      if (node.eventProcessor.bubblingTargets) {
        for (var i = 0; i < events.length; ++i) {
          if (node.eventProcessor.bubblingTargets.hasEventListener(events[i])) {
            return true;
          }
        }
      }

      if (node.eventProcessor.capturingTargets) {
        for (var _i = 0; _i < events.length; ++_i) {
          if (node.eventProcessor.capturingTargets.hasEventListener(events[_i])) {
            return true;
          }
        }
      }

      return false;
    }

    return true;
  }
  /**
   * @zh
   * 节点事件类。
   */


  var NodeEventProcessor = /*#__PURE__*/function () {
    _createClass(NodeEventProcessor, [{
      key: "node",
      get: function get() {
        return this._node;
      }
      /**
       * @zh
       * 节点冒泡事件监听器
       */

    }]);

    function NodeEventProcessor(node) {
      _classCallCheck(this, NodeEventProcessor);

      this.bubblingTargets = null;
      this.capturingTargets = null;
      this.touchListener = null;
      this.mouseListener = null;
      this._node = void 0;
      this._node = node;
    }

    _createClass(NodeEventProcessor, [{
      key: "reattach",
      value: function reattach() {
        if (this.touchListener) {
          var mask = this.touchListener.mask = _searchMaskInParent(this._node);

          if (this.mouseListener) {
            this.mouseListener.mask = mask;
          }
        } else if (this.mouseListener) {
          this.mouseListener.mask = _searchMaskInParent(this._node);
        }
      }
    }, {
      key: "destroy",
      value: function destroy() {
        if (_currentHovered === this._node) {
          _currentHovered = null;
        } // Remove all event listeners if necessary


        if (this.touchListener || this.mouseListener) {
          _eventManager.eventManager.removeListeners(this._node);

          if (this.touchListener) {
            this.touchListener.owner = null;
            this.touchListener.mask = null;
            this.touchListener = null;
          }

          if (this.mouseListener) {
            this.mouseListener.owner = null;
            this.mouseListener.mask = null;
            this.mouseListener = null;
          }
        }

        this.capturingTargets && this.capturingTargets.clear();
        this.bubblingTargets && this.bubblingTargets.clear();
      }
      /**
       * @zh
       * 在节点上注册指定类型的回调函数，也可以设置 target 用于绑定响应函数的 this 对象。<br/>
       * 鼠标或触摸事件会被系统调用 dispatchEvent 方法触发，触发的过程包含三个阶段：<br/>
       * 1. 捕获阶段：派发事件给捕获目标（通过 `getCapturingTargets` 获取），比如，节点树中注册了捕获阶段的父节点，从根节点开始派发直到目标节点。<br/>
       * 2. 目标阶段：派发给目标节点的监听器。<br/>
       * 3. 冒泡阶段：派发事件给冒泡目标（通过 `getBubblingTargets` 获取），比如，节点树中注册了冒泡阶段的父节点，从目标节点开始派发直到根节点。<br/>
       * 同时您可以将事件派发到父节点或者通过调用 stopPropagation 拦截它。<br/>
       * 推荐使用这种方式来监听节点上的触摸或鼠标事件，请不要在节点上直接使用 cc.eventManager。<br/>
       * 你也可以注册自定义事件到节点上，并通过 emit 方法触发此类事件，对于这类事件，不会发生捕获冒泡阶段，只会直接派发给注册在该节点上的监听器。<br/>
       * 你可以通过在 emit 方法调用时在 type 之后传递额外的参数作为事件回调的参数列表。<br/>
       *
       * @param type - 一个监听事件类型的字符串。参见：[[EventType]]
       * @param callback - 事件分派时将被调用的回调函数。如果该回调存在则不会重复添加。
       * @param callback.event - 事件派发的时候回调的第一个参数。
       * @param callback.arg2 - 第二个参数。
       * @param callback.arg3 - 第三个参数。
       * @param callback.arg4 - 第四个参数。
       * @param callback.arg5 - 第五个参数。
       * @param target - 调用回调的目标。可以为空。
       * @param useCapture - 当设置为 true，监听器将在捕获阶段触发，否则将在冒泡阶段触发。默认为 false。
       * @return - 返回监听回调函数自身。
       *
       * @example
       * ```typescript
       * this.node.on(cc.Node.EventType.TOUCH_START, this.memberFunction, this);  // if "this" is component and the "memberFunction" declared in CCClass.
       * this.node.on(cc.Node.EventType.TOUCH_START, callback, this);
       * this.node.on(cc.Node.EventType.ANCHOR_CHANGED, callback);
       * ```
       */

    }, {
      key: "on",
      value: function on(type, callback, target, useCapture) {
        var forDispatch = this._checknSetupSysEvent(type);

        if (forDispatch) {
          return this._onDispatch(type, callback, target, useCapture);
        } else {
          // switch (type) {
          //     case EventType.POSITION_CHANGED:
          //         this._eventMask |= POSITION_ON;
          //         break;
          //     case EventType.SCALE_CHANGED:
          //         this._eventMask |= SCALE_ON;
          //         break;
          //     case EventType.ROTATION_CHANGED:
          //         this._eventMask |= ROTATION_ON;
          //         break;
          //     case EventType.SIZE_CHANGED:
          //         this._eventMask |= SIZE_ON;
          //         break;
          //     case EventType.ANCHOR_CHANGED:
          //         this._eventMask |= ANCHOR_ON;
          //         break;
          // }
          if (!this.bubblingTargets) {
            this.bubblingTargets = new _callbacksInvoker.CallbacksInvoker();
          }

          return this.bubblingTargets.on(type, callback, target);
        }
      }
      /**
       * @zh
       * 注册节点的特定事件类型回调，回调会在第一时间被触发后删除自身。
       *
       * @param type - 一个监听事件类型的字符串。参见：[[EventType]]。
       * @param callback - 事件分派时将被调用的回调函数。如果该回调存在则不会重复添加。
       * @param callback.event - 事件派发的时候回调的第一个参数。
       * @param callback.arg2 - 第二个参数。
       * @param callback.arg3 - 第三个参数。
       * @param callback.arg4 - 第四个参数。
       * @param callback.arg5 - 第五个参数。
       * @param target - 调用回调的目标。可以为空。
       * @param useCapture - 当设置为 true，监听器将在捕获阶段触发，否则将在冒泡阶段触发。默认为 false。
       *
       * @example
       * ```typescript
       * node.once(cc.Node.EventType.ANCHOR_CHANGED, callback);
       * ```
       */

    }, {
      key: "once",
      value: function once(type, callback, target, useCapture) {
        var _this = this;

        var forDispatch = this._checknSetupSysEvent(type);

        var listeners;

        if (forDispatch && useCapture) {
          listeners = this.capturingTargets = this.capturingTargets || new _callbacksInvoker.CallbacksInvoker();
        } else {
          listeners = this.bubblingTargets = this.bubblingTargets || new _callbacksInvoker.CallbacksInvoker();
        }

        listeners.on(type, callback, target, true);
        listeners.on(type, function () {
          _this.off(type, callback, target);
        }, undefined, true);
      }
      /**
       * @zh
       * 删除之前与同类型，回调，目标或 useCapture 注册的回调。
       *
       * @param type - 一个监听事件类型的字符串。参见：[[EventType]]。
       * @param callback - 移除指定注册回调。如果没有给，则删除全部同事件类型的监听。
       * @param target - 调用回调的目标。配合 callback 一起使用。
       * @param useCapture - 当设置为 true，监听器将在捕获阶段触发，否则将在冒泡阶段触发。默认为 false。
       *
       * @example
       * ```typescript
       * this.node.off(cc.Node.EventType.TOUCH_START, this.memberFunction, this);
       * node.off(cc.Node.EventType.TOUCH_START, callback, this.node);
       * node.off(cc.Node.EventType.ANCHOR_CHANGED, callback, this);
       * ```
       */

    }, {
      key: "off",
      value: function off(type, callback, target, useCapture) {
        var touchEvent = _touchEvents.indexOf(type) !== -1;
        var mouseEvent = !touchEvent && _mouseEvents.indexOf(type) !== -1;

        if (touchEvent || mouseEvent) {
          this._offDispatch(type, callback, target, useCapture);

          if (touchEvent) {
            if (this.touchListener && !_checkListeners(this._node, _touchEvents)) {
              _eventManager.eventManager.removeListener(this.touchListener);

              this.touchListener = null;
            }
          } else if (mouseEvent) {
            if (this.mouseListener && !_checkListeners(this._node, _mouseEvents)) {
              _eventManager.eventManager.removeListener(this.mouseListener);

              this.mouseListener = null;
            }
          }
        } else if (this.bubblingTargets) {
          this.bubblingTargets.off(type, callback, target); // const hasListeners = this.bubblingTargets.hasEventListener(type);
          // All listener removed
          // if (!hasListeners) {
          //     switch (type) {
          //         case EventType.POSITION_CHANGED:
          //             this._eventMask &= ~POSITION_ON;
          //             break;
          //         case EventType.SCALE_CHANGED:
          //             this._eventMask &= ~SCALE_ON;
          //             break;
          //         case EventType.ROTATION_CHANGED:
          //             this._eventMask &= ~ROTATION_ON;
          //             break;
          //         case EventType.SIZE_CHANGED:
          //             this._eventMask &= ~SIZE_ON;
          //             break;
          //         case EventType.ANCHOR_CHANGED:
          //             this._eventMask &= ~ANCHOR_ON;
          //             break;
          //     }
          // }
        }
      }
      /**
       * @zh
       * 通过事件名发送自定义事件
       *
       * @param type - 一个监听事件类型的字符串。
       * @param arg0 - 回调第一个参数。
       * @param arg1 - 回调第二个参数。
       * @param arg2 - 回调第三个参数。
       * @param arg3 - 回调第四个参数。
       * @param arg4 - 回调第五个参数。
       * @example
       * ```typescript
       * eventTarget.emit('fire', event);
       * eventTarget.emit('fire', message, emitter);
       * ```
       */

    }, {
      key: "emit",
      value: function emit(type, arg0, arg1, arg2, arg3, arg4) {
        if (this.bubblingTargets) {
          this.bubblingTargets.emit(type, arg0, arg1, arg2, arg3, arg4);
        }
      }
      /**
       * @zh
       * 分发事件到事件流中。
       *
       * @param event - 分派到事件流中的事件对象。
       */

    }, {
      key: "dispatchEvent",
      value: function dispatchEvent(event) {
        _doDispatchEvent(this._node, event);

        _cachedArray.length = 0;
      }
      /**
       * @zh
       * 是否监听过某事件。
       *
       * @param type - 一个监听事件类型的字符串。
       * @param callback - The callback function of the event listener, if absent all event listeners for the given type will be removed
       * @param target - The callback callee of the event listener
       * @return - 返回是否当前节点已监听该事件类型。
       */

    }, {
      key: "hasEventListener",
      value: function hasEventListener(type, callback, target) {
        var has = false;

        if (this.bubblingTargets) {
          has = this.bubblingTargets.hasEventListener(type, callback, target);
        }

        if (!has && this.capturingTargets) {
          has = this.capturingTargets.hasEventListener(type, callback, target);
        }

        return has;
      }
      /**
       * @zh
       * 移除在特定事件类型中注册的所有回调或在某个目标中注册的所有回调。
       *
       * @param target - 要删除的事件键或要删除的目标。
       */

    }, {
      key: "targetOff",
      value: function targetOff(target) {
        if (this.capturingTargets) {
          this.capturingTargets.removeAll(target);
        }

        if (this.bubblingTargets) {
          this.bubblingTargets.removeAll(target);
        }

        if (this.touchListener && !_checkListeners(this.node, _touchEvents)) {
          _eventManager.eventManager.removeListener(this.touchListener);

          this.touchListener = null;
        }

        if (this.mouseListener && !_checkListeners(this.node, _mouseEvents)) {
          _eventManager.eventManager.removeListener(this.mouseListener);

          this.mouseListener = null;
        }
      }
      /**
       * @zh
       * 获得所提供的事件类型在目标捕获阶段监听的所有目标。
       * 捕获阶段包括从根节点到目标节点的过程。
       * 结果保存在数组参数中，并且必须从子节点排序到父节点。
       *
       * @param type - 一个监听事件类型的字符串。
       * @param array - 接收目标的数组。
       */

    }, {
      key: "getCapturingTargets",
      value: function getCapturingTargets(type, targets) {
        var parent = this._node.parent;

        while (parent) {
          if (parent.eventProcessor.capturingTargets && parent.eventProcessor.capturingTargets.hasEventListener(type)) {
            targets.push(parent);
          }

          parent = parent.parent;
        }
      }
      /**
       * @zh
       * 获得所提供的事件类型在目标冒泡阶段监听的所有目标。
       * 冒泡阶段目标节点到根节点的过程。
       * 结果保存在数组参数中，并且必须从子节点排序到父节点。
       *
       * @param type - 一个监听事件类型的字符串。
       * @param array - 接收目标的数组。
       */

    }, {
      key: "getBubblingTargets",
      value: function getBubblingTargets(type, targets) {
        var parent = this._node.parent;

        while (parent) {
          if (parent.eventProcessor.bubblingTargets && parent.eventProcessor.bubblingTargets.hasEventListener(type)) {
            targets.push(parent);
          }

          parent = parent.parent;
        }
      } // EVENT TARGET

    }, {
      key: "_checknSetupSysEvent",
      value: function _checknSetupSysEvent(type) {
        var _this2 = this;

        var newAdded = false;
        var forDispatch = false; // just for ui

        if (_touchEvents.indexOf(type) !== -1) {
          if (!this.touchListener) {
            this.touchListener = cc.EventListener.create({
              event: cc.EventListener.TOUCH_ONE_BY_ONE,
              swallowTouches: true,
              owner: this._node,
              mask: _searchMaskInParent(this._node),
              onTouchBegan: _touchStartHandler,
              onTouchMoved: _touchMoveHandler,
              onTouchEnded: _touchEndHandler,
              onTouchCancelled: _touchCancelHandler
            });

            _eventManager.eventManager.addListener(this.touchListener, this._node);

            newAdded = true;
          }

          forDispatch = true;
        } else if (_mouseEvents.indexOf(type) !== -1) {
          if (!this.mouseListener) {
            this.mouseListener = cc.EventListener.create({
              event: cc.EventListener.MOUSE,
              _previousIn: false,
              owner: this._node,
              mask: _searchMaskInParent(this._node),
              onMouseDown: _mouseDownHandler,
              onMouseMove: _mouseMoveHandler,
              onMouseUp: _mouseUpHandler,
              onMouseScroll: _mouseWheelHandler
            });

            _eventManager.eventManager.addListener(this.mouseListener, this._node);

            newAdded = true;
          }

          forDispatch = true;
        }

        if (newAdded && !this._node.activeInHierarchy) {
          cc.director.getScheduler().schedule(function () {
            if (!_this2._node.activeInHierarchy) {
              _eventManager.eventManager.pauseTarget(_this2._node);
            }
          }, this._node, 0, 0, 0, false);
        }

        return forDispatch;
      }
    }, {
      key: "_onDispatch",
      value: function _onDispatch(type, callback, target, useCapture) {
        // Accept also patameters like: (type, callback, useCapture)
        if (typeof target === 'boolean') {
          useCapture = target;
          target = undefined;
        } else {
          useCapture = !!useCapture;
        }

        if (!callback) {
          cc.errorID(6800);
          return;
        }

        var listeners = null;

        if (useCapture) {
          listeners = this.capturingTargets = this.capturingTargets || new _callbacksInvoker.CallbacksInvoker();
        } else {
          listeners = this.bubblingTargets = this.bubblingTargets || new _callbacksInvoker.CallbacksInvoker();
        }

        if (!listeners.hasEventListener(type, callback, target)) {
          listeners.on(type, callback, target);
        }

        return callback;
      }
    }, {
      key: "_offDispatch",
      value: function _offDispatch(type, callback, target, useCapture) {
        // Accept also patameters like: (type, callback, useCapture)
        if (typeof target === 'boolean') {
          useCapture = target;
          target = undefined;
        } else {
          useCapture = !!useCapture;
        }

        if (!callback) {
          if (this.capturingTargets) {
            this.capturingTargets.removeAll(type);
          }

          if (this.bubblingTargets) {
            this.bubblingTargets.removeAll(type);
          }
        } else {
          var listeners = useCapture ? this.capturingTargets : this.bubblingTargets;

          if (listeners) {
            listeners.off(type, callback, target);
          }
        }
      }
    }]);

    return NodeEventProcessor;
  }();

  _exports.NodeEventProcessor = NodeEventProcessor;
  cc.NodeEventProcessor = NodeEventProcessor;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvY29yZS9zY2VuZS1ncmFwaC9ub2RlLWV2ZW50LXByb2Nlc3Nvci50cyJdLCJuYW1lcyI6WyJfY2FjaGVkQXJyYXkiLCJBcnJheSIsIl9jdXJyZW50SG92ZXJlZCIsInBvcyIsIlZlYzIiLCJfdG91Y2hFdmVudHMiLCJTeXN0ZW1FdmVudFR5cGUiLCJUT1VDSF9TVEFSVCIsInRvU3RyaW5nIiwiVE9VQ0hfTU9WRSIsIlRPVUNIX0VORCIsIlRPVUNIX0NBTkNFTCIsIl9tb3VzZUV2ZW50cyIsIk1PVVNFX0RPV04iLCJNT1VTRV9FTlRFUiIsIk1PVVNFX01PVkUiLCJNT1VTRV9MRUFWRSIsIk1PVVNFX1VQIiwiTU9VU0VfV0hFRUwiLCJfdG91Y2hTdGFydEhhbmRsZXIiLCJ0b3VjaCIsImV2ZW50Iiwibm9kZSIsIm93bmVyIiwiX3VpUHJvcHMiLCJ1aVRyYW5zZm9ybUNvbXAiLCJnZXRVSUxvY2F0aW9uIiwiaXNIaXQiLCJ0eXBlIiwiYnViYmxlcyIsImRpc3BhdGNoRXZlbnQiLCJfdG91Y2hNb3ZlSGFuZGxlciIsIl90b3VjaEVuZEhhbmRsZXIiLCJfdG91Y2hDYW5jZWxIYW5kbGVyIiwiX21vdXNlRG93bkhhbmRsZXIiLCJfbW91c2VNb3ZlSGFuZGxlciIsImhpdCIsIl9wcmV2aW91c0luIiwiZXZlbnRQcm9jZXNzb3IiLCJtb3VzZUxpc3RlbmVyIiwicHJvcGFnYXRpb25TdG9wcGVkIiwiX21vdXNlVXBIYW5kbGVyIiwiX21vdXNlV2hlZWxIYW5kbGVyIiwiX2RvRGlzcGF0Y2hFdmVudCIsInRhcmdldCIsImkiLCJsZW5ndGgiLCJnZXRDYXB0dXJpbmdUYXJnZXRzIiwiZXZlbnRQaGFzZSIsImNhcHR1cmluZ1RhcmdldHMiLCJjdXJyZW50VGFyZ2V0IiwiZW1pdCIsInByb3BhZ2F0aW9uSW1tZWRpYXRlU3RvcHBlZCIsImJ1YmJsaW5nVGFyZ2V0cyIsImdldEJ1YmJsaW5nVGFyZ2V0cyIsIl9zZWFyY2hNYXNrSW5QYXJlbnQiLCJNYXNrIiwiY2MiLCJNYXNrQ29tcG9uZW50IiwiaW5kZXgiLCJjdXJyIiwiTm9kZSIsImlzTm9kZSIsInBhcmVudCIsImdldENvbXBvbmVudCIsIl9jaGVja0xpc3RlbmVycyIsImV2ZW50cyIsIl9wZXJzaXN0Tm9kZSIsImhhc0V2ZW50TGlzdGVuZXIiLCJOb2RlRXZlbnRQcm9jZXNzb3IiLCJfbm9kZSIsInRvdWNoTGlzdGVuZXIiLCJtYXNrIiwiZXZlbnRNYW5hZ2VyIiwicmVtb3ZlTGlzdGVuZXJzIiwiY2xlYXIiLCJjYWxsYmFjayIsInVzZUNhcHR1cmUiLCJmb3JEaXNwYXRjaCIsIl9jaGVja25TZXR1cFN5c0V2ZW50IiwiX29uRGlzcGF0Y2giLCJDYWxsYmFja3NJbnZva2VyIiwib24iLCJsaXN0ZW5lcnMiLCJvZmYiLCJ1bmRlZmluZWQiLCJ0b3VjaEV2ZW50IiwiaW5kZXhPZiIsIm1vdXNlRXZlbnQiLCJfb2ZmRGlzcGF0Y2giLCJyZW1vdmVMaXN0ZW5lciIsImFyZzAiLCJhcmcxIiwiYXJnMiIsImFyZzMiLCJhcmc0IiwiaGFzIiwicmVtb3ZlQWxsIiwidGFyZ2V0cyIsInB1c2giLCJuZXdBZGRlZCIsIkV2ZW50TGlzdGVuZXIiLCJjcmVhdGUiLCJUT1VDSF9PTkVfQllfT05FIiwic3dhbGxvd1RvdWNoZXMiLCJvblRvdWNoQmVnYW4iLCJvblRvdWNoTW92ZWQiLCJvblRvdWNoRW5kZWQiLCJvblRvdWNoQ2FuY2VsbGVkIiwiYWRkTGlzdGVuZXIiLCJNT1VTRSIsIm9uTW91c2VEb3duIiwib25Nb3VzZU1vdmUiLCJvbk1vdXNlVXAiLCJvbk1vdXNlU2Nyb2xsIiwiYWN0aXZlSW5IaWVyYXJjaHkiLCJkaXJlY3RvciIsImdldFNjaGVkdWxlciIsInNjaGVkdWxlIiwicGF1c2VUYXJnZXQiLCJlcnJvcklEIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXdDQSxNQUFN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R0FBMkIsS0FBS0ksZUFBNUQ7O0FBQ0EsY0FBSThCLFNBQUosRUFBZTtBQUNYQSxZQUFBQSxTQUFTLENBQUNDLEdBQVYsQ0FBY3hELElBQWQsRUFBb0JnRCxRQUFwQixFQUE4QmhDLE1BQTlCO0FBQ0g7QUFDSjtBQUNKOzs7Ozs7O0FBR0xhLEVBQUFBLEVBQUUsQ0FBQ1ksa0JBQUgsR0FBd0JBLGtCQUF4QiIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiBDb3B5cmlnaHQgKGMpIDIwMTctMjAxOCBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC5cclxuXHJcbiBodHRwOi8vd3d3LmNvY29zLmNvbVxyXG5cclxuIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcclxuIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZW5naW5lIHNvdXJjZSBjb2RlICh0aGUgXCJTb2Z0d2FyZVwiKSwgYSBsaW1pdGVkLFxyXG4gIHdvcmxkd2lkZSwgcm95YWx0eS1mcmVlLCBub24tYXNzaWduYWJsZSwgcmV2b2NhYmxlIGFuZCBub24tZXhjbHVzaXZlIGxpY2Vuc2VcclxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXHJcbiAgbm90IHVzZSBDb2NvcyBDcmVhdG9yIHNvZnR3YXJlIGZvciBkZXZlbG9waW5nIG90aGVyIHNvZnR3YXJlIG9yIHRvb2xzIHRoYXQnc1xyXG4gIHVzZWQgZm9yIGRldmVsb3BpbmcgZ2FtZXMuIFlvdSBhcmUgbm90IGdyYW50ZWQgdG8gcHVibGlzaCwgZGlzdHJpYnV0ZSxcclxuICBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cclxuXHJcbiBUaGUgc29mdHdhcmUgb3IgdG9vbHMgaW4gdGhpcyBMaWNlbnNlIEFncmVlbWVudCBhcmUgbGljZW5zZWQsIG5vdCBzb2xkLlxyXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuXHJcbi8qKlxyXG4gKiBAaGlkZGVuXHJcbiAqL1xyXG5cclxuaW1wb3J0IEV2ZW50IGZyb20gJy4uL2V2ZW50L2V2ZW50JztcclxuaW1wb3J0IHsgVmVjMiB9IGZyb20gJy4uL21hdGgvdmVjMic7XHJcbmltcG9ydCB7IFN5c3RlbUV2ZW50VHlwZSB9IGZyb20gJy4uL3BsYXRmb3JtL2V2ZW50LW1hbmFnZXIvZXZlbnQtZW51bSc7XHJcbmltcG9ydCB7IEV2ZW50TGlzdGVuZXIgfSBmcm9tICcuLi9wbGF0Zm9ybS9ldmVudC1tYW5hZ2VyL2V2ZW50LWxpc3RlbmVyJztcclxuaW1wb3J0IHsgZXZlbnRNYW5hZ2VyIH0gZnJvbSAnLi4vcGxhdGZvcm0vZXZlbnQtbWFuYWdlci9ldmVudC1tYW5hZ2VyJztcclxuaW1wb3J0IHsgRXZlbnRNb3VzZSwgRXZlbnRUb3VjaCB9IGZyb20gJy4uL3BsYXRmb3JtL2V2ZW50LW1hbmFnZXIvZXZlbnRzJztcclxuaW1wb3J0IHsgVG91Y2ggfSBmcm9tICcuLi9wbGF0Zm9ybS9ldmVudC1tYW5hZ2VyL3RvdWNoJztcclxuaW1wb3J0IHsgQmFzZU5vZGUgfSBmcm9tICcuL2Jhc2Utbm9kZSc7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuL25vZGUnO1xyXG5pbXBvcnQgeyBDYWxsYmFja3NJbnZva2VyIH0gZnJvbSAnLi4vZXZlbnQvY2FsbGJhY2tzLWludm9rZXInO1xyXG5cclxuY29uc3QgX2NhY2hlZEFycmF5ID0gbmV3IEFycmF5PEJhc2VOb2RlPigxNik7XHJcbmxldCBfY3VycmVudEhvdmVyZWQ6IEJhc2VOb2RlIHwgbnVsbCA9IG51bGw7XHJcbmxldCBwb3MgPSBuZXcgVmVjMigpO1xyXG5cclxuY29uc3QgX3RvdWNoRXZlbnRzID0gW1xyXG4gICAgU3lzdGVtRXZlbnRUeXBlLlRPVUNIX1NUQVJULnRvU3RyaW5nKCksXHJcbiAgICBTeXN0ZW1FdmVudFR5cGUuVE9VQ0hfTU9WRS50b1N0cmluZygpLFxyXG4gICAgU3lzdGVtRXZlbnRUeXBlLlRPVUNIX0VORC50b1N0cmluZygpLFxyXG4gICAgU3lzdGVtRXZlbnRUeXBlLlRPVUNIX0NBTkNFTC50b1N0cmluZygpLFxyXG5dO1xyXG5cclxuY29uc3QgX21vdXNlRXZlbnRzID0gW1xyXG4gICAgU3lzdGVtRXZlbnRUeXBlLk1PVVNFX0RPV04udG9TdHJpbmcoKSxcclxuICAgIFN5c3RlbUV2ZW50VHlwZS5NT1VTRV9FTlRFUi50b1N0cmluZygpLFxyXG4gICAgU3lzdGVtRXZlbnRUeXBlLk1PVVNFX01PVkUudG9TdHJpbmcoKSxcclxuICAgIFN5c3RlbUV2ZW50VHlwZS5NT1VTRV9MRUFWRS50b1N0cmluZygpLFxyXG4gICAgU3lzdGVtRXZlbnRUeXBlLk1PVVNFX1VQLnRvU3RyaW5nKCksXHJcbiAgICBTeXN0ZW1FdmVudFR5cGUuTU9VU0VfV0hFRUwudG9TdHJpbmcoKSxcclxuXTtcclxuXHJcbi8vIFRPRE86IHJlYXJyYW5nZSBldmVudFxyXG5mdW5jdGlvbiBfdG91Y2hTdGFydEhhbmRsZXIgKHRoaXM6IEV2ZW50TGlzdGVuZXIsIHRvdWNoOiBUb3VjaCwgZXZlbnQ6IEV2ZW50VG91Y2gpIHtcclxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm93bmVyIGFzIE5vZGUgfCBudWxsO1xyXG4gICAgaWYgKCFub2RlIHx8ICFub2RlLl91aVByb3BzLnVpVHJhbnNmb3JtQ29tcCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB0b3VjaC5nZXRVSUxvY2F0aW9uKHBvcyk7XHJcblxyXG4gICAgaWYgKG5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wLmlzSGl0KHBvcywgdGhpcykpIHtcclxuICAgICAgICBldmVudC50eXBlID0gU3lzdGVtRXZlbnRUeXBlLlRPVUNIX1NUQVJULnRvU3RyaW5nKCk7XHJcbiAgICAgICAgZXZlbnQudG91Y2ggPSB0b3VjaDtcclxuICAgICAgICBldmVudC5idWJibGVzID0gdHJ1ZTtcclxuICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gX3RvdWNoTW92ZUhhbmRsZXIgKHRoaXM6IEV2ZW50TGlzdGVuZXIsIHRvdWNoOiBUb3VjaCwgZXZlbnQ6IEV2ZW50VG91Y2gpIHtcclxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm93bmVyIGFzIE5vZGU7XHJcbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGV2ZW50LnR5cGUgPSBTeXN0ZW1FdmVudFR5cGUuVE9VQ0hfTU9WRS50b1N0cmluZygpO1xyXG4gICAgZXZlbnQudG91Y2ggPSB0b3VjaDtcclxuICAgIGV2ZW50LmJ1YmJsZXMgPSB0cnVlO1xyXG4gICAgbm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxufVxyXG5cclxuZnVuY3Rpb24gX3RvdWNoRW5kSGFuZGxlciAodGhpczogRXZlbnRMaXN0ZW5lciwgdG91Y2g6IFRvdWNoLCBldmVudDogRXZlbnRUb3VjaCkge1xyXG4gICAgY29uc3Qgbm9kZSA9IHRoaXMub3duZXIgYXMgTm9kZTtcclxuICAgIGlmICghbm9kZSB8fCAhbm9kZS5fdWlQcm9wcy51aVRyYW5zZm9ybUNvbXApIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdG91Y2guZ2V0VUlMb2NhdGlvbihwb3MpO1xyXG5cclxuICAgIGlmIChub2RlLl91aVByb3BzLnVpVHJhbnNmb3JtQ29tcC5pc0hpdChwb3MsIHRoaXMpKSB7XHJcbiAgICAgICAgZXZlbnQudHlwZSA9IFN5c3RlbUV2ZW50VHlwZS5UT1VDSF9FTkQudG9TdHJpbmcoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXZlbnQudHlwZSA9IFN5c3RlbUV2ZW50VHlwZS5UT1VDSF9DQU5DRUwudG9TdHJpbmcoKTtcclxuICAgIH1cclxuICAgIGV2ZW50LnRvdWNoID0gdG91Y2g7XHJcbiAgICBldmVudC5idWJibGVzID0gdHJ1ZTtcclxuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF90b3VjaENhbmNlbEhhbmRsZXIgKHRoaXM6IEV2ZW50TGlzdGVuZXIsIHRvdWNoOiBUb3VjaCwgZXZlbnQ6IEV2ZW50VG91Y2gpIHtcclxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm93bmVyIGFzIE5vZGU7XHJcbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGV2ZW50LnR5cGUgPSBTeXN0ZW1FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLnRvU3RyaW5nKCk7XHJcbiAgICBldmVudC50b3VjaCA9IHRvdWNoO1xyXG4gICAgZXZlbnQuYnViYmxlcyA9IHRydWU7XHJcbiAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfbW91c2VEb3duSGFuZGxlciAodGhpczogRXZlbnRMaXN0ZW5lciwgZXZlbnQ6IEV2ZW50TW91c2UpIHtcclxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm93bmVyIGFzIE5vZGU7XHJcbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHBvcyA9IGV2ZW50LmdldFVJTG9jYXRpb24oKTtcclxuXHJcbiAgICBpZiAobm9kZS5fdWlQcm9wcy51aVRyYW5zZm9ybUNvbXAuaXNIaXQocG9zLCB0aGlzKSkge1xyXG4gICAgICAgIGV2ZW50LnR5cGUgPSBTeXN0ZW1FdmVudFR5cGUuTU9VU0VfRE9XTi50b1N0cmluZygpO1xyXG4gICAgICAgIGV2ZW50LmJ1YmJsZXMgPSB0cnVlO1xyXG4gICAgICAgIG5vZGUuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9tb3VzZU1vdmVIYW5kbGVyICh0aGlzOiBFdmVudExpc3RlbmVyLCBldmVudDogRXZlbnRNb3VzZSkge1xyXG4gICAgY29uc3Qgbm9kZSA9IHRoaXMub3duZXIgYXMgTm9kZTtcclxuICAgIGlmICghbm9kZSB8fCAhbm9kZS5fdWlQcm9wcy51aVRyYW5zZm9ybUNvbXApIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgcG9zID0gZXZlbnQuZ2V0VUlMb2NhdGlvbigpO1xyXG5cclxuICAgIGNvbnN0IGhpdCA9IG5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wLmlzSGl0KHBvcywgdGhpcyk7XHJcbiAgICBpZiAoaGl0KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9wcmV2aW91c0luKSB7XHJcbiAgICAgICAgICAgIC8vIEZpeCBpc3N1ZSB3aGVuIGhvdmVyIG5vZGUgc3dpdGNoZWQsIHByZXZpb3VzIGhvdmVyZWQgbm9kZSB3b24ndCBnZXQgTU9VU0VfTEVBVkUgbm90aWZpY2F0aW9uXHJcbiAgICAgICAgICAgIGlmIChfY3VycmVudEhvdmVyZWQgJiYgX2N1cnJlbnRIb3ZlcmVkIS5ldmVudFByb2Nlc3Nvci5tb3VzZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC50eXBlID0gU3lzdGVtRXZlbnRUeXBlLk1PVVNFX0xFQVZFO1xyXG4gICAgICAgICAgICAgICAgX2N1cnJlbnRIb3ZlcmVkIS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIGlmIChfY3VycmVudEhvdmVyZWQhLmV2ZW50UHJvY2Vzc29yLm1vdXNlTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBfY3VycmVudEhvdmVyZWQhLmV2ZW50UHJvY2Vzc29yLm1vdXNlTGlzdGVuZXIhLl9wcmV2aW91c0luID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX2N1cnJlbnRIb3ZlcmVkID0gbm9kZTtcclxuICAgICAgICAgICAgZXZlbnQudHlwZSA9IFN5c3RlbUV2ZW50VHlwZS5NT1VTRV9FTlRFUi50b1N0cmluZygpO1xyXG4gICAgICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLl9wcmV2aW91c0luID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnQudHlwZSA9IFN5c3RlbUV2ZW50VHlwZS5NT1VTRV9NT1ZFLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgZXZlbnQuYnViYmxlcyA9IHRydWU7XHJcbiAgICAgICAgbm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5fcHJldmlvdXNJbikge1xyXG4gICAgICAgIGV2ZW50LnR5cGUgPSBTeXN0ZW1FdmVudFR5cGUuTU9VU0VfTEVBVkUudG9TdHJpbmcoKTtcclxuICAgICAgICBub2RlLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuX3ByZXZpb3VzSW4gPSBmYWxzZTtcclxuICAgICAgICBfY3VycmVudEhvdmVyZWQgPSBudWxsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBjb250aW51ZSBkaXNwYXRjaGluZ1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFdmVudCBwcm9jZXNzZWQsIGNsZWFudXBcclxuICAgIC8vIGV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XHJcbiAgICBldmVudC5wcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfbW91c2VVcEhhbmRsZXIgKHRoaXM6IEV2ZW50TGlzdGVuZXIsIGV2ZW50OiBFdmVudE1vdXNlKSB7XHJcbiAgICBjb25zdCBub2RlID0gdGhpcy5vd25lciBhcyBOb2RlO1xyXG4gICAgaWYgKCFub2RlIHx8ICFub2RlLl91aVByb3BzLnVpVHJhbnNmb3JtQ29tcCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBwb3MgPSBldmVudC5nZXRVSUxvY2F0aW9uKCk7XHJcblxyXG4gICAgaWYgKG5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wLmlzSGl0KHBvcywgdGhpcykpIHtcclxuICAgICAgICBldmVudC50eXBlID0gU3lzdGVtRXZlbnRUeXBlLk1PVVNFX1VQLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgZXZlbnQuYnViYmxlcyA9IHRydWU7XHJcbiAgICAgICAgbm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAvLyBldmVudC5wcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xyXG4gICAgICAgIGV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9tb3VzZVdoZWVsSGFuZGxlciAodGhpczogRXZlbnRMaXN0ZW5lciwgZXZlbnQ6IEV2ZW50TW91c2UpIHtcclxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm93bmVyIGFzIE5vZGU7XHJcbiAgICBpZiAoIW5vZGUgfHwgIW5vZGUuX3VpUHJvcHMudWlUcmFuc2Zvcm1Db21wKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHBvcyA9IGV2ZW50LmdldFVJTG9jYXRpb24oKTtcclxuXHJcbiAgICBpZiAobm9kZS5fdWlQcm9wcy51aVRyYW5zZm9ybUNvbXAhLmlzSGl0KHBvcywgdGhpcykpIHtcclxuICAgICAgICBldmVudC50eXBlID0gU3lzdGVtRXZlbnRUeXBlLk1PVVNFX1dIRUVMLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgZXZlbnQuYnViYmxlcyA9IHRydWU7XHJcbiAgICAgICAgbm9kZS5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAvLyBldmVudC5wcm9wYWdhdGlvblN0b3BwZWQgPSB0cnVlO1xyXG4gICAgICAgIGV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCA9IHRydWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9kb0Rpc3BhdGNoRXZlbnQgKG93bmVyOiBCYXNlTm9kZSwgZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICBsZXQgdGFyZ2V0OiBCYXNlTm9kZTtcclxuICAgIGxldCBpID0gMDtcclxuICAgIGV2ZW50LnRhcmdldCA9IG93bmVyO1xyXG5cclxuICAgIC8vIEV2ZW50LkNBUFRVUklOR19QSEFTRVxyXG4gICAgX2NhY2hlZEFycmF5Lmxlbmd0aCA9IDA7XHJcbiAgICBvd25lci5ldmVudFByb2Nlc3Nvci5nZXRDYXB0dXJpbmdUYXJnZXRzKGV2ZW50LnR5cGUsIF9jYWNoZWRBcnJheSk7XHJcbiAgICAvLyBjYXB0dXJpbmdcclxuICAgIGV2ZW50LmV2ZW50UGhhc2UgPSAxO1xyXG4gICAgZm9yIChpID0gX2NhY2hlZEFycmF5Lmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XHJcbiAgICAgICAgdGFyZ2V0ID0gX2NhY2hlZEFycmF5W2ldO1xyXG4gICAgICAgIGlmICh0YXJnZXQuZXZlbnRQcm9jZXNzb3IuY2FwdHVyaW5nVGFyZ2V0cykge1xyXG4gICAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAvLyBmaXJlIGV2ZW50XHJcbiAgICAgICAgICAgIHRhcmdldC5ldmVudFByb2Nlc3Nvci5jYXB0dXJpbmdUYXJnZXRzLmVtaXQoZXZlbnQudHlwZSwgZXZlbnQsIF9jYWNoZWRBcnJheSk7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHByb3BhZ2F0aW9uIHN0b3BwZWRcclxuICAgICAgICAgICAgaWYgKGV2ZW50LnByb3BhZ2F0aW9uU3RvcHBlZCkge1xyXG4gICAgICAgICAgICAgICAgX2NhY2hlZEFycmF5Lmxlbmd0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfY2FjaGVkQXJyYXkubGVuZ3RoID0gMDtcclxuXHJcbiAgICAvLyBFdmVudC5BVF9UQVJHRVRcclxuICAgIC8vIGNoZWNrcyBpZiBkZXN0cm95ZWQgaW4gY2FwdHVyaW5nIGNhbGxiYWNrc1xyXG4gICAgZXZlbnQuZXZlbnRQaGFzZSA9IDI7XHJcbiAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gb3duZXI7XHJcbiAgICBpZiAob3duZXIuZXZlbnRQcm9jZXNzb3IuY2FwdHVyaW5nVGFyZ2V0cykge1xyXG4gICAgICAgIG93bmVyLmV2ZW50UHJvY2Vzc29yLmNhcHR1cmluZ1RhcmdldHMuZW1pdChldmVudC50eXBlLCBldmVudCk7XHJcbiAgICB9XHJcbiAgICBpZiAoIWV2ZW50LnByb3BhZ2F0aW9uSW1tZWRpYXRlU3RvcHBlZCAmJiBvd25lci5ldmVudFByb2Nlc3Nvci5idWJibGluZ1RhcmdldHMpIHtcclxuICAgICAgICBvd25lci5ldmVudFByb2Nlc3Nvci5idWJibGluZ1RhcmdldHMuZW1pdChldmVudC50eXBlLCBldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFldmVudC5wcm9wYWdhdGlvblN0b3BwZWQgJiYgZXZlbnQuYnViYmxlcykge1xyXG4gICAgICAgIC8vIEV2ZW50LkJVQkJMSU5HX1BIQVNFXHJcbiAgICAgICAgb3duZXIuZXZlbnRQcm9jZXNzb3IuZ2V0QnViYmxpbmdUYXJnZXRzKGV2ZW50LnR5cGUsIF9jYWNoZWRBcnJheSk7XHJcbiAgICAgICAgLy8gcHJvcGFnYXRlXHJcbiAgICAgICAgZXZlbnQuZXZlbnRQaGFzZSA9IDM7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IF9jYWNoZWRBcnJheS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0YXJnZXQgPSBfY2FjaGVkQXJyYXlbaV07XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQuZXZlbnRQcm9jZXNzb3IuYnViYmxpbmdUYXJnZXRzKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5jdXJyZW50VGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgLy8gZmlyZSBldmVudFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LmV2ZW50UHJvY2Vzc29yLmJ1YmJsaW5nVGFyZ2V0cy5lbWl0KGV2ZW50LnR5cGUsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHByb3BhZ2F0aW9uIHN0b3BwZWRcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC5wcm9wYWdhdGlvblN0b3BwZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBfY2FjaGVkQXJyYXkubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfY2FjaGVkQXJyYXkubGVuZ3RoID0gMDtcclxufVxyXG5cclxuZnVuY3Rpb24gX3NlYXJjaE1hc2tJblBhcmVudCAobm9kZTogTm9kZSB8IG51bGwpIHtcclxuICAgIGNvbnN0IE1hc2sgPSBjYy5NYXNrQ29tcG9uZW50O1xyXG4gICAgaWYgKE1hc2spIHtcclxuICAgICAgICBsZXQgaW5kZXggPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGN1cnIgPSBub2RlOyBjdXJyICYmIGNjLk5vZGUuaXNOb2RlKGN1cnIpOyBjdXJyID0gY3Vyci5wYXJlbnQsICsraW5kZXgpIHtcclxuICAgICAgICAgICAgaWYgKGN1cnIuZ2V0Q29tcG9uZW50KE1hc2spKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IGN1cnIsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9jaGVja0xpc3RlbmVycyAobm9kZTogQmFzZU5vZGUsIGV2ZW50czogc3RyaW5nW10pIHtcclxuICAgIGlmICghbm9kZS5fcGVyc2lzdE5vZGUpIHtcclxuICAgICAgICBpZiAobm9kZS5ldmVudFByb2Nlc3Nvci5idWJibGluZ1RhcmdldHMpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlLmV2ZW50UHJvY2Vzc29yLmJ1YmJsaW5nVGFyZ2V0cy5oYXNFdmVudExpc3RlbmVyKGV2ZW50c1tpXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobm9kZS5ldmVudFByb2Nlc3Nvci5jYXB0dXJpbmdUYXJnZXRzKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5ldmVudFByb2Nlc3Nvci5jYXB0dXJpbmdUYXJnZXRzLmhhc0V2ZW50TGlzdGVuZXIoZXZlbnRzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogQHpoXHJcbiAqIOiKgueCueS6i+S7tuexu+OAglxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE5vZGVFdmVudFByb2Nlc3NvciB7XHJcbiAgICBwdWJsaWMgZ2V0IG5vZGUgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ub2RlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDoioLngrnlhpLms6Hkuovku7bnm5HlkKzlmahcclxuICAgICAqL1xyXG4gICAgcHVibGljIGJ1YmJsaW5nVGFyZ2V0czogQ2FsbGJhY2tzSW52b2tlciB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDoioLngrnmjZXojrfkuovku7bnm5HlkKzlmahcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNhcHR1cmluZ1RhcmdldHM6IENhbGxiYWNrc0ludm9rZXIgfCBudWxsID0gbnVsbDtcclxuICAgIC8qKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDop6bmkbjnm5HlkKzlmahcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRvdWNoTGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIgfCBudWxsID0gbnVsbDtcclxuICAgIC8qKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDpvKDmoIfnm5HlkKzlmahcclxuICAgICAqL1xyXG4gICAgcHVibGljIG1vdXNlTGlzdGVuZXI6IEV2ZW50TGlzdGVuZXIgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIF9ub2RlOiBCYXNlTm9kZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAobm9kZTogQmFzZU5vZGUpIHtcclxuICAgICAgICB0aGlzLl9ub2RlID0gbm9kZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVhdHRhY2ggKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnRvdWNoTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgbWFzayA9IHRoaXMudG91Y2hMaXN0ZW5lci5tYXNrID0gX3NlYXJjaE1hc2tJblBhcmVudCh0aGlzLl9ub2RlIGFzIE5vZGUpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tb3VzZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlTGlzdGVuZXIubWFzayA9IG1hc2s7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5tb3VzZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VMaXN0ZW5lci5tYXNrID0gX3NlYXJjaE1hc2tJblBhcmVudCh0aGlzLl9ub2RlIGFzIE5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVzdHJveSAoKTogdm9pZHtcclxuICAgICAgICBpZiAoX2N1cnJlbnRIb3ZlcmVkID09PSB0aGlzLl9ub2RlKSB7XHJcbiAgICAgICAgICAgIF9jdXJyZW50SG92ZXJlZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBSZW1vdmUgYWxsIGV2ZW50IGxpc3RlbmVycyBpZiBuZWNlc3NhcnlcclxuICAgICAgICBpZiAodGhpcy50b3VjaExpc3RlbmVyIHx8IHRoaXMubW91c2VMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICBldmVudE1hbmFnZXIucmVtb3ZlTGlzdGVuZXJzKHRoaXMuX25vZGUpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy50b3VjaExpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvdWNoTGlzdGVuZXIub3duZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3VjaExpc3RlbmVyLm1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3VjaExpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5tb3VzZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdXNlTGlzdGVuZXIub3duZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZUxpc3RlbmVyLm1hc2sgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZUxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jYXB0dXJpbmdUYXJnZXRzICYmIHRoaXMuY2FwdHVyaW5nVGFyZ2V0cy5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMuYnViYmxpbmdUYXJnZXRzICYmIHRoaXMuYnViYmxpbmdUYXJnZXRzLmNsZWFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWcqOiKgueCueS4iuazqOWGjOaMh+Wumuexu+Wei+eahOWbnuiwg+WHveaVsO+8jOS5n+WPr+S7peiuvue9riB0YXJnZXQg55So5LqO57uR5a6a5ZON5bqU5Ye95pWw55qEIHRoaXMg5a+56LGh44CCPGJyLz5cclxuICAgICAqIOm8oOagh+aIluinpuaRuOS6i+S7tuS8muiiq+ezu+e7n+iwg+eUqCBkaXNwYXRjaEV2ZW50IOaWueazleinpuWPke+8jOinpuWPkeeahOi/h+eoi+WMheWQq+S4ieS4qumYtuaute+8mjxici8+XHJcbiAgICAgKiAxLiDmjZXojrfpmLbmrrXvvJrmtL7lj5Hkuovku7bnu5nmjZXojrfnm67moIfvvIjpgJrov4cgYGdldENhcHR1cmluZ1RhcmdldHNgIOiOt+WPlu+8ie+8jOavlOWmgu+8jOiKgueCueagkeS4reazqOWGjOS6huaNleiOt+mYtuauteeahOeItuiKgueCue+8jOS7juagueiKgueCueW8gOWni+a0vuWPkeebtOWIsOebruagh+iKgueCueOAgjxici8+XHJcbiAgICAgKiAyLiDnm67moIfpmLbmrrXvvJrmtL7lj5Hnu5nnm67moIfoioLngrnnmoTnm5HlkKzlmajjgII8YnIvPlxyXG4gICAgICogMy4g5YaS5rOh6Zi25q6177ya5rS+5Y+R5LqL5Lu257uZ5YaS5rOh55uu5qCH77yI6YCa6L+HIGBnZXRCdWJibGluZ1RhcmdldHNgIOiOt+WPlu+8ie+8jOavlOWmgu+8jOiKgueCueagkeS4reazqOWGjOS6huWGkuazoemYtuauteeahOeItuiKgueCue+8jOS7juebruagh+iKgueCueW8gOWni+a0vuWPkeebtOWIsOagueiKgueCueOAgjxici8+XHJcbiAgICAgKiDlkIzml7bmgqjlj6/ku6XlsIbkuovku7bmtL7lj5HliLDniLboioLngrnmiJbogIXpgJrov4fosIPnlKggc3RvcFByb3BhZ2F0aW9uIOaLpuaIquWug+OAgjxici8+XHJcbiAgICAgKiDmjqjojZDkvb/nlKjov5nnp43mlrnlvI/mnaXnm5HlkKzoioLngrnkuIrnmoTop6bmkbjmiJbpvKDmoIfkuovku7bvvIzor7fkuI3opoHlnKjoioLngrnkuIrnm7TmjqXkvb/nlKggY2MuZXZlbnRNYW5hZ2Vy44CCPGJyLz5cclxuICAgICAqIOS9oOS5n+WPr+S7peazqOWGjOiHquWumuS5ieS6i+S7tuWIsOiKgueCueS4iu+8jOW5tumAmui/hyBlbWl0IOaWueazleinpuWPkeatpOexu+S6i+S7tu+8jOWvueS6jui/meexu+S6i+S7tu+8jOS4jeS8muWPkeeUn+aNleiOt+WGkuazoemYtuaute+8jOWPquS8muebtOaOpea0vuWPkee7meazqOWGjOWcqOivpeiKgueCueS4iueahOebkeWQrOWZqOOAgjxici8+XHJcbiAgICAgKiDkvaDlj6/ku6XpgJrov4flnKggZW1pdCDmlrnms5XosIPnlKjml7blnKggdHlwZSDkuYvlkI7kvKDpgJLpop3lpJbnmoTlj4LmlbDkvZzkuLrkuovku7blm57osIPnmoTlj4LmlbDliJfooajjgII8YnIvPlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CC5Y+C6KeB77yaW1tFdmVudFR5cGVdXVxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0g5LqL5Lu25YiG5rS+5pe25bCG6KKr6LCD55So55qE5Zue6LCD5Ye95pWw44CC5aaC5p6c6K+l5Zue6LCD5a2Y5Zyo5YiZ5LiN5Lya6YeN5aSN5re75Yqg44CCXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2suZXZlbnQgLSDkuovku7bmtL7lj5HnmoTml7blgJnlm57osIPnmoTnrKzkuIDkuKrlj4LmlbDjgIJcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjay5hcmcyIC0g56ys5LqM5Liq5Y+C5pWw44CCXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2suYXJnMyAtIOesrOS4ieS4quWPguaVsOOAglxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrLmFyZzQgLSDnrKzlm5vkuKrlj4LmlbDjgIJcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjay5hcmc1IC0g56ys5LqU5Liq5Y+C5pWw44CCXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IC0g6LCD55So5Zue6LCD55qE55uu5qCH44CC5Y+v5Lul5Li656m644CCXHJcbiAgICAgKiBAcGFyYW0gdXNlQ2FwdHVyZSAtIOW9k+iuvue9ruS4uiB0cnVl77yM55uR5ZCs5Zmo5bCG5Zyo5o2V6I636Zi25q616Kem5Y+R77yM5ZCm5YiZ5bCG5Zyo5YaS5rOh6Zi25q616Kem5Y+R44CC6buY6K6k5Li6IGZhbHNl44CCXHJcbiAgICAgKiBAcmV0dXJuIC0g6L+U5Zue55uR5ZCs5Zue6LCD5Ye95pWw6Ieq6Lqr44CCXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5tZW1iZXJGdW5jdGlvbiwgdGhpcyk7ICAvLyBpZiBcInRoaXNcIiBpcyBjb21wb25lbnQgYW5kIHRoZSBcIm1lbWJlckZ1bmN0aW9uXCIgZGVjbGFyZWQgaW4gQ0NDbGFzcy5cclxuICAgICAqIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgY2FsbGJhY2ssIHRoaXMpO1xyXG4gICAgICogdGhpcy5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLkFOQ0hPUl9DSEFOR0VELCBjYWxsYmFjayk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9uICh0eXBlOiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbiwgdGFyZ2V0PzogT2JqZWN0LCB1c2VDYXB0dXJlPzogT2JqZWN0KSB7XHJcbiAgICAgICAgY29uc3QgZm9yRGlzcGF0Y2ggPSB0aGlzLl9jaGVja25TZXR1cFN5c0V2ZW50KHR5cGUpO1xyXG4gICAgICAgIGlmIChmb3JEaXNwYXRjaCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25EaXNwYXRjaCh0eXBlLCBjYWxsYmFjaywgdGFyZ2V0LCB1c2VDYXB0dXJlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgLy8gICAgIGNhc2UgRXZlbnRUeXBlLlBPU0lUSU9OX0NIQU5HRUQ6XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgdGhpcy5fZXZlbnRNYXNrIHw9IFBPU0lUSU9OX09OO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAvLyAgICAgY2FzZSBFdmVudFR5cGUuU0NBTEVfQ0hBTkdFRDpcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLl9ldmVudE1hc2sgfD0gU0NBTEVfT047XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vICAgICBjYXNlIEV2ZW50VHlwZS5ST1RBVElPTl9DSEFOR0VEOlxyXG4gICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuX2V2ZW50TWFzayB8PSBST1RBVElPTl9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgLy8gICAgIGNhc2UgRXZlbnRUeXBlLlNJWkVfQ0hBTkdFRDpcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLl9ldmVudE1hc2sgfD0gU0laRV9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgLy8gICAgIGNhc2UgRXZlbnRUeXBlLkFOQ0hPUl9DSEFOR0VEOlxyXG4gICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuX2V2ZW50TWFzayB8PSBBTkNIT1JfT047XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmJ1YmJsaW5nVGFyZ2V0cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWJibGluZ1RhcmdldHMgPSBuZXcgQ2FsbGJhY2tzSW52b2tlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1YmJsaW5nVGFyZ2V0cy5vbih0eXBlLCBjYWxsYmFjaywgdGFyZ2V0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOazqOWGjOiKgueCueeahOeJueWumuS6i+S7tuexu+Wei+Wbnuiwg++8jOWbnuiwg+S8muWcqOesrOS4gOaXtumXtOiiq+inpuWPkeWQjuWIoOmZpOiHqui6q+OAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CC5Y+C6KeB77yaW1tFdmVudFR5cGVdXeOAglxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0g5LqL5Lu25YiG5rS+5pe25bCG6KKr6LCD55So55qE5Zue6LCD5Ye95pWw44CC5aaC5p6c6K+l5Zue6LCD5a2Y5Zyo5YiZ5LiN5Lya6YeN5aSN5re75Yqg44CCXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2suZXZlbnQgLSDkuovku7bmtL7lj5HnmoTml7blgJnlm57osIPnmoTnrKzkuIDkuKrlj4LmlbDjgIJcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjay5hcmcyIC0g56ys5LqM5Liq5Y+C5pWw44CCXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2suYXJnMyAtIOesrOS4ieS4quWPguaVsOOAglxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrLmFyZzQgLSDnrKzlm5vkuKrlj4LmlbDjgIJcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjay5hcmc1IC0g56ys5LqU5Liq5Y+C5pWw44CCXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IC0g6LCD55So5Zue6LCD55qE55uu5qCH44CC5Y+v5Lul5Li656m644CCXHJcbiAgICAgKiBAcGFyYW0gdXNlQ2FwdHVyZSAtIOW9k+iuvue9ruS4uiB0cnVl77yM55uR5ZCs5Zmo5bCG5Zyo5o2V6I636Zi25q616Kem5Y+R77yM5ZCm5YiZ5bCG5Zyo5YaS5rOh6Zi25q616Kem5Y+R44CC6buY6K6k5Li6IGZhbHNl44CCXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIG5vZGUub25jZShjYy5Ob2RlLkV2ZW50VHlwZS5BTkNIT1JfQ0hBTkdFRCwgY2FsbGJhY2spO1xyXG4gICAgICogYGBgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBvbmNlICh0eXBlOiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbiwgdGFyZ2V0PzogT2JqZWN0LCB1c2VDYXB0dXJlPzogT2JqZWN0KSB7XHJcbiAgICAgICAgY29uc3QgZm9yRGlzcGF0Y2ggPSB0aGlzLl9jaGVja25TZXR1cFN5c0V2ZW50KHR5cGUpO1xyXG5cclxuICAgICAgICBsZXQgbGlzdGVuZXJzOiBDYWxsYmFja3NJbnZva2VyO1xyXG4gICAgICAgIGlmIChmb3JEaXNwYXRjaCAmJiB1c2VDYXB0dXJlKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVycyA9IHRoaXMuY2FwdHVyaW5nVGFyZ2V0cyA9IHRoaXMuY2FwdHVyaW5nVGFyZ2V0cyB8fCBuZXcgQ2FsbGJhY2tzSW52b2tlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJzID0gdGhpcy5idWJibGluZ1RhcmdldHMgPSB0aGlzLmJ1YmJsaW5nVGFyZ2V0cyB8fCBuZXcgQ2FsbGJhY2tzSW52b2tlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGlzdGVuZXJzLm9uKHR5cGUsIGNhbGxiYWNrLCB0YXJnZXQsIHRydWUpO1xyXG4gICAgICAgIGxpc3RlbmVycy5vbih0eXBlLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMub2ZmKHR5cGUsIGNhbGxiYWNrLCB0YXJnZXQpO1xyXG4gICAgICAgIH0sIHVuZGVmaW5lZCwgdHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWIoOmZpOS5i+WJjeS4juWQjOexu+Wei++8jOWbnuiwg++8jOebruagh+aIliB1c2VDYXB0dXJlIOazqOWGjOeahOWbnuiwg+OAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CC5Y+C6KeB77yaW1tFdmVudFR5cGVdXeOAglxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0g56e76Zmk5oyH5a6a5rOo5YaM5Zue6LCD44CC5aaC5p6c5rKh5pyJ57uZ77yM5YiZ5Yig6Zmk5YWo6YOo5ZCM5LqL5Lu257G75Z6L55qE55uR5ZCs44CCXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IC0g6LCD55So5Zue6LCD55qE55uu5qCH44CC6YWN5ZCIIGNhbGxiYWNrIOS4gOi1t+S9v+eUqOOAglxyXG4gICAgICogQHBhcmFtIHVzZUNhcHR1cmUgLSDlvZPorr7nva7kuLogdHJ1Ze+8jOebkeWQrOWZqOWwhuWcqOaNleiOt+mYtuauteinpuWPke+8jOWQpuWImeWwhuWcqOWGkuazoemYtuauteinpuWPkeOAgum7mOiupOS4uiBmYWxzZeOAglxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGB0eXBlc2NyaXB0XHJcbiAgICAgKiB0aGlzLm5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLm1lbWJlckZ1bmN0aW9uLCB0aGlzKTtcclxuICAgICAqIG5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCBjYWxsYmFjaywgdGhpcy5ub2RlKTtcclxuICAgICAqIG5vZGUub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLkFOQ0hPUl9DSEFOR0VELCBjYWxsYmFjaywgdGhpcyk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9mZiAodHlwZTogc3RyaW5nLCBjYWxsYmFjaz86IEZ1bmN0aW9uLCB0YXJnZXQ/OiBPYmplY3QsIHVzZUNhcHR1cmU/OiBPYmplY3QpIHtcclxuICAgICAgICBjb25zdCB0b3VjaEV2ZW50ID0gX3RvdWNoRXZlbnRzLmluZGV4T2YodHlwZSkgIT09IC0xO1xyXG4gICAgICAgIGNvbnN0IG1vdXNlRXZlbnQgPSAhdG91Y2hFdmVudCAmJiBfbW91c2VFdmVudHMuaW5kZXhPZih0eXBlKSAhPT0gLTE7XHJcbiAgICAgICAgaWYgKHRvdWNoRXZlbnQgfHwgbW91c2VFdmVudCkge1xyXG4gICAgICAgICAgICB0aGlzLl9vZmZEaXNwYXRjaCh0eXBlLCBjYWxsYmFjaywgdGFyZ2V0LCB1c2VDYXB0dXJlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0b3VjaEV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b3VjaExpc3RlbmVyICYmICFfY2hlY2tMaXN0ZW5lcnModGhpcy5fbm9kZSwgX3RvdWNoRXZlbnRzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLnRvdWNoTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG91Y2hMaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW91c2VFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW91c2VMaXN0ZW5lciAmJiAhX2NoZWNrTGlzdGVuZXJzKHRoaXMuX25vZGUsIF9tb3VzZUV2ZW50cykpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudE1hbmFnZXIucmVtb3ZlTGlzdGVuZXIodGhpcy5tb3VzZUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdXNlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmJ1YmJsaW5nVGFyZ2V0cykge1xyXG4gICAgICAgICAgICB0aGlzLmJ1YmJsaW5nVGFyZ2V0cy5vZmYodHlwZSwgY2FsbGJhY2ssIHRhcmdldCk7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25zdCBoYXNMaXN0ZW5lcnMgPSB0aGlzLmJ1YmJsaW5nVGFyZ2V0cy5oYXNFdmVudExpc3RlbmVyKHR5cGUpO1xyXG4gICAgICAgICAgICAvLyBBbGwgbGlzdGVuZXIgcmVtb3ZlZFxyXG4gICAgICAgICAgICAvLyBpZiAoIWhhc0xpc3RlbmVycykge1xyXG4gICAgICAgICAgICAvLyAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY2FzZSBFdmVudFR5cGUuUE9TSVRJT05fQ0hBTkdFRDpcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5fZXZlbnRNYXNrICY9IH5QT1NJVElPTl9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY2FzZSBFdmVudFR5cGUuU0NBTEVfQ0hBTkdFRDpcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5fZXZlbnRNYXNrICY9IH5TQ0FMRV9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY2FzZSBFdmVudFR5cGUuUk9UQVRJT05fQ0hBTkdFRDpcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdGhpcy5fZXZlbnRNYXNrICY9IH5ST1RBVElPTl9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgY2FzZSBFdmVudFR5cGUuU0laRV9DSEFOR0VEOlxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLl9ldmVudE1hc2sgJj0gflNJWkVfT047XHJcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAvLyAgICAgICAgIGNhc2UgRXZlbnRUeXBlLkFOQ0hPUl9DSEFOR0VEOlxyXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICB0aGlzLl9ldmVudE1hc2sgJj0gfkFOQ0hPUl9PTjtcclxuICAgICAgICAgICAgLy8gICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOmAmui/h+S6i+S7tuWQjeWPkemAgeiHquWumuS5ieS6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CCXHJcbiAgICAgKiBAcGFyYW0gYXJnMCAtIOWbnuiwg+esrOS4gOS4quWPguaVsOOAglxyXG4gICAgICogQHBhcmFtIGFyZzEgLSDlm57osIPnrKzkuozkuKrlj4LmlbDjgIJcclxuICAgICAqIEBwYXJhbSBhcmcyIC0g5Zue6LCD56ys5LiJ5Liq5Y+C5pWw44CCXHJcbiAgICAgKiBAcGFyYW0gYXJnMyAtIOWbnuiwg+esrOWbm+S4quWPguaVsOOAglxyXG4gICAgICogQHBhcmFtIGFyZzQgLSDlm57osIPnrKzkupTkuKrlj4LmlbDjgIJcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGB0eXBlc2NyaXB0XHJcbiAgICAgKiBldmVudFRhcmdldC5lbWl0KCdmaXJlJywgZXZlbnQpO1xyXG4gICAgICogZXZlbnRUYXJnZXQuZW1pdCgnZmlyZScsIG1lc3NhZ2UsIGVtaXR0ZXIpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKi9cclxucHVibGljIGVtaXQgKHR5cGU6IHN0cmluZywgYXJnMD86IGFueSwgYXJnMT86IGFueSwgYXJnMj86IGFueSwgYXJnMz86IGFueSwgYXJnND86IGFueSkge1xyXG4gICAgICAgIGlmICh0aGlzLmJ1YmJsaW5nVGFyZ2V0cykge1xyXG4gICAgICAgICAgICB0aGlzLmJ1YmJsaW5nVGFyZ2V0cy5lbWl0KHR5cGUsIGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog5YiG5Y+R5LqL5Lu25Yiw5LqL5Lu25rWB5Lit44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50IC0g5YiG5rS+5Yiw5LqL5Lu25rWB5Lit55qE5LqL5Lu25a+56LGh44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkaXNwYXRjaEV2ZW50IChldmVudDogRXZlbnQpIHtcclxuICAgICAgICBfZG9EaXNwYXRjaEV2ZW50KHRoaXMuX25vZGUsIGV2ZW50KTtcclxuICAgICAgICBfY2FjaGVkQXJyYXkubGVuZ3RoID0gMDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog5piv5ZCm55uR5ZCs6L+H5p+Q5LqL5Lu244CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHR5cGUgLSDkuIDkuKrnm5HlkKzkuovku7bnsbvlnovnmoTlrZfnrKbkuLLjgIJcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayAtIFRoZSBjYWxsYmFjayBmdW5jdGlvbiBvZiB0aGUgZXZlbnQgbGlzdGVuZXIsIGlmIGFic2VudCBhbGwgZXZlbnQgbGlzdGVuZXJzIGZvciB0aGUgZ2l2ZW4gdHlwZSB3aWxsIGJlIHJlbW92ZWRcclxuICAgICAqIEBwYXJhbSB0YXJnZXQgLSBUaGUgY2FsbGJhY2sgY2FsbGVlIG9mIHRoZSBldmVudCBsaXN0ZW5lclxyXG4gICAgICogQHJldHVybiAtIOi/lOWbnuaYr+WQpuW9k+WJjeiKgueCueW3suebkeWQrOivpeS6i+S7tuexu+Wei+OAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaGFzRXZlbnRMaXN0ZW5lciAodHlwZTogc3RyaW5nLCBjYWxsYmFjaz86IEZ1bmN0aW9uLCB0YXJnZXQ/OiBPYmplY3QpIHtcclxuICAgICAgICBsZXQgaGFzID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuYnViYmxpbmdUYXJnZXRzKSB7XHJcbiAgICAgICAgICAgIGhhcyA9IHRoaXMuYnViYmxpbmdUYXJnZXRzLmhhc0V2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2ssIHRhcmdldCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaGFzICYmIHRoaXMuY2FwdHVyaW5nVGFyZ2V0cykge1xyXG4gICAgICAgICAgICBoYXMgPSB0aGlzLmNhcHR1cmluZ1RhcmdldHMuaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgdGFyZ2V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog56e76Zmk5Zyo54m55a6a5LqL5Lu257G75Z6L5Lit5rOo5YaM55qE5omA5pyJ5Zue6LCD5oiW5Zyo5p+Q5Liq55uu5qCH5Lit5rOo5YaM55qE5omA5pyJ5Zue6LCD44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHRhcmdldCAtIOimgeWIoOmZpOeahOS6i+S7tumUruaIluimgeWIoOmZpOeahOebruagh+OAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdGFyZ2V0T2ZmICh0YXJnZXQ6IHN0cmluZyB8IE9iamVjdCkge1xyXG4gICAgICAgIGlmICh0aGlzLmNhcHR1cmluZ1RhcmdldHMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXB0dXJpbmdUYXJnZXRzLnJlbW92ZUFsbCh0YXJnZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5idWJibGluZ1RhcmdldHMpIHtcclxuICAgICAgICAgICAgdGhpcy5idWJibGluZ1RhcmdldHMucmVtb3ZlQWxsKHRhcmdldCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy50b3VjaExpc3RlbmVyICYmICFfY2hlY2tMaXN0ZW5lcnModGhpcy5ub2RlLCBfdG91Y2hFdmVudHMpKSB7XHJcbiAgICAgICAgICAgIGV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLnRvdWNoTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnRvdWNoTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5tb3VzZUxpc3RlbmVyICYmICFfY2hlY2tMaXN0ZW5lcnModGhpcy5ub2RlLCBfbW91c2VFdmVudHMpKSB7XHJcbiAgICAgICAgICAgIGV2ZW50TWFuYWdlci5yZW1vdmVMaXN0ZW5lcih0aGlzLm1vdXNlTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog6I635b6X5omA5o+Q5L6b55qE5LqL5Lu257G75Z6L5Zyo55uu5qCH5o2V6I636Zi25q6155uR5ZCs55qE5omA5pyJ55uu5qCH44CCXHJcbiAgICAgKiDmjZXojrfpmLbmrrXljIXmi6zku47moLnoioLngrnliLDnm67moIfoioLngrnnmoTov4fnqIvjgIJcclxuICAgICAqIOe7k+aenOS/neWtmOWcqOaVsOe7hOWPguaVsOS4re+8jOW5tuS4lOW/hemhu+S7juWtkOiKgueCueaOkuW6j+WIsOeItuiKgueCueOAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CCXHJcbiAgICAgKiBAcGFyYW0gYXJyYXkgLSDmjqXmlLbnm67moIfnmoTmlbDnu4TjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldENhcHR1cmluZ1RhcmdldHMgKHR5cGU6IHN0cmluZywgdGFyZ2V0czogQmFzZU5vZGVbXSkge1xyXG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLl9ub2RlLnBhcmVudDtcclxuICAgICAgICB3aGlsZSAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnQuZXZlbnRQcm9jZXNzb3IuY2FwdHVyaW5nVGFyZ2V0cyAmJiBwYXJlbnQuZXZlbnRQcm9jZXNzb3IuY2FwdHVyaW5nVGFyZ2V0cy5oYXNFdmVudExpc3RlbmVyKHR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRzLnB1c2gocGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog6I635b6X5omA5o+Q5L6b55qE5LqL5Lu257G75Z6L5Zyo55uu5qCH5YaS5rOh6Zi25q6155uR5ZCs55qE5omA5pyJ55uu5qCH44CCXHJcbiAgICAgKiDlhpLms6HpmLbmrrXnm67moIfoioLngrnliLDmoLnoioLngrnnmoTov4fnqIvjgIJcclxuICAgICAqIOe7k+aenOS/neWtmOWcqOaVsOe7hOWPguaVsOS4re+8jOW5tuS4lOW/hemhu+S7juWtkOiKgueCueaOkuW6j+WIsOeItuiKgueCueOAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB0eXBlIC0g5LiA5Liq55uR5ZCs5LqL5Lu257G75Z6L55qE5a2X56ym5Liy44CCXHJcbiAgICAgKiBAcGFyYW0gYXJyYXkgLSDmjqXmlLbnm67moIfnmoTmlbDnu4TjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEJ1YmJsaW5nVGFyZ2V0cyAodHlwZTogc3RyaW5nLCB0YXJnZXRzOiBCYXNlTm9kZVtdKSB7XHJcbiAgICAgICAgbGV0IHBhcmVudCA9IHRoaXMuX25vZGUucGFyZW50O1xyXG4gICAgICAgIHdoaWxlIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgaWYgKHBhcmVudC5ldmVudFByb2Nlc3Nvci5idWJibGluZ1RhcmdldHMgJiYgcGFyZW50LmV2ZW50UHJvY2Vzc29yLmJ1YmJsaW5nVGFyZ2V0cy5oYXNFdmVudExpc3RlbmVyKHR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRzLnB1c2gocGFyZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFVkVOVCBUQVJHRVRcclxuXHJcbiAgICBwcml2YXRlIF9jaGVja25TZXR1cFN5c0V2ZW50ICh0eXBlOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgbmV3QWRkZWQgPSBmYWxzZTtcclxuICAgICAgICBsZXQgZm9yRGlzcGF0Y2ggPSBmYWxzZTtcclxuICAgICAgICAvLyBqdXN0IGZvciB1aVxyXG4gICAgICAgIGlmIChfdG91Y2hFdmVudHMuaW5kZXhPZih0eXBlKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnRvdWNoTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG91Y2hMaXN0ZW5lciA9IGNjLkV2ZW50TGlzdGVuZXIuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudDogY2MuRXZlbnRMaXN0ZW5lci5UT1VDSF9PTkVfQllfT05FLFxyXG4gICAgICAgICAgICAgICAgICAgIHN3YWxsb3dUb3VjaGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG93bmVyOiB0aGlzLl9ub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hc2s6IF9zZWFyY2hNYXNrSW5QYXJlbnQodGhpcy5fbm9kZSBhcyBOb2RlKSxcclxuICAgICAgICAgICAgICAgICAgICBvblRvdWNoQmVnYW46IF90b3VjaFN0YXJ0SGFuZGxlcixcclxuICAgICAgICAgICAgICAgICAgICBvblRvdWNoTW92ZWQ6IF90b3VjaE1vdmVIYW5kbGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uVG91Y2hFbmRlZDogX3RvdWNoRW5kSGFuZGxlcixcclxuICAgICAgICAgICAgICAgICAgICBvblRvdWNoQ2FuY2VsbGVkOiBfdG91Y2hDYW5jZWxIYW5kbGVyLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBldmVudE1hbmFnZXIuYWRkTGlzdGVuZXIodGhpcy50b3VjaExpc3RlbmVyIGFzIEV2ZW50TGlzdGVuZXIsIHRoaXMuX25vZGUpO1xyXG4gICAgICAgICAgICAgICAgbmV3QWRkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvckRpc3BhdGNoID0gdHJ1ZTtcclxuICAgICAgICB9IGVsc2UgaWYgKF9tb3VzZUV2ZW50cy5pbmRleE9mKHR5cGUpICE9PSAtMSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMubW91c2VMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3VzZUxpc3RlbmVyID0gY2MuRXZlbnRMaXN0ZW5lci5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBjYy5FdmVudExpc3RlbmVyLk1PVVNFLFxyXG4gICAgICAgICAgICAgICAgICAgIF9wcmV2aW91c0luOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBvd25lcjogdGhpcy5fbm9kZSxcclxuICAgICAgICAgICAgICAgICAgICBtYXNrOiBfc2VhcmNoTWFza0luUGFyZW50KHRoaXMuX25vZGUgYXMgTm9kZSksXHJcbiAgICAgICAgICAgICAgICAgICAgb25Nb3VzZURvd246IF9tb3VzZURvd25IYW5kbGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uTW91c2VNb3ZlOiBfbW91c2VNb3ZlSGFuZGxlcixcclxuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlVXA6IF9tb3VzZVVwSGFuZGxlcixcclxuICAgICAgICAgICAgICAgICAgICBvbk1vdXNlU2Nyb2xsOiBfbW91c2VXaGVlbEhhbmRsZXIsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGV2ZW50TWFuYWdlci5hZGRMaXN0ZW5lcih0aGlzLm1vdXNlTGlzdGVuZXIgYXMgRXZlbnRMaXN0ZW5lciwgdGhpcy5fbm9kZSk7XHJcbiAgICAgICAgICAgICAgICBuZXdBZGRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yRGlzcGF0Y2ggPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmV3QWRkZWQgJiYgIXRoaXMuX25vZGUuYWN0aXZlSW5IaWVyYXJjaHkpIHtcclxuICAgICAgICAgICAgY2MuZGlyZWN0b3IuZ2V0U2NoZWR1bGVyKCkuc2NoZWR1bGUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9ub2RlLmFjdGl2ZUluSGllcmFyY2h5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRNYW5hZ2VyLnBhdXNlVGFyZ2V0KHRoaXMuX25vZGUgYXMgTm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX25vZGUsIDAsIDAsIDAsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZvckRpc3BhdGNoO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX29uRGlzcGF0Y2ggKHR5cGU6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uLCB0YXJnZXQ/OiBPYmplY3QsIHVzZUNhcHR1cmU/OiBPYmplY3QpIHtcclxuICAgICAgICAvLyBBY2NlcHQgYWxzbyBwYXRhbWV0ZXJzIGxpa2U6ICh0eXBlLCBjYWxsYmFjaywgdXNlQ2FwdHVyZSlcclxuICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgIHVzZUNhcHR1cmUgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIHRhcmdldCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB9IGVsc2UgeyB1c2VDYXB0dXJlID0gISF1c2VDYXB0dXJlOyB9XHJcbiAgICAgICAgaWYgKCFjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBjYy5lcnJvcklEKDY4MDApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgbGlzdGVuZXJzOiBDYWxsYmFja3NJbnZva2VyIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHVzZUNhcHR1cmUpIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJzID0gdGhpcy5jYXB0dXJpbmdUYXJnZXRzID0gdGhpcy5jYXB0dXJpbmdUYXJnZXRzIHx8IG5ldyBDYWxsYmFja3NJbnZva2VyKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGlzdGVuZXJzID0gdGhpcy5idWJibGluZ1RhcmdldHMgPSB0aGlzLmJ1YmJsaW5nVGFyZ2V0cyB8fCBuZXcgQ2FsbGJhY2tzSW52b2tlcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFsaXN0ZW5lcnMuaGFzRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgdGFyZ2V0KSkge1xyXG4gICAgICAgICAgICBsaXN0ZW5lcnMub24odHlwZSwgY2FsbGJhY2ssIHRhcmdldCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gY2FsbGJhY2s7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfb2ZmRGlzcGF0Y2ggKHR5cGU6IHN0cmluZywgY2FsbGJhY2s/OiBGdW5jdGlvbiwgdGFyZ2V0PzogT2JqZWN0LCB1c2VDYXB0dXJlPzogT2JqZWN0KSB7XHJcbiAgICAgICAgLy8gQWNjZXB0IGFsc28gcGF0YW1ldGVycyBsaWtlOiAodHlwZSwgY2FsbGJhY2ssIHVzZUNhcHR1cmUpXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICB1c2VDYXB0dXJlID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB0YXJnZXQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSBlbHNlIHsgdXNlQ2FwdHVyZSA9ICEhdXNlQ2FwdHVyZTsgfVxyXG4gICAgICAgIGlmICghY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FwdHVyaW5nVGFyZ2V0cyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcHR1cmluZ1RhcmdldHMucmVtb3ZlQWxsKHR5cGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5idWJibGluZ1RhcmdldHMpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWJibGluZ1RhcmdldHMucmVtb3ZlQWxsKHR5cGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdXNlQ2FwdHVyZSA/IHRoaXMuY2FwdHVyaW5nVGFyZ2V0cyA6IHRoaXMuYnViYmxpbmdUYXJnZXRzO1xyXG4gICAgICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnMub2ZmKHR5cGUsIGNhbGxiYWNrLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jYy5Ob2RlRXZlbnRQcm9jZXNzb3IgPSBOb2RlRXZlbnRQcm9jZXNzb3I7XHJcbiJdfQ==