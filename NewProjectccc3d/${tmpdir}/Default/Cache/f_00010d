(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../../3d/framework/renderable-component.js", "../../data/class-decorator.js", "../../math/index.js", "../../platform/event-manager/event-enum.js", "../../value-types/enum.js", "../../3d/builtin/init.js", "../../assets/index.js", "../../gfx/define.js", "../../renderer/index.js", "../../renderer/ui/render-data.js", "./ui-component.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../../3d/framework/renderable-component.js"), require("../../data/class-decorator.js"), require("../../math/index.js"), require("../../platform/event-manager/event-enum.js"), require("../../value-types/enum.js"), require("../../3d/builtin/init.js"), require("../../assets/index.js"), require("../../gfx/define.js"), require("../../renderer/index.js"), require("../../renderer/ui/render-data.js"), require("./ui-component.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.renderableComponent, global.classDecorator, global.index, global.eventEnum, global._enum, global.init, global.index, global.define, global.index, global.renderData, global.uiComponent);
    global.uiRenderComponent = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _renderableComponent, _classDecorator, _index, _eventEnum, _enum, _init, _index2, _define, _index3, _renderData, _uiComponent) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.UIRenderComponent = _exports.InstanceMaterialType = void 0;

  var _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _class3, _temp;

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _createForOfIteratorHelper(o) { if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (o = _unsupportedIterableToArray(o))) { var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var it, normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(n); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

  function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  // hack
  (0, _enum.ccenum)(_define.GFXBlendFactor);
  /**
   * @en
   * The shader property type of the material after instantiation.
   *
   * @zh
   * 实例后的材质的着色器属性类型。
   */

  var InstanceMaterialType;
  _exports.InstanceMaterialType = InstanceMaterialType;

  (function (InstanceMaterialType) {
    InstanceMaterialType[InstanceMaterialType["ADDCOLOR"] = 0] = "ADDCOLOR";
    InstanceMaterialType[InstanceMaterialType["ADDCOLORANDTEXTURE"] = 1] = "ADDCOLORANDTEXTURE";
    InstanceMaterialType[InstanceMaterialType["GRAYSCALE"] = 2] = "GRAYSCALE";
  })(InstanceMaterialType || (_exports.InstanceMaterialType = InstanceMaterialType = {}));

  var _matInsInfo = {
    parent: null,
    owner: null,
    subModelIdx: 0
  };
  /**
   * @en
   * Base class for components which supports rendering features.
   *
   * @zh
   * 所有支持渲染的 UI 组件的基类。
   */

  var UIRenderComponent = (_dec = (0, _classDecorator.ccclass)('cc.UIRenderComponent'), _dec2 = (0, _classDecorator.property)({
    type: _define.GFXBlendFactor,
    displayOrder: 0,
    tooltip: '原图混合模式'
  }), _dec3 = (0, _classDecorator.property)({
    type: _define.GFXBlendFactor,
    displayOrder: 1,
    tooltip: '目标混合模式'
  }), _dec4 = (0, _classDecorator.property)({
    displayOrder: 2,
    tooltip: '渲染颜色'
  }), _dec5 = (0, _classDecorator.property)({
    type: _index2.Material,
    displayOrder: 3,
    tooltip: '源材质',
    visible: false
  }), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function (_UIComponent) {
    _inherits(UIRenderComponent, _UIComponent);

    function UIRenderComponent() {
      var _getPrototypeOf2;

      var _this;

      _classCallCheck(this, UIRenderComponent);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(UIRenderComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));

      _initializerDefineProperty(_this, "_srcBlendFactor", _descriptor, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_dstBlendFactor", _descriptor2, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_color", _descriptor3, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_sharedMaterial", _descriptor4, _assertThisInitialized(_this));

      _this._assembler = null;
      _this._postAssembler = null;
      _this._renderData = null;
      _this._renderDataFlag = true;
      _this._renderFlag = true;
      _this._delegateSrc = null;
      _this._material = null;
      _this._instanceMaterialType = InstanceMaterialType.ADDCOLORANDTEXTURE;
      _this._blendTemplate = {
        blendState: {
          targets: [{
            blendSrc: _define.GFXBlendFactor.SRC_ALPHA,
            blendDst: _define.GFXBlendFactor.ONE_MINUS_SRC_ALPHA
          }]
        },
        depthStencilState: {},
        rasterizerState: {}
      };
      return _this;
    }

    _createClass(UIRenderComponent, [{
      key: "__preload",
      value: function __preload() {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "__preload", this).call(this);

        this._instanceMaterial();

        if (this._flushAssembler) {
          this._flushAssembler();
        }
      }
    }, {
      key: "onEnable",
      value: function onEnable() {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "onEnable", this).call(this);

        this.node.on(_eventEnum.SystemEventType.ANCHOR_CHANGED, this._nodeStateChange, this);
        this.node.on(_eventEnum.SystemEventType.SIZE_CHANGED, this._nodeStateChange, this);
        this._renderFlag = this._canRender();
      }
    }, {
      key: "onDisable",
      value: function onDisable() {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "onDisable", this).call(this);

        this.node.off(_eventEnum.SystemEventType.ANCHOR_CHANGED, this._nodeStateChange, this);
        this.node.off(_eventEnum.SystemEventType.SIZE_CHANGED, this._nodeStateChange, this);
        this._renderFlag = false;
      }
    }, {
      key: "onDestroy",
      value: function onDestroy() {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "onDestroy", this).call(this);

        this.destroyRenderData();

        if (this._material) {
          this._material.destroy();
        }

        this._updateMaterial(null);

        this._renderData = null;
      }
      /**
       * @en
       * Marks the render data of the current component as modified so that the render data is recalculated.
       *
       * @zh
       * 标记当前组件的渲染数据为已修改状态，这样渲染数据才会重新计算。
       *
       * @param enable 是否标记为已修改。
       */

    }, {
      key: "markForUpdateRenderData",
      value: function markForUpdateRenderData() {
        var enable = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
        this._renderFlag = this._canRender();

        if (enable && this._renderFlag) {
          var renderData = this._renderData;

          if (renderData) {
            renderData.vertDirty = true;
          }

          this._renderDataFlag = enable;
        } else if (!enable) {
          this._renderDataFlag = enable;
        }
      }
      /**
       * @en
       * Request a new render data.
       *
       * @zh
       * 请求渲染数据。
       *
       * @return 渲染数据 RenderData。
       */

    }, {
      key: "requestRenderData",
      value: function requestRenderData() {
        var data = _renderData.RenderData.add();

        this._renderData = data;
        return data;
      }
      /**
       * @en
       * Destroy render data.
       *
       * @zh
       * 渲染数据销毁。
       */

    }, {
      key: "destroyRenderData",
      value: function destroyRenderData() {
        if (!this._renderData) {
          return;
        }

        _renderData.RenderData.remove(this._renderData);

        this._renderData = null;
      } // Don't call it unless you know your purpose.

    }, {
      key: "updateAssembler",
      value: function updateAssembler(render) {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "updateAssembler", this).call(this, render);

        if (this._renderFlag) {
          this._checkAndUpdateRenderData();

          this._render(render);
        }
      } // Don't call it unless you know your purpose.

    }, {
      key: "postUpdateAssembler",
      value: function postUpdateAssembler(render) {
        _get(_getPrototypeOf(UIRenderComponent.prototype), "postUpdateAssembler", this).call(this, render);

        if (this._renderFlag) {
          this._postRender(render);
        }
      }
    }, {
      key: "_render",
      value: function _render(render) {}
    }, {
      key: "_postRender",
      value: function _postRender(render) {}
    }, {
      key: "_checkAndUpdateRenderData",
      value: function _checkAndUpdateRenderData() {
        if (this._renderDataFlag) {
          this._assembler.updateRenderData(this);

          this._renderDataFlag = false;
        }
      }
    }, {
      key: "_canRender",
      value: function _canRender() {
        return this.material !== null && this.enabled && (this._delegateSrc ? this._delegateSrc.activeInHierarchy : this.enabledInHierarchy);
      }
    }, {
      key: "_postCanRender",
      value: function _postCanRender() {}
    }, {
      key: "_updateColor",
      value: function _updateColor() {
        if (this._assembler && this._assembler.updateColor) {
          this._assembler.updateColor(this);
        }
      }
    }, {
      key: "_updateMaterial",
      value: function _updateMaterial(material) {
        this._material = material;

        this._updateBlendFunc();
      }
    }, {
      key: "_updateBlendFunc",
      value: function _updateBlendFunc() {
        if (!this._material) {
          return;
        }

        var target = this._blendTemplate.blendState.targets[0];

        if (target.blendDst !== this._dstBlendFactor || target.blendSrc !== this._srcBlendFactor) {
          target.blendDst = this._dstBlendFactor;
          target.blendSrc = this._srcBlendFactor;
          this._blendTemplate.depthStencilState = this._material.passes[0].depthStencilState;
          this._blendTemplate.rasterizerState = this._material.passes[0].rasterizerState;

          this._material.overridePipelineStates(this._blendTemplate, 0);
        }
      } // pos, rot, scale changed

    }, {
      key: "_nodeStateChange",
      value: function _nodeStateChange(type) {
        if (this._renderData) {
          this.markForUpdateRenderData();
        }

        var _iterator = _createForOfIteratorHelper(this.node.children),
            _step;

        try {
          for (_iterator.s(); !(_step = _iterator.n()).done;) {
            var child = _step.value;
            var renderComp = child.getComponent(UIRenderComponent);

            if (renderComp) {
              renderComp.markForUpdateRenderData();
            }
          }
        } catch (err) {
          _iterator.e(err);
        } finally {
          _iterator.f();
        }
      }
    }, {
      key: "_instanceMaterial",
      value: function _instanceMaterial() {
        var mat = null;
        _matInsInfo.owner = new _renderableComponent.RenderableComponent();

        if (this._sharedMaterial) {
          _matInsInfo.parent = this._sharedMaterial;
          mat = new _index3.MaterialInstance(_matInsInfo);
        } else {
          switch (this._instanceMaterialType) {
            case InstanceMaterialType.ADDCOLOR:
              _matInsInfo.parent = _init.builtinResMgr.get('ui-base-material');
              mat = new _index3.MaterialInstance(_matInsInfo);
              break;

            case InstanceMaterialType.ADDCOLORANDTEXTURE:
              _matInsInfo.parent = _init.builtinResMgr.get('ui-sprite-material');
              mat = new _index3.MaterialInstance(_matInsInfo);
              break;

            case InstanceMaterialType.GRAYSCALE:
              _matInsInfo.parent = _init.builtinResMgr.get('ui-sprite-gray-material');
              mat = new _index3.MaterialInstance(_matInsInfo);
              break;
          }
        }

        this._updateMaterial(mat);
      }
    }, {
      key: "srcBlendFactor",

      /**
       * @en
       * Specifies the blend mode for the original image, it will clone a new material object.
       *
       * @zh
       * 指定原图的混合模式，这会克隆一个新的材质对象，注意这带来的。
       *
       * @param value 原图混合模式。
       * @example
       * ```typescript
       * sprite.srcBlendFactor = GFXBlendFactor.ONE;
       * ```
       */
      get: function get() {
        return this._srcBlendFactor;
      },
      set: function set(value) {
        if (this._srcBlendFactor === value) {
          return;
        }

        this._srcBlendFactor = value;

        this._updateBlendFunc();
      }
      /**
       * @en
       * Specifies the blend mode for the target image.
       *
       * @zh
       * 指定目标的混合模式。
       *
       * @param value 目标混合模式。
       * @example
       * ```typescript
       * sprite.dstBlendFactor = GFXBlendFactor.ONE;
       * ```
       */

    }, {
      key: "dstBlendFactor",
      get: function get() {
        return this._dstBlendFactor;
      },
      set: function set(value) {
        if (this._dstBlendFactor === value) {
          return;
        }

        this._dstBlendFactor = value;

        this._updateBlendFunc();
      }
      /**
       * @en
       * Render color.
       *
       * @zh
       * 渲染颜色。
       *
       * @param value 渲染颜色。
       */

    }, {
      key: "color",
      get: function get() {
        return this._color;
      },
      set: function set(value) {
        if (this._color === value) {
          return;
        }

        this._color.set(value);

        this._updateColor();

        this.markForUpdateRenderData();
      }
      /**
       * @zh
       * 渲染使用材质，实际使用材质是实例后材质。
       *
       * @param value 源材质。
       */

    }, {
      key: "sharedMaterial",
      get: function get() {
        return this._sharedMaterial;
      },
      set: function set(value) {
        if (this._sharedMaterial === value) {
          return;
        }

        this._sharedMaterial = value;

        if (this._instanceMaterial) {
          this._instanceMaterial();
        }
      }
    }, {
      key: "material",
      get: function get() {
        if (!this._material) {
          if (this._instanceMaterial) {
            this._instanceMaterial();
          }
        }

        return this._material;
      }
    }, {
      key: "renderData",
      get: function get() {
        return this._renderData;
      } // Render data can be submitted even if it is not on the node tree

    }, {
      key: "delegateSrc",
      set: function set(value) {
        this._delegateSrc = value;
      }
    }]);

    return UIRenderComponent;
  }(_uiComponent.UIComponent), _class3.BlendState = _define.GFXBlendFactor, _class3.Assembler = null, _class3.PostAssembler = null, _temp), (_applyDecoratedDescriptor(_class2.prototype, "srcBlendFactor", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "srcBlendFactor"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "dstBlendFactor", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "dstBlendFactor"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "color", [_dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "color"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "sharedMaterial", [_dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "sharedMaterial"), _class2.prototype), _descriptor = _applyDecoratedDescriptor(_class2.prototype, "_srcBlendFactor", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _define.GFXBlendFactor.SRC_ALPHA;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "_dstBlendFactor", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _define.GFXBlendFactor.ONE_MINUS_SRC_ALPHA;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_color", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _index.Color.WHITE.clone();
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "_sharedMaterial", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  })), _class2)) || _class);
  _exports.UIRenderComponent = UIRenderComponent;
  cc.UIRenderComponent = UIRenderComponent;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvY29yZS9jb21wb25lbnRzL3VpLWJhc2UvdWktcmVuZGVyLWNvbXBvbmVudC50cyJdLCJuYW1lcyI6WyJHRlhCbGVuZEZhY3RvciIsIkluc3RhbmNlTWF0ZXJpYWxUeXBlIiwiX21hdEluc0luZm8iLCJwYXJlbnQiLCJvd25lciIsInN1Yk1vZGVsSWR4IiwiVUlSZW5kZXJDb21wb25lbnQiLCJ0eXBlIiwiZGlzcGxheU9yZGVyIiwidG9vbHRpcCIsIk1hdGVyaWFsIiwidmlzaWJsZSIsIl9hc3NlbWJsZXIiLCJfcG9zdEFzc2VtYmxlciIsIl9yZW5kZXJEYXRhIiwiX3JlbmRlckRhdGFGbGFnIiwiX3JlbmRlckZsYWciLCJfZGVsZWdhdGVTcmMiLCJfbWF0ZXJpYWwiLCJfaW5zdGFuY2VNYXRlcmlhbFR5cGUiLCJBRERDT0xPUkFORFRFWFRVUkUiLCJfYmxlbmRUZW1wbGF0ZSIsImJsZW5kU3RhdGUiLCJ0YXJnZXRzIiwiYmxlbmRTcmMiLCJTUkNfQUxQSEEiLCJibGVuZERzdCIsIk9ORV9NSU5VU19TUkNfQUxQSEEiLCJkZXB0aFN0ZW5jaWxTdGF0ZSIsInJhc3Rlcml6ZXJTdGF0ZSIsIl9pbnN0YW5jZU1hdGVyaWFsIiwiX2ZsdXNoQXNzZW1ibGVyIiwibm9kZSIsIm9uIiwiU3lzdGVtRXZlbnRUeXBlIiwiQU5DSE9SX0NIQU5HRUQiLCJfbm9kZVN0YXRlQ2hhbmdlIiwiU0laRV9DSEFOR0VEIiwiX2NhblJlbmRlciIsIm9mZiIsImRlc3Ryb3lSZW5kZXJEYXRhIiwiZGVzdHJveSIsIl91cGRhdGVNYXRlcmlhbCIsImVuYWJsZSIsInJlbmRlckRhdGEiLCJ2ZXJ0RGlydHkiLCJkYXRhIiwiUmVuZGVyRGF0YSIsImFkZCIsInJlbW92ZSIsInJlbmRlciIsIl9jaGVja0FuZFVwZGF0ZVJlbmRlckRhdGEiLCJfcmVuZGVyIiwiX3Bvc3RSZW5kZXIiLCJ1cGRhdGVSZW5kZXJEYXRhIiwibWF0ZXJpYWwiLCJlbmFibGVkIiwiYWN0aXZlSW5IaWVyYXJjaHkiLCJlbmFibGVkSW5IaWVyYXJjaHkiLCJ1cGRhdGVDb2xvciIsIl91cGRhdGVCbGVuZEZ1bmMiLCJ0YXJnZXQiLCJfZHN0QmxlbmRGYWN0b3IiLCJfc3JjQmxlbmRGYWN0b3IiLCJwYXNzZXMiLCJvdmVycmlkZVBpcGVsaW5lU3RhdGVzIiwibWFya0ZvclVwZGF0ZVJlbmRlckRhdGEiLCJjaGlsZHJlbiIsImNoaWxkIiwicmVuZGVyQ29tcCIsImdldENvbXBvbmVudCIsIm1hdCIsIlJlbmRlcmFibGVDb21wb25lbnQiLCJfc2hhcmVkTWF0ZXJpYWwiLCJNYXRlcmlhbEluc3RhbmNlIiwiQUREQ09MT1IiLCJidWlsdGluUmVzTWdyIiwiZ2V0IiwiR1JBWVNDQUxFIiwidmFsdWUiLCJfY29sb3IiLCJzZXQiLCJfdXBkYXRlQ29sb3IiLCJVSUNvbXBvbmVudCIsIkJsZW5kU3RhdGUiLCJBc3NlbWJsZXIiLCJQb3N0QXNzZW1ibGVyIiwicHJvcGVydHkiLCJDb2xvciIsIldISVRFIiwiY2xvbmUiLCJjYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUE4Q0E7QUFDQSxvQkFBT0Esc0JBQVA7QUFFQTs7Ozs7Ozs7TUFPWUMsb0I7OzthQUFBQSxvQjtBQUFBQSxJQUFBQSxvQixDQUFBQSxvQjtBQUFBQSxJQUFBQSxvQixDQUFBQSxvQjtBQUFBQSxJQUFBQSxvQixDQUFBQSxvQjtLQUFBQSxvQixxQ0FBQUEsb0I7O0FBNkJaLE1BQU1DLFdBQWtDLEdBQUc7QUFDdkNDLElBQUFBLE1BQU0sRUFBRSxJQUQrQjtBQUV2Q0MsSUFBQUEsS0FBSyxFQUFFLElBRmdDO0FBR3ZDQyxJQUFBQSxXQUFXLEVBQUU7QUFIMEIsR0FBM0M7QUFNQTs7Ozs7Ozs7TUFRYUMsaUIsV0FEWiw2QkFBUSxzQkFBUixDLFVBZ0JJLDhCQUFTO0FBQ05DLElBQUFBLElBQUksRUFBRVAsc0JBREE7QUFFTlEsSUFBQUEsWUFBWSxFQUFFLENBRlI7QUFHTkMsSUFBQUEsT0FBTyxFQUFFO0FBSEgsR0FBVCxDLFVBK0JBLDhCQUFTO0FBQ05GLElBQUFBLElBQUksRUFBRVAsc0JBREE7QUFFTlEsSUFBQUEsWUFBWSxFQUFFLENBRlI7QUFHTkMsSUFBQUEsT0FBTyxFQUFFO0FBSEgsR0FBVCxDLFVBMkJBLDhCQUFTO0FBQ05ELElBQUFBLFlBQVksRUFBRSxDQURSO0FBRU5DLElBQUFBLE9BQU8sRUFBRTtBQUZILEdBQVQsQyxVQXlCQSw4QkFBUztBQUNORixJQUFBQSxJQUFJLEVBQUVHLGdCQURBO0FBRU5GLElBQUFBLFlBQVksRUFBRSxDQUZSO0FBR05DLElBQUFBLE9BQU8sRUFBRSxLQUhIO0FBSU5FLElBQUFBLE9BQU8sRUFBRTtBQUpILEdBQVQsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1lBcURTQyxVLEdBQWdDLEk7WUFDaENDLGMsR0FBb0MsSTtZQUNwQ0MsVyxHQUFpQyxJO1lBQ2pDQyxlLEdBQWtCLEk7WUFDbEJDLFcsR0FBYyxJO1lBRWRDLFksR0FBNEIsSTtZQUM1QkMsUyxHQUE2QixJO1lBQzdCQyxxQixHQUF3QmxCLG9CQUFvQixDQUFDbUIsa0I7WUFDN0NDLGMsR0FBaUI7QUFDdkJDLFFBQUFBLFVBQVUsRUFBRTtBQUNSQyxVQUFBQSxPQUFPLEVBQUUsQ0FDTDtBQUNJQyxZQUFBQSxRQUFRLEVBQUV4Qix1QkFBZXlCLFNBRDdCO0FBRUlDLFlBQUFBLFFBQVEsRUFBRTFCLHVCQUFlMkI7QUFGN0IsV0FESztBQURELFNBRFc7QUFTdkJDLFFBQUFBLGlCQUFpQixFQUFFLEVBVEk7QUFVdkJDLFFBQUFBLGVBQWUsRUFBRTtBQVZNLE87Ozs7OztrQ0FhUjtBQUNmOztBQUNBLGFBQUtDLGlCQUFMOztBQUNBLFlBQUksS0FBS0MsZUFBVCxFQUF5QjtBQUNyQixlQUFLQSxlQUFMO0FBQ0g7QUFDSjs7O2lDQUVrQjtBQUNmOztBQUNBLGFBQUtDLElBQUwsQ0FBVUMsRUFBVixDQUFhQywyQkFBZ0JDLGNBQTdCLEVBQTZDLEtBQUtDLGdCQUFsRCxFQUFvRSxJQUFwRTtBQUNBLGFBQUtKLElBQUwsQ0FBVUMsRUFBVixDQUFhQywyQkFBZ0JHLFlBQTdCLEVBQTJDLEtBQUtELGdCQUFoRCxFQUFrRSxJQUFsRTtBQUNBLGFBQUtwQixXQUFMLEdBQW1CLEtBQUtzQixVQUFMLEVBQW5CO0FBQ0g7OztrQ0FFbUI7QUFDaEI7O0FBQ0EsYUFBS04sSUFBTCxDQUFVTyxHQUFWLENBQWNMLDJCQUFnQkMsY0FBOUIsRUFBOEMsS0FBS0MsZ0JBQW5ELEVBQXFFLElBQXJFO0FBQ0EsYUFBS0osSUFBTCxDQUFVTyxHQUFWLENBQWNMLDJCQUFnQkcsWUFBOUIsRUFBNEMsS0FBS0QsZ0JBQWpELEVBQW1FLElBQW5FO0FBQ0EsYUFBS3BCLFdBQUwsR0FBbUIsS0FBbkI7QUFDSDs7O2tDQUVtQjtBQUNoQjs7QUFDQSxhQUFLd0IsaUJBQUw7O0FBQ0EsWUFBSSxLQUFLdEIsU0FBVCxFQUFtQjtBQUNmLGVBQUtBLFNBQUwsQ0FBZXVCLE9BQWY7QUFDSDs7QUFFRCxhQUFLQyxlQUFMLENBQXFCLElBQXJCOztBQUNBLGFBQUs1QixXQUFMLEdBQW1CLElBQW5CO0FBQ0g7QUFFRDs7Ozs7Ozs7Ozs7O2dEQVN3RDtBQUFBLFlBQXhCNkIsTUFBd0IsdUVBQU4sSUFBTTtBQUNwRCxhQUFLM0IsV0FBTCxHQUFtQixLQUFLc0IsVUFBTCxFQUFuQjs7QUFDQSxZQUFJSyxNQUFNLElBQUksS0FBSzNCLFdBQW5CLEVBQWdDO0FBQzVCLGNBQU00QixVQUFVLEdBQUcsS0FBSzlCLFdBQXhCOztBQUNBLGNBQUk4QixVQUFKLEVBQWdCO0FBQ1pBLFlBQUFBLFVBQVUsQ0FBQ0MsU0FBWCxHQUF1QixJQUF2QjtBQUNIOztBQUVELGVBQUs5QixlQUFMLEdBQXVCNEIsTUFBdkI7QUFDSCxTQVBELE1BT08sSUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDaEIsZUFBSzVCLGVBQUwsR0FBdUI0QixNQUF2QjtBQUNIO0FBQ0o7QUFFRDs7Ozs7Ozs7Ozs7OzBDQVM0QjtBQUN4QixZQUFNRyxJQUFJLEdBQUdDLHVCQUFXQyxHQUFYLEVBQWI7O0FBQ0EsYUFBS2xDLFdBQUwsR0FBbUJnQyxJQUFuQjtBQUNBLGVBQU9BLElBQVA7QUFDSDtBQUVEOzs7Ozs7Ozs7OzBDQU80QjtBQUN4QixZQUFJLENBQUMsS0FBS2hDLFdBQVYsRUFBdUI7QUFDbkI7QUFDSDs7QUFFRGlDLCtCQUFXRSxNQUFYLENBQWtCLEtBQUtuQyxXQUF2Qjs7QUFDQSxhQUFLQSxXQUFMLEdBQW1CLElBQW5CO0FBQ0gsTyxDQUVEOzs7O3NDQUN3Qm9DLE0sRUFBWTtBQUNoQywrRkFBc0JBLE1BQXRCOztBQUNBLFlBQUksS0FBS2xDLFdBQVQsRUFBcUI7QUFDakIsZUFBS21DLHlCQUFMOztBQUNBLGVBQUtDLE9BQUwsQ0FBYUYsTUFBYjtBQUNIO0FBQ0osTyxDQUVEOzs7OzBDQUM0QkEsTSxFQUFZO0FBQ3BDLG1HQUEwQkEsTUFBMUI7O0FBQ0EsWUFBSSxLQUFLbEMsV0FBVCxFQUFzQjtBQUNsQixlQUFLcUMsV0FBTCxDQUFpQkgsTUFBakI7QUFDSDtBQUNKOzs7OEJBRWtCQSxNLEVBQVksQ0FBRzs7O2tDQUVYQSxNLEVBQVksQ0FBRzs7O2tEQUVBO0FBQ2xDLFlBQUksS0FBS25DLGVBQVQsRUFBMEI7QUFDdEIsZUFBS0gsVUFBTCxDQUFpQjBDLGdCQUFqQixDQUFtQyxJQUFuQzs7QUFDQSxlQUFLdkMsZUFBTCxHQUF1QixLQUF2QjtBQUNIO0FBQ0o7OzttQ0FFdUI7QUFDcEIsZUFBTyxLQUFLd0MsUUFBTCxLQUFrQixJQUFsQixJQUEwQixLQUFLQyxPQUEvQixLQUEyQyxLQUFLdkMsWUFBTCxHQUFvQixLQUFLQSxZQUFMLENBQWtCd0MsaUJBQXRDLEdBQTBELEtBQUtDLGtCQUExRyxDQUFQO0FBQ0g7Ozt1Q0FFMEIsQ0FBRTs7O3FDQUVIO0FBQ3RCLFlBQUksS0FBSzlDLFVBQUwsSUFBbUIsS0FBS0EsVUFBTCxDQUFnQitDLFdBQXZDLEVBQW9EO0FBQ2hELGVBQUsvQyxVQUFMLENBQWlCK0MsV0FBakIsQ0FBNkIsSUFBN0I7QUFDSDtBQUNKOzs7c0NBRTBCSixRLEVBQTJCO0FBQ2xELGFBQUtyQyxTQUFMLEdBQWlCcUMsUUFBakI7O0FBRUEsYUFBS0ssZ0JBQUw7QUFDSDs7O3lDQUU2QjtBQUMxQixZQUFJLENBQUMsS0FBSzFDLFNBQVYsRUFBcUI7QUFDakI7QUFDSDs7QUFFRCxZQUFNMkMsTUFBTSxHQUFHLEtBQUt4QyxjQUFMLENBQW9CQyxVQUFwQixDQUErQkMsT0FBL0IsQ0FBdUMsQ0FBdkMsQ0FBZjs7QUFDQSxZQUFJc0MsTUFBTSxDQUFDbkMsUUFBUCxLQUFvQixLQUFLb0MsZUFBekIsSUFBNENELE1BQU0sQ0FBQ3JDLFFBQVAsS0FBb0IsS0FBS3VDLGVBQXpFLEVBQTBGO0FBQ3RGRixVQUFBQSxNQUFNLENBQUNuQyxRQUFQLEdBQWtCLEtBQUtvQyxlQUF2QjtBQUNBRCxVQUFBQSxNQUFNLENBQUNyQyxRQUFQLEdBQWtCLEtBQUt1QyxlQUF2QjtBQUNBLGVBQUsxQyxjQUFMLENBQW9CTyxpQkFBcEIsR0FBd0MsS0FBS1YsU0FBTCxDQUFlOEMsTUFBZixDQUFzQixDQUF0QixFQUF5QnBDLGlCQUFqRTtBQUNBLGVBQUtQLGNBQUwsQ0FBb0JRLGVBQXBCLEdBQXNDLEtBQUtYLFNBQUwsQ0FBZThDLE1BQWYsQ0FBc0IsQ0FBdEIsRUFBeUJuQyxlQUEvRDs7QUFDQSxlQUFLWCxTQUFMLENBQWUrQyxzQkFBZixDQUFzQyxLQUFLNUMsY0FBM0MsRUFBMkQsQ0FBM0Q7QUFDSDtBQUNKLE8sQ0FFRDs7Ozt1Q0FDNEJkLEksRUFBbUI7QUFDM0MsWUFBSSxLQUFLTyxXQUFULEVBQXNCO0FBQ2xCLGVBQUtvRCx1QkFBTDtBQUNIOztBQUgwQyxtREFLdkIsS0FBS2xDLElBQUwsQ0FBVW1DLFFBTGE7QUFBQTs7QUFBQTtBQUszQyw4REFBd0M7QUFBQSxnQkFBN0JDLEtBQTZCO0FBQ3BDLGdCQUFNQyxVQUFVLEdBQUdELEtBQUssQ0FBQ0UsWUFBTixDQUFtQmhFLGlCQUFuQixDQUFuQjs7QUFDQSxnQkFBSStELFVBQUosRUFBZ0I7QUFDWkEsY0FBQUEsVUFBVSxDQUFDSCx1QkFBWDtBQUNIO0FBQ0o7QUFWMEM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVc5Qzs7OzBDQUU4QjtBQUMzQixZQUFJSyxHQUFvQixHQUFHLElBQTNCO0FBQ0FyRSxRQUFBQSxXQUFXLENBQUNFLEtBQVosR0FBb0IsSUFBSW9FLHdDQUFKLEVBQXBCOztBQUNBLFlBQUksS0FBS0MsZUFBVCxFQUEwQjtBQUN0QnZFLFVBQUFBLFdBQVcsQ0FBQ0MsTUFBWixHQUFxQixLQUFLc0UsZUFBMUI7QUFDQUYsVUFBQUEsR0FBRyxHQUFHLElBQUlHLHdCQUFKLENBQXFCeEUsV0FBckIsQ0FBTjtBQUNILFNBSEQsTUFHTztBQUNILGtCQUFRLEtBQUtpQixxQkFBYjtBQUNJLGlCQUFLbEIsb0JBQW9CLENBQUMwRSxRQUExQjtBQUNJekUsY0FBQUEsV0FBVyxDQUFDQyxNQUFaLEdBQXFCeUUsb0JBQWNDLEdBQWQsQ0FBa0Isa0JBQWxCLENBQXJCO0FBQ0FOLGNBQUFBLEdBQUcsR0FBRyxJQUFJRyx3QkFBSixDQUFxQnhFLFdBQXJCLENBQU47QUFDQTs7QUFDSixpQkFBS0Qsb0JBQW9CLENBQUNtQixrQkFBMUI7QUFDSWxCLGNBQUFBLFdBQVcsQ0FBQ0MsTUFBWixHQUFxQnlFLG9CQUFjQyxHQUFkLENBQWtCLG9CQUFsQixDQUFyQjtBQUNBTixjQUFBQSxHQUFHLEdBQUcsSUFBSUcsd0JBQUosQ0FBcUJ4RSxXQUFyQixDQUFOO0FBQ0E7O0FBQ0osaUJBQUtELG9CQUFvQixDQUFDNkUsU0FBMUI7QUFDSTVFLGNBQUFBLFdBQVcsQ0FBQ0MsTUFBWixHQUFxQnlFLG9CQUFjQyxHQUFkLENBQWtCLHlCQUFsQixDQUFyQjtBQUNBTixjQUFBQSxHQUFHLEdBQUcsSUFBSUcsd0JBQUosQ0FBcUJ4RSxXQUFyQixDQUFOO0FBQ0E7QUFaUjtBQWNIOztBQUVELGFBQUt3QyxlQUFMLENBQXFCNkIsR0FBckI7QUFDSDs7OztBQXJXRDs7Ozs7Ozs7Ozs7OzswQkFrQnNCO0FBQ2xCLGVBQU8sS0FBS1IsZUFBWjtBQUNILE87d0JBRW1CZ0IsSyxFQUF1QjtBQUN2QyxZQUFJLEtBQUtoQixlQUFMLEtBQXlCZ0IsS0FBN0IsRUFBb0M7QUFDaEM7QUFDSDs7QUFFRCxhQUFLaEIsZUFBTCxHQUF1QmdCLEtBQXZCOztBQUNBLGFBQUtuQixnQkFBTDtBQUNIO0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBa0JzQjtBQUNsQixlQUFPLEtBQUtFLGVBQVo7QUFDSCxPO3dCQUVtQmlCLEssRUFBdUI7QUFDdkMsWUFBSSxLQUFLakIsZUFBTCxLQUF5QmlCLEtBQTdCLEVBQW9DO0FBQ2hDO0FBQ0g7O0FBRUQsYUFBS2pCLGVBQUwsR0FBdUJpQixLQUF2Qjs7QUFDQSxhQUFLbkIsZ0JBQUw7QUFDSDtBQUVEOzs7Ozs7Ozs7Ozs7MEJBYzhCO0FBQzFCLGVBQU8sS0FBS29CLE1BQVo7QUFDSCxPO3dCQUVVRCxLLEVBQU87QUFDZCxZQUFJLEtBQUtDLE1BQUwsS0FBZ0JELEtBQXBCLEVBQTJCO0FBQ3ZCO0FBQ0g7O0FBRUQsYUFBS0MsTUFBTCxDQUFZQyxHQUFaLENBQWdCRixLQUFoQjs7QUFDQSxhQUFLRyxZQUFMOztBQUNBLGFBQUtoQix1QkFBTDtBQUNIO0FBRUQ7Ozs7Ozs7OzswQkFZc0I7QUFDbEIsZUFBTyxLQUFLTyxlQUFaO0FBQ0gsTzt3QkFFbUJNLEssRUFBTztBQUN2QixZQUFJLEtBQUtOLGVBQUwsS0FBeUJNLEtBQTdCLEVBQW9DO0FBQ2hDO0FBQ0g7O0FBRUQsYUFBS04sZUFBTCxHQUF1Qk0sS0FBdkI7O0FBQ0EsWUFBSSxLQUFLakQsaUJBQVQsRUFBNEI7QUFDeEIsZUFBS0EsaUJBQUw7QUFDSDtBQUNKOzs7MEJBRWU7QUFDWixZQUFJLENBQUMsS0FBS1osU0FBVixFQUFvQjtBQUNoQixjQUFJLEtBQUtZLGlCQUFULEVBQTRCO0FBQ3hCLGlCQUFLQSxpQkFBTDtBQUNIO0FBQ0o7O0FBRUQsZUFBTyxLQUFLWixTQUFaO0FBQ0g7OzswQkFFaUI7QUFDZCxlQUFPLEtBQUtKLFdBQVo7QUFDSCxPLENBRUQ7Ozs7d0JBQ2lCaUUsSyxFQUFhO0FBQzFCLGFBQUs5RCxZQUFMLEdBQW9COEQsS0FBcEI7QUFDSDs7OztJQXhJa0NJLHdCLFdBMElyQkMsVSxHQUFhcEYsc0IsVUFDYnFGLFMsR0FBc0MsSSxVQUN0Q0MsYSxHQUEwQyxJLGd0QkFFdkRDLHdCOzs7OzthQUMyQnZGLHVCQUFleUIsUzs7c0ZBQzFDOEQsd0I7Ozs7O2FBQzJCdkYsdUJBQWUyQixtQjs7NkVBQzFDNEQsd0I7Ozs7O2FBQ3lCQyxhQUFNQyxLQUFOLENBQVlDLEtBQVosRTs7c0ZBQ3pCSCx3Qjs7Ozs7YUFDNEMsSTs7OztBQXVOakRJLEVBQUFBLEVBQUUsQ0FBQ3JGLGlCQUFILEdBQXVCQSxpQkFBdkIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gQ29weXJpZ2h0IChjKSAyMDE3LTIwMTkgWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuXHJcblxyXG4gaHR0cDovL3d3dy5jb2Nvcy5jb21cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuIHdvcmxkd2lkZSwgcm95YWx0eS1mcmVlLCBub24tYXNzaWduYWJsZSwgcmV2b2NhYmxlIGFuZCBub24tZXhjbHVzaXZlIGxpY2Vuc2VcclxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXHJcbiBub3QgdXNlIENvY29zIENyZWF0b3Igc29mdHdhcmUgZm9yIGRldmVsb3Bpbmcgb3RoZXIgc29mdHdhcmUgb3IgdG9vbHMgdGhhdCdzXHJcbiB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cclxuXHJcbiBUaGUgc29mdHdhcmUgb3IgdG9vbHMgaW4gdGhpcyBMaWNlbnNlIEFncmVlbWVudCBhcmUgbGljZW5zZWQsIG5vdCBzb2xkLlxyXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuXHJcbi8qKlxyXG4gKiBAY2F0ZWdvcnkgdWlcclxuICovXHJcblxyXG5pbXBvcnQgeyBSZW5kZXJhYmxlQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vY29yZS8zZC9mcmFtZXdvcmsvcmVuZGVyYWJsZS1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBjY2NsYXNzLCBwcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvZGF0YS9jbGFzcy1kZWNvcmF0b3InO1xyXG5pbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uLy4uL2NvcmUvbWF0aCc7XHJcbmltcG9ydCB7IFN5c3RlbUV2ZW50VHlwZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvcGxhdGZvcm0vZXZlbnQtbWFuYWdlci9ldmVudC1lbnVtJztcclxuaW1wb3J0IHsgY2NlbnVtIH0gZnJvbSAnLi4vLi4vLi4vY29yZS92YWx1ZS10eXBlcy9lbnVtJztcclxuaW1wb3J0IHsgYnVpbHRpblJlc01nciB9IGZyb20gJy4uLy4uLzNkL2J1aWx0aW4vaW5pdCc7XHJcbmltcG9ydCB7IE1hdGVyaWFsIH0gZnJvbSAnLi4vLi4vYXNzZXRzJztcclxuaW1wb3J0IHsgR0ZYQmxlbmRGYWN0b3IgfSBmcm9tICcuLi8uLi9nZngvZGVmaW5lJztcclxuaW1wb3J0IHsgTWF0ZXJpYWxJbnN0YW5jZSB9IGZyb20gJy4uLy4uL3JlbmRlcmVyJztcclxuaW1wb3J0IHsgSU1hdGVyaWFsSW5zdGFuY2VJbmZvIH0gZnJvbSAnLi4vLi4vcmVuZGVyZXIvY29yZS9tYXRlcmlhbC1pbnN0YW5jZSc7XHJcbmltcG9ydCB7IElBc3NlbWJsZXIsIElBc3NlbWJsZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vcmVuZGVyZXIvdWkvYmFzZSc7XHJcbmltcG9ydCB7IFJlbmRlckRhdGEgfSBmcm9tICcuLi8uLi9yZW5kZXJlci91aS9yZW5kZXItZGF0YSc7XHJcbmltcG9ydCB7IFVJIH0gZnJvbSAnLi4vLi4vcmVuZGVyZXIvdWkvdWknO1xyXG5pbXBvcnQgeyBOb2RlIH0gZnJvbSAnLi4vLi4vc2NlbmUtZ3JhcGgnO1xyXG5pbXBvcnQgeyBUcmFuc2Zvcm1CaXQgfSBmcm9tICcuLi8uLi9zY2VuZS1ncmFwaC9ub2RlLWVudW0nO1xyXG5pbXBvcnQgeyBVSUNvbXBvbmVudCB9IGZyb20gJy4vdWktY29tcG9uZW50JztcclxuXHJcbi8vIGhhY2tcclxuY2NlbnVtKEdGWEJsZW5kRmFjdG9yKTtcclxuXHJcbi8qKlxyXG4gKiBAZW5cclxuICogVGhlIHNoYWRlciBwcm9wZXJ0eSB0eXBlIG9mIHRoZSBtYXRlcmlhbCBhZnRlciBpbnN0YW50aWF0aW9uLlxyXG4gKlxyXG4gKiBAemhcclxuICog5a6e5L6L5ZCO55qE5p2Q6LSo55qE552A6Imy5Zmo5bGe5oCn57G75Z6L44CCXHJcbiAqL1xyXG5leHBvcnQgZW51bSBJbnN0YW5jZU1hdGVyaWFsVHlwZSB7XHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIHNoYWRlciBvbmx5IGhhcyBjb2xvciBwcm9wZXJ0aWVzLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog552A6Imy5Zmo5Y+q5bim6aKc6Imy5bGe5oCn44CCXHJcbiAgICAgKi9cclxuICAgIEFERENPTE9SID0gMCxcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIHNoYWRlciBoYXMgY29sb3IgYW5kIHRleHR1cmUgcHJvcGVydGllcy5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOedgOiJsuWZqOW4puminOiJsuWSjOi0tOWbvuWxnuaAp+OAglxyXG4gICAgICovXHJcbiAgICBBRERDT0xPUkFORFRFWFRVUkUgPSAxLFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBUaGUgc2hhZGVyIGhhcyBjb2xvciBhbmQgdGV4dHVyZSBwcm9wZXJ0aWVzIGFuZCB1c2VzIGdyYXlzY2FsZSBtb2RlLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog552A6Imy5Zmo5bim6aKc6Imy5ZKM6LS05Zu+5bGe5oCnLOW5tuS9v+eUqOeBsOW6puaooeW8j+OAglxyXG4gICAgICovXHJcbiAgICBHUkFZU0NBTEUgPSAyLFxyXG59XHJcblxyXG5jb25zdCBfbWF0SW5zSW5mbzogSU1hdGVyaWFsSW5zdGFuY2VJbmZvID0ge1xyXG4gICAgcGFyZW50OiBudWxsISxcclxuICAgIG93bmVyOiBudWxsISxcclxuICAgIHN1Yk1vZGVsSWR4OiAwLFxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBCYXNlIGNsYXNzIGZvciBjb21wb25lbnRzIHdoaWNoIHN1cHBvcnRzIHJlbmRlcmluZyBmZWF0dXJlcy5cclxuICpcclxuICogQHpoXHJcbiAqIOaJgOacieaUr+aMgea4suafk+eahCBVSSDnu4Tku7bnmoTln7rnsbvjgIJcclxuICovXHJcbkBjY2NsYXNzKCdjYy5VSVJlbmRlckNvbXBvbmVudCcpXHJcbmV4cG9ydCBjbGFzcyBVSVJlbmRlckNvbXBvbmVudCBleHRlbmRzIFVJQ29tcG9uZW50IHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogU3BlY2lmaWVzIHRoZSBibGVuZCBtb2RlIGZvciB0aGUgb3JpZ2luYWwgaW1hZ2UsIGl0IHdpbGwgY2xvbmUgYSBuZXcgbWF0ZXJpYWwgb2JqZWN0LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5oyH5a6a5Y6f5Zu+55qE5re35ZCI5qih5byP77yM6L+Z5Lya5YWL6ZqG5LiA5Liq5paw55qE5p2Q6LSo5a+56LGh77yM5rOo5oSP6L+Z5bim5p2l55qE44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIOWOn+Wbvua3t+WQiOaooeW8j+OAglxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIHNwcml0ZS5zcmNCbGVuZEZhY3RvciA9IEdGWEJsZW5kRmFjdG9yLk9ORTtcclxuICAgICAqIGBgYFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IEdGWEJsZW5kRmFjdG9yLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogMCxcclxuICAgICAgICB0b29sdGlwOiAn5Y6f5Zu+5re35ZCI5qih5byPJyxcclxuICAgIH0pXHJcbiAgICBnZXQgc3JjQmxlbmRGYWN0b3IgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zcmNCbGVuZEZhY3RvcjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc3JjQmxlbmRGYWN0b3IgKHZhbHVlOiBHRlhCbGVuZEZhY3Rvcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9zcmNCbGVuZEZhY3RvciA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc3JjQmxlbmRGYWN0b3IgPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLl91cGRhdGVCbGVuZEZ1bmMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogU3BlY2lmaWVzIHRoZSBibGVuZCBtb2RlIGZvciB0aGUgdGFyZ2V0IGltYWdlLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5oyH5a6a55uu5qCH55qE5re35ZCI5qih5byP44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIOebruagh+a3t+WQiOaooeW8j+OAglxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYHR5cGVzY3JpcHRcclxuICAgICAqIHNwcml0ZS5kc3RCbGVuZEZhY3RvciA9IEdGWEJsZW5kRmFjdG9yLk9ORTtcclxuICAgICAqIGBgYFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IEdGWEJsZW5kRmFjdG9yLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogMSxcclxuICAgICAgICB0b29sdGlwOiAn55uu5qCH5re35ZCI5qih5byPJyxcclxuICAgIH0pXHJcbiAgICBnZXQgZHN0QmxlbmRGYWN0b3IgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kc3RCbGVuZEZhY3RvcjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgZHN0QmxlbmRGYWN0b3IgKHZhbHVlOiBHRlhCbGVuZEZhY3Rvcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9kc3RCbGVuZEZhY3RvciA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fZHN0QmxlbmRGYWN0b3IgPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLl91cGRhdGVCbGVuZEZ1bmMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogUmVuZGVyIGNvbG9yLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5riy5p+T6aKc6Imy44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIOa4suafk+minOiJsuOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogMixcclxuICAgICAgICB0b29sdGlwOiAn5riy5p+T6aKc6ImyJyxcclxuICAgIH0pXHJcbiAgICAvLyBAY29uc3RnZXRcclxuICAgIGdldCBjb2xvciAoKTogUmVhZG9ubHk8Q29sb3I+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29sb3I7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGNvbG9yICh2YWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jb2xvciA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fY29sb3Iuc2V0KHZhbHVlKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVDb2xvcigpO1xyXG4gICAgICAgIHRoaXMubWFya0ZvclVwZGF0ZVJlbmRlckRhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEB6aFxyXG4gICAgICog5riy5p+T5L2/55So5p2Q6LSo77yM5a6e6ZmF5L2/55So5p2Q6LSo5piv5a6e5L6L5ZCO5p2Q6LSo44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZhbHVlIOa6kOadkOi0qOOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IE1hdGVyaWFsLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogMyxcclxuICAgICAgICB0b29sdGlwOiAn5rqQ5p2Q6LSoJyxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgIH0pXHJcbiAgICBnZXQgc2hhcmVkTWF0ZXJpYWwgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaGFyZWRNYXRlcmlhbDtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc2hhcmVkTWF0ZXJpYWwgKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3NoYXJlZE1hdGVyaWFsID09PSB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zaGFyZWRNYXRlcmlhbCA9IHZhbHVlO1xyXG4gICAgICAgIGlmICh0aGlzLl9pbnN0YW5jZU1hdGVyaWFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlTWF0ZXJpYWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IG1hdGVyaWFsICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX21hdGVyaWFsKXtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2luc3RhbmNlTWF0ZXJpYWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlTWF0ZXJpYWwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hdGVyaWFsO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCByZW5kZXJEYXRhICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVyRGF0YTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW5kZXIgZGF0YSBjYW4gYmUgc3VibWl0dGVkIGV2ZW4gaWYgaXQgaXMgbm90IG9uIHRoZSBub2RlIHRyZWVcclxuICAgIHNldCBkZWxlZ2F0ZVNyYyAodmFsdWU6IE5vZGUpIHtcclxuICAgICAgICB0aGlzLl9kZWxlZ2F0ZVNyYyA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgQmxlbmRTdGF0ZSA9IEdGWEJsZW5kRmFjdG9yO1xyXG4gICAgcHVibGljIHN0YXRpYyBBc3NlbWJsZXI6IElBc3NlbWJsZXJNYW5hZ2VyIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwdWJsaWMgc3RhdGljIFBvc3RBc3NlbWJsZXI6IElBc3NlbWJsZXJNYW5hZ2VyIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX3NyY0JsZW5kRmFjdG9yID0gR0ZYQmxlbmRGYWN0b3IuU1JDX0FMUEhBO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX2RzdEJsZW5kRmFjdG9yID0gR0ZYQmxlbmRGYWN0b3IuT05FX01JTlVTX1NSQ19BTFBIQTtcclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9jb2xvcjogQ29sb3IgPSBDb2xvci5XSElURS5jbG9uZSgpO1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX3NoYXJlZE1hdGVyaWFsOiBNYXRlcmlhbCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIHByb3RlY3RlZCBfYXNzZW1ibGVyOiBJQXNzZW1ibGVyIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcm90ZWN0ZWQgX3Bvc3RBc3NlbWJsZXI6IElBc3NlbWJsZXIgfCBudWxsID0gbnVsbDtcclxuICAgIHByb3RlY3RlZCBfcmVuZGVyRGF0YTogUmVuZGVyRGF0YSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJvdGVjdGVkIF9yZW5kZXJEYXRhRmxhZyA9IHRydWU7XHJcbiAgICBwcm90ZWN0ZWQgX3JlbmRlckZsYWcgPSB0cnVlO1xyXG4gICAgLy8g54m55q6K5riy5p+T6IqC54K577yM57uZ5LiA5Lqb5LiN5Zyo6IqC54K55qCR5LiK55qE57uE5Lu25YGa5L6d6LWW5riy5p+T77yI5L6L5aaCIG1hc2sg57uE5Lu25YaF572u5Lik5LiqIGdyYXBoaWNzIOadpea4suafk++8iVxyXG4gICAgcHJvdGVjdGVkIF9kZWxlZ2F0ZVNyYzogTm9kZSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJvdGVjdGVkIF9tYXRlcmlhbDogTWF0ZXJpYWwgfCBudWxsID0gbnVsbDtcclxuICAgIHByb3RlY3RlZCBfaW5zdGFuY2VNYXRlcmlhbFR5cGUgPSBJbnN0YW5jZU1hdGVyaWFsVHlwZS5BRERDT0xPUkFORFRFWFRVUkU7XHJcbiAgICBwcm90ZWN0ZWQgX2JsZW5kVGVtcGxhdGUgPSB7XHJcbiAgICAgICAgYmxlbmRTdGF0ZToge1xyXG4gICAgICAgICAgICB0YXJnZXRzOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxlbmRTcmM6IEdGWEJsZW5kRmFjdG9yLlNSQ19BTFBIQSxcclxuICAgICAgICAgICAgICAgICAgICBibGVuZERzdDogR0ZYQmxlbmRGYWN0b3IuT05FX01JTlVTX1NSQ19BTFBIQSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZXB0aFN0ZW5jaWxTdGF0ZToge30sXHJcbiAgICAgICAgcmFzdGVyaXplclN0YXRlOiB7fSxcclxuICAgIH07XHJcblxyXG4gICAgcHVibGljIF9fcHJlbG9hZCAoKXtcclxuICAgICAgICBzdXBlci5fX3ByZWxvYWQoKTtcclxuICAgICAgICB0aGlzLl9pbnN0YW5jZU1hdGVyaWFsKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2ZsdXNoQXNzZW1ibGVyKXtcclxuICAgICAgICAgICAgdGhpcy5fZmx1c2hBc3NlbWJsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRW5hYmxlICgpIHtcclxuICAgICAgICBzdXBlci5vbkVuYWJsZSgpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihTeXN0ZW1FdmVudFR5cGUuQU5DSE9SX0NIQU5HRUQsIHRoaXMuX25vZGVTdGF0ZUNoYW5nZSwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9uKFN5c3RlbUV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX25vZGVTdGF0ZUNoYW5nZSwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyRmxhZyA9IHRoaXMuX2NhblJlbmRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkRpc2FibGUgKCkge1xyXG4gICAgICAgIHN1cGVyLm9uRGlzYWJsZSgpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vZmYoU3lzdGVtRXZlbnRUeXBlLkFOQ0hPUl9DSEFOR0VELCB0aGlzLl9ub2RlU3RhdGVDaGFuZ2UsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vZmYoU3lzdGVtRXZlbnRUeXBlLlNJWkVfQ0hBTkdFRCwgdGhpcy5fbm9kZVN0YXRlQ2hhbmdlLCB0aGlzKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJGbGFnID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRGVzdHJveSAoKSB7XHJcbiAgICAgICAgc3VwZXIub25EZXN0cm95KCk7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95UmVuZGVyRGF0YSgpO1xyXG4gICAgICAgIGlmICh0aGlzLl9tYXRlcmlhbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3VwZGF0ZU1hdGVyaWFsKG51bGwpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckRhdGEgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBNYXJrcyB0aGUgcmVuZGVyIGRhdGEgb2YgdGhlIGN1cnJlbnQgY29tcG9uZW50IGFzIG1vZGlmaWVkIHNvIHRoYXQgdGhlIHJlbmRlciBkYXRhIGlzIHJlY2FsY3VsYXRlZC5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOagh+iusOW9k+WJjee7hOS7tueahOa4suafk+aVsOaNruS4uuW3suS/ruaUueeKtuaAge+8jOi/meagt+a4suafk+aVsOaNruaJjeS8mumHjeaWsOiuoeeul+OAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlbmFibGUg5piv5ZCm5qCH6K6w5Li65bey5L+u5pS544CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtYXJrRm9yVXBkYXRlUmVuZGVyRGF0YSAoZW5hYmxlOiBib29sZWFuID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckZsYWcgPSB0aGlzLl9jYW5SZW5kZXIoKTtcclxuICAgICAgICBpZiAoZW5hYmxlICYmIHRoaXMuX3JlbmRlckZsYWcpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVuZGVyRGF0YSA9IHRoaXMuX3JlbmRlckRhdGE7XHJcbiAgICAgICAgICAgIGlmIChyZW5kZXJEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZW5kZXJEYXRhLnZlcnREaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckRhdGFGbGFnID0gZW5hYmxlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIWVuYWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEYXRhRmxhZyA9IGVuYWJsZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFJlcXVlc3QgYSBuZXcgcmVuZGVyIGRhdGEuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDor7fmsYLmuLLmn5PmlbDmja7jgIJcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIOa4suafk+aVsOaNriBSZW5kZXJEYXRh44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZXF1ZXN0UmVuZGVyRGF0YSAoKSB7XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IFJlbmRlckRhdGEuYWRkKCk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIERlc3Ryb3kgcmVuZGVyIGRhdGEuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmuLLmn5PmlbDmja7plIDmr4HjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGRlc3Ryb3lSZW5kZXJEYXRhICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3JlbmRlckRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgUmVuZGVyRGF0YS5yZW1vdmUodGhpcy5fcmVuZGVyRGF0YSk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyRGF0YSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRG9uJ3QgY2FsbCBpdCB1bmxlc3MgeW91IGtub3cgeW91ciBwdXJwb3NlLlxyXG4gICAgcHVibGljIHVwZGF0ZUFzc2VtYmxlciAocmVuZGVyOiBVSSkge1xyXG4gICAgICAgIHN1cGVyLnVwZGF0ZUFzc2VtYmxlcihyZW5kZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLl9yZW5kZXJGbGFnKXtcclxuICAgICAgICAgICAgdGhpcy5fY2hlY2tBbmRVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcihyZW5kZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEb24ndCBjYWxsIGl0IHVubGVzcyB5b3Uga25vdyB5b3VyIHB1cnBvc2UuXHJcbiAgICBwdWJsaWMgcG9zdFVwZGF0ZUFzc2VtYmxlciAocmVuZGVyOiBVSSkge1xyXG4gICAgICAgIHN1cGVyLnBvc3RVcGRhdGVBc3NlbWJsZXIocmVuZGVyKTtcclxuICAgICAgICBpZiAodGhpcy5fcmVuZGVyRmxhZykge1xyXG4gICAgICAgICAgICB0aGlzLl9wb3N0UmVuZGVyKHJlbmRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfcmVuZGVyIChyZW5kZXI6IFVJKSB7IH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX3Bvc3RSZW5kZXIgKHJlbmRlcjogVUkpIHsgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfY2hlY2tBbmRVcGRhdGVSZW5kZXJEYXRhICgpe1xyXG4gICAgICAgIGlmICh0aGlzLl9yZW5kZXJEYXRhRmxhZykge1xyXG4gICAgICAgICAgICB0aGlzLl9hc3NlbWJsZXIhLnVwZGF0ZVJlbmRlckRhdGEhKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJEYXRhRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2NhblJlbmRlciAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWF0ZXJpYWwgIT09IG51bGwgJiYgdGhpcy5lbmFibGVkICYmICh0aGlzLl9kZWxlZ2F0ZVNyYyA/IHRoaXMuX2RlbGVnYXRlU3JjLmFjdGl2ZUluSGllcmFyY2h5IDogdGhpcy5lbmFibGVkSW5IaWVyYXJjaHkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfcG9zdENhblJlbmRlciAoKXt9XHJcblxyXG4gICAgcHJvdGVjdGVkIF91cGRhdGVDb2xvciAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Fzc2VtYmxlciAmJiB0aGlzLl9hc3NlbWJsZXIudXBkYXRlQ29sb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5fYXNzZW1ibGVyIS51cGRhdGVDb2xvcih0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF91cGRhdGVNYXRlcmlhbCAobWF0ZXJpYWw6IE1hdGVyaWFsIHwgbnVsbCkge1xyXG4gICAgICAgIHRoaXMuX21hdGVyaWFsID0gbWF0ZXJpYWw7XHJcblxyXG4gICAgICAgIHRoaXMuX3VwZGF0ZUJsZW5kRnVuYygpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfdXBkYXRlQmxlbmRGdW5jICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX21hdGVyaWFsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuX2JsZW5kVGVtcGxhdGUuYmxlbmRTdGF0ZS50YXJnZXRzWzBdO1xyXG4gICAgICAgIGlmICh0YXJnZXQuYmxlbmREc3QgIT09IHRoaXMuX2RzdEJsZW5kRmFjdG9yIHx8IHRhcmdldC5ibGVuZFNyYyAhPT0gdGhpcy5fc3JjQmxlbmRGYWN0b3IpIHtcclxuICAgICAgICAgICAgdGFyZ2V0LmJsZW5kRHN0ID0gdGhpcy5fZHN0QmxlbmRGYWN0b3I7XHJcbiAgICAgICAgICAgIHRhcmdldC5ibGVuZFNyYyA9IHRoaXMuX3NyY0JsZW5kRmFjdG9yO1xyXG4gICAgICAgICAgICB0aGlzLl9ibGVuZFRlbXBsYXRlLmRlcHRoU3RlbmNpbFN0YXRlID0gdGhpcy5fbWF0ZXJpYWwucGFzc2VzWzBdLmRlcHRoU3RlbmNpbFN0YXRlO1xyXG4gICAgICAgICAgICB0aGlzLl9ibGVuZFRlbXBsYXRlLnJhc3Rlcml6ZXJTdGF0ZSA9IHRoaXMuX21hdGVyaWFsLnBhc3Nlc1swXS5yYXN0ZXJpemVyU3RhdGU7XHJcbiAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsLm92ZXJyaWRlUGlwZWxpbmVTdGF0ZXModGhpcy5fYmxlbmRUZW1wbGF0ZSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHBvcywgcm90LCBzY2FsZSBjaGFuZ2VkXHJcbiAgICBwcm90ZWN0ZWQgX25vZGVTdGF0ZUNoYW5nZSAodHlwZTogVHJhbnNmb3JtQml0KXtcclxuICAgICAgICBpZiAodGhpcy5fcmVuZGVyRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLm1hcmtGb3JVcGRhdGVSZW5kZXJEYXRhKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMubm9kZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICBjb25zdCByZW5kZXJDb21wID0gY2hpbGQuZ2V0Q29tcG9uZW50KFVJUmVuZGVyQ29tcG9uZW50KTtcclxuICAgICAgICAgICAgaWYgKHJlbmRlckNvbXApIHtcclxuICAgICAgICAgICAgICAgIHJlbmRlckNvbXAubWFya0ZvclVwZGF0ZVJlbmRlckRhdGEoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2luc3RhbmNlTWF0ZXJpYWwgKCkge1xyXG4gICAgICAgIGxldCBtYXQ6IE1hdGVyaWFsIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgX21hdEluc0luZm8ub3duZXIgPSBuZXcgUmVuZGVyYWJsZUNvbXBvbmVudCgpO1xyXG4gICAgICAgIGlmICh0aGlzLl9zaGFyZWRNYXRlcmlhbCkge1xyXG4gICAgICAgICAgICBfbWF0SW5zSW5mby5wYXJlbnQgPSB0aGlzLl9zaGFyZWRNYXRlcmlhbDtcclxuICAgICAgICAgICAgbWF0ID0gbmV3IE1hdGVyaWFsSW5zdGFuY2UoX21hdEluc0luZm8pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5faW5zdGFuY2VNYXRlcmlhbFR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgSW5zdGFuY2VNYXRlcmlhbFR5cGUuQUREQ09MT1I6XHJcbiAgICAgICAgICAgICAgICAgICAgX21hdEluc0luZm8ucGFyZW50ID0gYnVpbHRpblJlc01nci5nZXQoJ3VpLWJhc2UtbWF0ZXJpYWwnKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXQgPSBuZXcgTWF0ZXJpYWxJbnN0YW5jZShfbWF0SW5zSW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEluc3RhbmNlTWF0ZXJpYWxUeXBlLkFERENPTE9SQU5EVEVYVFVSRTpcclxuICAgICAgICAgICAgICAgICAgICBfbWF0SW5zSW5mby5wYXJlbnQgPSBidWlsdGluUmVzTWdyLmdldCgndWktc3ByaXRlLW1hdGVyaWFsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0ID0gbmV3IE1hdGVyaWFsSW5zdGFuY2UoX21hdEluc0luZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBJbnN0YW5jZU1hdGVyaWFsVHlwZS5HUkFZU0NBTEU6XHJcbiAgICAgICAgICAgICAgICAgICAgX21hdEluc0luZm8ucGFyZW50ID0gYnVpbHRpblJlc01nci5nZXQoJ3VpLXNwcml0ZS1ncmF5LW1hdGVyaWFsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0ID0gbmV3IE1hdGVyaWFsSW5zdGFuY2UoX21hdEluc0luZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl91cGRhdGVNYXRlcmlhbChtYXQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfZmx1c2hBc3NlbWJsZXI/ICgpOiB2b2lkO1xyXG59XHJcblxyXG5jYy5VSVJlbmRlckNvbXBvbmVudCA9IFVJUmVuZGVyQ29tcG9uZW50O1xyXG4iXX0=