(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../data/class-decorator.js", "../renderer/core/sampler-lib.js", "../utils/id-generator.js", "./asset.js", "./asset-enum.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../data/class-decorator.js"), require("../renderer/core/sampler-lib.js"), require("../utils/id-generator.js"), require("./asset.js"), require("./asset-enum.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.classDecorator, global.samplerLib, global.idGenerator, global.asset, global.assetEnum);
    global.textureBase = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _classDecorator, _samplerLib, _idGenerator, _asset, _assetEnum) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.TextureBase = void 0;
  _idGenerator = _interopRequireDefault(_idGenerator);

  var _dec, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _class3, _temp;

  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

  function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  var CHAR_CODE_1 = 49; // '1'

  var idGenerator = new _idGenerator.default('Tex');
  /**
   * 贴图资源基类。它定义了所有贴图共用的概念。
   */

  var TextureBase = (_dec = (0, _classDecorator.ccclass)('cc.TextureBase'), _dec(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function (_Asset) {
    _inherits(TextureBase, _Asset);

    _createClass(TextureBase, [{
      key: "isCompressed",

      /**
       * 此贴图是否为压缩的像素格式。
       */
      get: function get() {
        return this._format >= _assetEnum.PixelFormat.RGB_ETC1 && this._format <= _assetEnum.PixelFormat.RGBA_PVRTC_4BPPV1;
      }
      /**
       * 此贴图的像素宽度。
       */

    }, {
      key: "width",
      get: function get() {
        return this._width;
      }
      /**
       * 此贴图的像素高度。
       */

    }, {
      key: "height",
      get: function get() {
        return this._height;
      }
    }]);

    function TextureBase() {
      var _this;

      var flipY = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      _classCallCheck(this, TextureBase);

      _this = _possibleConstructorReturn(this, _getPrototypeOf(TextureBase).call(this));

      _initializerDefineProperty(_this, "_format", _descriptor, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_premultiplyAlpha", _descriptor2, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_flipY", _descriptor3, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_minFilter", _descriptor4, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_magFilter", _descriptor5, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_mipFilter", _descriptor6, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_wrapS", _descriptor7, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_wrapT", _descriptor8, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_wrapR", _descriptor9, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_anisotropy", _descriptor10, _assertThisInitialized(_this));

      _this._width = 0;
      _this._height = 0;
      _this._id = void 0;
      _this._samplerInfo = [];
      _this._samplerHash = 0;
      _this._gfxSampler = null;
      _this._gfxDevice = null;
      _this._flipY = flipY; // Id for generate hash in material

      _this._id = idGenerator.getNewId();
      _this.loaded = false;
      _this._gfxDevice = _this._getGFXDevice();
      return _this;
    }
    /**
     * 获取标识符。
     * @returns 此贴图的标识符。
     */


    _createClass(TextureBase, [{
      key: "getId",
      value: function getId() {
        return this._id;
      }
      /**
       * 获取像素格式。
       * @returns 此贴图的像素格式。
       */

    }, {
      key: "getPixelFormat",
      value: function getPixelFormat() {
        return this._format;
      }
      /**
       * 返回是否开启了预乘透明通道功能。
       * @returns 此贴图是否开启了预乘透明通道功能。
       */

    }, {
      key: "hasPremultipliedAlpha",
      value: function hasPremultipliedAlpha() {
        return this._premultiplyAlpha || false;
      }
      /**
       * 获取各向异性。
       * @returns 此贴图的各向异性。
       */

    }, {
      key: "getAnisotropy",
      value: function getAnisotropy() {
        return this._anisotropy;
      }
      /**
       * 设置此贴图的缠绕模式。
       * 注意，若贴图尺寸不是 2 的整数幂，缠绕模式仅允许 `WrapMode.CLAMP_TO_EDGE`。
       * @param wrapS S(U) 坐标的采样模式。
       * @param wrapT T(V) 坐标的采样模式。
       * @param wrapR R(W) 坐标的采样模式。
       */

    }, {
      key: "setWrapMode",
      value: function setWrapMode(wrapS, wrapT, wrapR) {
        this._wrapS = wrapS;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.addressU] = wrapS;
        this._wrapT = wrapT;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.addressV] = wrapT;

        if (wrapR !== undefined) {
          this._wrapR = wrapR;
          this._samplerInfo[_samplerLib.SamplerInfoIndex.addressW] = wrapR;
        }

        this._samplerHash = (0, _samplerLib.genSamplerHash)(this._samplerInfo); // for editor assetDB

        if (this._gfxDevice) {
          this._gfxSampler = _samplerLib.samplerLib.getSampler(this._gfxDevice, this._samplerHash);
        }
      }
      /**
       * 设置此贴图的过滤算法。
       * @param minFilter 缩小过滤算法。
       * @param magFilter 放大过滤算法。
       */

    }, {
      key: "setFilters",
      value: function setFilters(minFilter, magFilter) {
        this._minFilter = minFilter;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.minFilter] = minFilter;
        this._magFilter = magFilter;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.magFilter] = magFilter;
        this._samplerHash = (0, _samplerLib.genSamplerHash)(this._samplerInfo);

        if (this._gfxDevice) {
          this._gfxSampler = _samplerLib.samplerLib.getSampler(this._gfxDevice, this._samplerHash);
        }
      }
      /**
       * 设置此贴图的 mip 过滤算法。
       * @param mipFilter mip 过滤算法。
       */

    }, {
      key: "setMipFilter",
      value: function setMipFilter(mipFilter) {
        this._mipFilter = mipFilter;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.mipFilter] = mipFilter;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.maxLOD] = mipFilter === _assetEnum.Filter.NONE ? 0 : 15; // WebGL2 on some platform need this

        this._samplerHash = (0, _samplerLib.genSamplerHash)(this._samplerInfo);

        if (this._gfxDevice) {
          this._gfxSampler = _samplerLib.samplerLib.getSampler(this._gfxDevice, this._samplerHash);
        }
      }
      /**
       * 设置渲染时是否运行将此贴图进行翻转。
       * @param flipY 翻转则为 `true`，否则为 `false`。
       */

    }, {
      key: "setFlipY",
      value: function setFlipY(flipY) {
        this._flipY = flipY;
      }
      /**
       * 设置此贴图是否预乘透明通道。
       * @param premultiply
       */

    }, {
      key: "setPremultiplyAlpha",
      value: function setPremultiplyAlpha(premultiply) {
        this._premultiplyAlpha = premultiply;
      }
      /**
       * 设置此贴图的各向异性。
       * @param anisotropy 各向异性。
       */

    }, {
      key: "setAnisotropy",
      value: function setAnisotropy(anisotropy) {
        this._anisotropy = anisotropy;
        this._samplerInfo[_samplerLib.SamplerInfoIndex.maxAnisotropy] = anisotropy;
        this._samplerHash = (0, _samplerLib.genSamplerHash)(this._samplerInfo);

        if (this._gfxDevice) {
          this._gfxSampler = _samplerLib.samplerLib.getSampler(this._gfxDevice, this._samplerHash);
        }
      }
      /**
       * 销毁此贴图，并释放占有的所有 GPU 资源。
       */

    }, {
      key: "destroy",
      value: function destroy() {
        return _get(_getPrototypeOf(TextureBase.prototype), "destroy", this).call(this);
      }
      /**
       * 获取此贴图底层的 GFX 贴图视图对象。
       */

    }, {
      key: "getGFXTextureView",
      value: function getGFXTextureView() {
        return null;
      }
      /**
       * 获取此贴图内部使用的 GFX 采样器信息。
       * @private
       */

    }, {
      key: "getSamplerHash",
      value: function getSamplerHash() {
        return this._samplerHash;
      }
      /**
       * 获取此贴图底层的 GFX 采样信息。
       */

    }, {
      key: "getGFXSampler",
      value: function getGFXSampler() {
        if (!this._gfxSampler) {
          if (this._gfxDevice) {
            this._gfxSampler = _samplerLib.samplerLib.getSampler(this._gfxDevice, this._samplerHash);
          } else {
            cc.errorID(9302);
          }
        }

        return this._gfxSampler;
      } // SERIALIZATION

      /**
       * @return
       */

    }, {
      key: "_serialize",
      value: function _serialize(exporting) {
        return this._minFilter + ',' + this._magFilter + ',' + this._wrapS + ',' + this._wrapT + ',' + (this._premultiplyAlpha ? 1 : 0) + ',' + this._mipFilter + ',' + this._anisotropy + ',' + (this._flipY ? 1 : 0);
      }
      /**
       *
       * @param data
       */

    }, {
      key: "_deserialize",
      value: function _deserialize(serializedData, handle) {
        var data = serializedData;
        var fields = data.split(',');
        fields.unshift('');

        if (fields.length >= 6) {
          // decode filters
          this.setFilters(parseInt(fields[1]), parseInt(fields[2])); // decode wraps

          this.setWrapMode(parseInt(fields[3]), parseInt(fields[4])); // decode premultiply alpha

          this._premultiplyAlpha = fields[5].charCodeAt(0) === CHAR_CODE_1;
        }

        if (fields.length >= 8) {
          this.setMipFilter(parseInt(fields[6]));
          this.setAnisotropy(parseInt(fields[7]));
        }

        if (fields.length >= 9) {
          this._flipY = fields[8].charCodeAt(0) === CHAR_CODE_1;
        }
      }
    }, {
      key: "_getGFXDevice",
      value: function _getGFXDevice() {
        return cc.director.root && cc.director.root.device;
      }
    }, {
      key: "_getGFXFormat",
      value: function _getGFXFormat() {
        return this._format;
      }
    }, {
      key: "_setGFXFormat",
      value: function _setGFXFormat(format) {
        this._format = format === undefined ? _assetEnum.PixelFormat.RGBA8888 : format;
      }
    }]);

    return TextureBase;
  }(_asset.Asset), _class3.PixelFormat = _assetEnum.PixelFormat, _class3.WrapMode = _assetEnum.WrapMode, _class3.Filter = _assetEnum.Filter, _temp), (_descriptor = _applyDecoratedDescriptor(_class2.prototype, "_format", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.PixelFormat.RGBA8888;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "_premultiplyAlpha", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_flipY", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "_minFilter", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.Filter.LINEAR;
    }
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "_magFilter", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.Filter.LINEAR;
    }
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "_mipFilter", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.Filter.NONE;
    }
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "_wrapS", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.WrapMode.REPEAT;
    }
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "_wrapT", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.WrapMode.REPEAT;
    }
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "_wrapR", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return _assetEnum.WrapMode.REPEAT;
    }
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "_anisotropy", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 8;
    }
  })), _class2)) || _class);
  _exports.TextureBase = TextureBase;

  (function (_TextureBase) {})(TextureBase || (_exports.TextureBase = TextureBase = {}));

  cc.TextureBase = TextureBase;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvY29yZS9hc3NldHMvdGV4dHVyZS1iYXNlLnRzIl0sIm5hbWVzIjpbIkNIQVJfQ09ERV8xIiwiaWRHZW5lcmF0b3IiLCJJREdlbmVyYXRvciIsIlRleHR1cmVCYXNlIiwiX2Zvcm1hdCIsIlBpeGVsRm9ybWF0IiwiUkdCX0VUQzEiLCJSR0JBX1BWUlRDXzRCUFBWMSIsIl93aWR0aCIsIl9oZWlnaHQiLCJmbGlwWSIsIl9pZCIsIl9zYW1wbGVySW5mbyIsIl9zYW1wbGVySGFzaCIsIl9nZnhTYW1wbGVyIiwiX2dmeERldmljZSIsIl9mbGlwWSIsImdldE5ld0lkIiwibG9hZGVkIiwiX2dldEdGWERldmljZSIsIl9wcmVtdWx0aXBseUFscGhhIiwiX2FuaXNvdHJvcHkiLCJ3cmFwUyIsIndyYXBUIiwid3JhcFIiLCJfd3JhcFMiLCJTYW1wbGVySW5mb0luZGV4IiwiYWRkcmVzc1UiLCJfd3JhcFQiLCJhZGRyZXNzViIsInVuZGVmaW5lZCIsIl93cmFwUiIsImFkZHJlc3NXIiwic2FtcGxlckxpYiIsImdldFNhbXBsZXIiLCJtaW5GaWx0ZXIiLCJtYWdGaWx0ZXIiLCJfbWluRmlsdGVyIiwiX21hZ0ZpbHRlciIsIm1pcEZpbHRlciIsIl9taXBGaWx0ZXIiLCJtYXhMT0QiLCJGaWx0ZXIiLCJOT05FIiwicHJlbXVsdGlwbHkiLCJhbmlzb3Ryb3B5IiwibWF4QW5pc290cm9weSIsImNjIiwiZXJyb3JJRCIsImV4cG9ydGluZyIsInNlcmlhbGl6ZWREYXRhIiwiaGFuZGxlIiwiZGF0YSIsImZpZWxkcyIsInNwbGl0IiwidW5zaGlmdCIsImxlbmd0aCIsInNldEZpbHRlcnMiLCJwYXJzZUludCIsInNldFdyYXBNb2RlIiwiY2hhckNvZGVBdCIsInNldE1pcEZpbHRlciIsInNldEFuaXNvdHJvcHkiLCJkaXJlY3RvciIsInJvb3QiLCJkZXZpY2UiLCJmb3JtYXQiLCJSR0JBODg4OCIsIkFzc2V0IiwiV3JhcE1vZGUiLCJwcm9wZXJ0eSIsIkxJTkVBUiIsIlJFUEVBVCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF3Q0EsTUFBTUEsV0FBVyxHQUFHLEVBQXBCLEMsQ0FBMkI7O0FBRTNCLE1BQU1DLFdBQVcsR0FBRyxJQUFJQyxvQkFBSixDQUFnQixLQUFoQixDQUFwQjtBQUNBOzs7O01BSWFDLFcsV0FEWiw2QkFBUSxnQkFBUixDOzs7Ozs7QUFFRzs7OzBCQUdvQztBQUNoQyxlQUFPLEtBQUtDLE9BQUwsSUFBZ0JDLHVCQUFZQyxRQUE1QixJQUF3QyxLQUFLRixPQUFMLElBQWdCQyx1QkFBWUUsaUJBQTNFO0FBQ0g7QUFFRDs7Ozs7OzBCQUc0QjtBQUN4QixlQUFPLEtBQUtDLE1BQVo7QUFDSDtBQUVEOzs7Ozs7MEJBRzZCO0FBQ3pCLGVBQU8sS0FBS0MsT0FBWjtBQUNIOzs7QUErQ0QsMkJBQXFDO0FBQUE7O0FBQUEsVUFBeEJDLEtBQXdCLHVFQUFQLEtBQU87O0FBQUE7O0FBQ2pDOztBQURpQzs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQSxZQVQzQkYsTUFTMkIsR0FUVixDQVNVO0FBQUEsWUFSM0JDLE9BUTJCLEdBUlQsQ0FRUztBQUFBLFlBTjdCRSxHQU02QjtBQUFBLFlBTDdCQyxZQUs2QixHQUxhLEVBS2I7QUFBQSxZQUo3QkMsWUFJNkIsR0FKTixDQUlNO0FBQUEsWUFIN0JDLFdBRzZCLEdBSEksSUFHSjtBQUFBLFlBRjdCQyxVQUU2QixHQUZFLElBRUY7QUFHakMsWUFBS0MsTUFBTCxHQUFjTixLQUFkLENBSGlDLENBS2pDOztBQUNBLFlBQUtDLEdBQUwsR0FBV1YsV0FBVyxDQUFDZ0IsUUFBWixFQUFYO0FBRUEsWUFBS0MsTUFBTCxHQUFjLEtBQWQ7QUFDQSxZQUFLSCxVQUFMLEdBQWtCLE1BQUtJLGFBQUwsRUFBbEI7QUFUaUM7QUFVcEM7QUFFRDs7Ozs7Ozs7OEJBSWdCO0FBQ1osZUFBTyxLQUFLUixHQUFaO0FBQ0g7QUFFRDs7Ozs7Ozt1Q0FJeUI7QUFDckIsZUFBTyxLQUFLUCxPQUFaO0FBQ0g7QUFFRDs7Ozs7Ozs4Q0FJZ0M7QUFDNUIsZUFBTyxLQUFLZ0IsaUJBQUwsSUFBMEIsS0FBakM7QUFDSDtBQUVEOzs7Ozs7O3NDQUl3QjtBQUNwQixlQUFPLEtBQUtDLFdBQVo7QUFDSDtBQUVEOzs7Ozs7Ozs7O2tDQU9vQkMsSyxFQUFpQkMsSyxFQUFpQkMsSyxFQUFrQjtBQUNwRSxhQUFLQyxNQUFMLEdBQWNILEtBQWQ7QUFDQSxhQUFLVixZQUFMLENBQWtCYyw2QkFBaUJDLFFBQW5DLElBQStDTCxLQUEvQztBQUNBLGFBQUtNLE1BQUwsR0FBY0wsS0FBZDtBQUNBLGFBQUtYLFlBQUwsQ0FBa0JjLDZCQUFpQkcsUUFBbkMsSUFBK0NOLEtBQS9DOztBQUNBLFlBQUlDLEtBQUssS0FBS00sU0FBZCxFQUF5QjtBQUNyQixlQUFLQyxNQUFMLEdBQWNQLEtBQWQ7QUFDQSxlQUFLWixZQUFMLENBQWtCYyw2QkFBaUJNLFFBQW5DLElBQStDUixLQUEvQztBQUNIOztBQUVELGFBQUtYLFlBQUwsR0FBb0IsZ0NBQWUsS0FBS0QsWUFBcEIsQ0FBcEIsQ0FWb0UsQ0FXcEU7O0FBQ0EsWUFBSSxLQUFLRyxVQUFULEVBQXFCO0FBQ2pCLGVBQUtELFdBQUwsR0FBbUJtQix1QkFBV0MsVUFBWCxDQUFzQixLQUFLbkIsVUFBM0IsRUFBdUMsS0FBS0YsWUFBNUMsQ0FBbkI7QUFDSDtBQUNKO0FBRUQ7Ozs7Ozs7O2lDQUttQnNCLFMsRUFBbUJDLFMsRUFBbUI7QUFDckQsYUFBS0MsVUFBTCxHQUFrQkYsU0FBbEI7QUFDQSxhQUFLdkIsWUFBTCxDQUFrQmMsNkJBQWlCUyxTQUFuQyxJQUFnREEsU0FBaEQ7QUFDQSxhQUFLRyxVQUFMLEdBQWtCRixTQUFsQjtBQUNBLGFBQUt4QixZQUFMLENBQWtCYyw2QkFBaUJVLFNBQW5DLElBQWdEQSxTQUFoRDtBQUNBLGFBQUt2QixZQUFMLEdBQW9CLGdDQUFlLEtBQUtELFlBQXBCLENBQXBCOztBQUNBLFlBQUksS0FBS0csVUFBVCxFQUFxQjtBQUNqQixlQUFLRCxXQUFMLEdBQW1CbUIsdUJBQVdDLFVBQVgsQ0FBc0IsS0FBS25CLFVBQTNCLEVBQXVDLEtBQUtGLFlBQTVDLENBQW5CO0FBQ0g7QUFDSjtBQUVEOzs7Ozs7O21DQUlxQjBCLFMsRUFBbUI7QUFDcEMsYUFBS0MsVUFBTCxHQUFrQkQsU0FBbEI7QUFDQSxhQUFLM0IsWUFBTCxDQUFrQmMsNkJBQWlCYSxTQUFuQyxJQUFnREEsU0FBaEQ7QUFDQSxhQUFLM0IsWUFBTCxDQUFrQmMsNkJBQWlCZSxNQUFuQyxJQUE2Q0YsU0FBUyxLQUFLRyxrQkFBT0MsSUFBckIsR0FBNEIsQ0FBNUIsR0FBZ0MsRUFBN0UsQ0FIb0MsQ0FHNkM7O0FBQ2pGLGFBQUs5QixZQUFMLEdBQW9CLGdDQUFlLEtBQUtELFlBQXBCLENBQXBCOztBQUNBLFlBQUksS0FBS0csVUFBVCxFQUFxQjtBQUNqQixlQUFLRCxXQUFMLEdBQW1CbUIsdUJBQVdDLFVBQVgsQ0FBc0IsS0FBS25CLFVBQTNCLEVBQXVDLEtBQUtGLFlBQTVDLENBQW5CO0FBQ0g7QUFDSjtBQUVEOzs7Ozs7OytCQUlpQkgsSyxFQUFnQjtBQUM3QixhQUFLTSxNQUFMLEdBQWNOLEtBQWQ7QUFDSDtBQUVEOzs7Ozs7OzBDQUk0QmtDLFcsRUFBc0I7QUFDOUMsYUFBS3hCLGlCQUFMLEdBQXlCd0IsV0FBekI7QUFDSDtBQUVEOzs7Ozs7O29DQUlzQkMsVSxFQUFvQjtBQUN0QyxhQUFLeEIsV0FBTCxHQUFtQndCLFVBQW5CO0FBQ0EsYUFBS2pDLFlBQUwsQ0FBa0JjLDZCQUFpQm9CLGFBQW5DLElBQW9ERCxVQUFwRDtBQUNBLGFBQUtoQyxZQUFMLEdBQW9CLGdDQUFlLEtBQUtELFlBQXBCLENBQXBCOztBQUNBLFlBQUksS0FBS0csVUFBVCxFQUFxQjtBQUNqQixlQUFLRCxXQUFMLEdBQW1CbUIsdUJBQVdDLFVBQVgsQ0FBc0IsS0FBS25CLFVBQTNCLEVBQXVDLEtBQUtGLFlBQTVDLENBQW5CO0FBQ0g7QUFDSjtBQUVEOzs7Ozs7Z0NBR2tCO0FBQ2Q7QUFDSDtBQUVEOzs7Ozs7MENBR21EO0FBQy9DLGVBQU8sSUFBUDtBQUNIO0FBRUQ7Ozs7Ozs7dUNBSXlCO0FBQ3JCLGVBQU8sS0FBS0EsWUFBWjtBQUNIO0FBRUQ7Ozs7OztzQ0FHd0I7QUFDcEIsWUFBSSxDQUFDLEtBQUtDLFdBQVYsRUFBdUI7QUFDbkIsY0FBSSxLQUFLQyxVQUFULEVBQXFCO0FBQ2pCLGlCQUFLRCxXQUFMLEdBQW1CbUIsdUJBQVdDLFVBQVgsQ0FBc0IsS0FBS25CLFVBQTNCLEVBQXVDLEtBQUtGLFlBQTVDLENBQW5CO0FBQ0gsV0FGRCxNQUVPO0FBQ0hrQyxZQUFBQSxFQUFFLENBQUNDLE9BQUgsQ0FBVyxJQUFYO0FBQ0g7QUFDSjs7QUFDRCxlQUFPLEtBQUtsQyxXQUFaO0FBQ0gsTyxDQUVEOztBQUVBOzs7Ozs7aUNBR21CbUMsUyxFQUFzQjtBQUNyQyxlQUFPLEtBQUtaLFVBQUwsR0FBa0IsR0FBbEIsR0FBd0IsS0FBS0MsVUFBN0IsR0FBMEMsR0FBMUMsR0FDSCxLQUFLYixNQURGLEdBQ1csR0FEWCxHQUNpQixLQUFLRyxNQUR0QixHQUMrQixHQUQvQixJQUVGLEtBQUtSLGlCQUFMLEdBQXlCLENBQXpCLEdBQTZCLENBRjNCLElBRWdDLEdBRmhDLEdBR0gsS0FBS29CLFVBSEYsR0FHZSxHQUhmLEdBR3FCLEtBQUtuQixXQUgxQixHQUd3QyxHQUh4QyxJQUlGLEtBQUtMLE1BQUwsR0FBYyxDQUFkLEdBQWtCLENBSmhCLENBQVA7QUFLSDtBQUVEOzs7Ozs7O21DQUlxQmtDLGMsRUFBcUJDLE0sRUFBYTtBQUNuRCxZQUFNQyxJQUFJLEdBQUdGLGNBQWI7QUFDQSxZQUFNRyxNQUFNLEdBQUdELElBQUksQ0FBQ0UsS0FBTCxDQUFXLEdBQVgsQ0FBZjtBQUNBRCxRQUFBQSxNQUFNLENBQUNFLE9BQVAsQ0FBZSxFQUFmOztBQUNBLFlBQUlGLE1BQU0sQ0FBQ0csTUFBUCxJQUFpQixDQUFyQixFQUF3QjtBQUNwQjtBQUNBLGVBQUtDLFVBQUwsQ0FBZ0JDLFFBQVEsQ0FBQ0wsTUFBTSxDQUFDLENBQUQsQ0FBUCxDQUF4QixFQUFxQ0ssUUFBUSxDQUFDTCxNQUFNLENBQUMsQ0FBRCxDQUFQLENBQTdDLEVBRm9CLENBR3BCOztBQUNBLGVBQUtNLFdBQUwsQ0FBaUJELFFBQVEsQ0FBQ0wsTUFBTSxDQUFDLENBQUQsQ0FBUCxDQUF6QixFQUFzQ0ssUUFBUSxDQUFDTCxNQUFNLENBQUMsQ0FBRCxDQUFQLENBQTlDLEVBSm9CLENBS3BCOztBQUNBLGVBQUtqQyxpQkFBTCxHQUF5QmlDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVU8sVUFBVixDQUFxQixDQUFyQixNQUE0QjVELFdBQXJEO0FBQ0g7O0FBQ0QsWUFBSXFELE1BQU0sQ0FBQ0csTUFBUCxJQUFpQixDQUFyQixFQUF3QjtBQUNwQixlQUFLSyxZQUFMLENBQWtCSCxRQUFRLENBQUNMLE1BQU0sQ0FBQyxDQUFELENBQVAsQ0FBMUI7QUFDQSxlQUFLUyxhQUFMLENBQW1CSixRQUFRLENBQUNMLE1BQU0sQ0FBQyxDQUFELENBQVAsQ0FBM0I7QUFDSDs7QUFDRCxZQUFJQSxNQUFNLENBQUNHLE1BQVAsSUFBaUIsQ0FBckIsRUFBd0I7QUFDcEIsZUFBS3hDLE1BQUwsR0FBY3FDLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVU8sVUFBVixDQUFxQixDQUFyQixNQUE0QjVELFdBQTFDO0FBQ0g7QUFDSjs7O3NDQUU0QztBQUN6QyxlQUFPK0MsRUFBRSxDQUFDZ0IsUUFBSCxDQUFZQyxJQUFaLElBQW9CakIsRUFBRSxDQUFDZ0IsUUFBSCxDQUFZQyxJQUFaLENBQWlCQyxNQUE1QztBQUNIOzs7c0NBRTBCO0FBQ3ZCLGVBQU8sS0FBSzdELE9BQVo7QUFDSDs7O29DQUV3QjhELE0sRUFBc0I7QUFDM0MsYUFBSzlELE9BQUwsR0FBZThELE1BQU0sS0FBS3BDLFNBQVgsR0FBdUJ6Qix1QkFBWThELFFBQW5DLEdBQThDRCxNQUE3RDtBQUNIOzs7O0lBdFI0QkUsWSxXQXNCZi9ELFcsR0FBY0Esc0IsVUFFZGdFLFEsR0FBV0EsbUIsVUFFWDNCLE0sR0FBU0EsaUIsa0ZBRXRCNEIsd0I7Ozs7O2FBQzJCakUsdUJBQVk4RCxROzt3RkFFdkNHLHdCOzs7OzthQUM2QixLOzs2RUFFN0JBLHdCOzs7OzthQUNrQixLOztpRkFFbEJBLHdCOzs7OzthQUM4QjVCLGtCQUFPNkIsTTs7aUZBRXJDRCx3Qjs7Ozs7YUFDOEI1QixrQkFBTzZCLE07O2lGQUVyQ0Qsd0I7Ozs7O2FBQzhCNUIsa0JBQU9DLEk7OzZFQUVyQzJCLHdCOzs7OzthQUMwQkQsb0JBQVNHLE07OzZFQUVuQ0Ysd0I7Ozs7O2FBQzBCRCxvQkFBU0csTTs7NkVBRW5DRix3Qjs7Ozs7YUFDMEJELG9CQUFTRyxNOzttRkFFbkNGLHdCOzs7OzthQUN1QixDOzs7OzsrQkFpT1huRSxXLDRCQUFBQSxXOztBQU1qQjRDLEVBQUFBLEVBQUUsQ0FBQzVDLFdBQUgsR0FBaUJBLFdBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuIENvcHlyaWdodCAoYykgMjAxMy0yMDE2IENodWtvbmcgVGVjaG5vbG9naWVzIEluYy5cclxuIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLlxyXG5cclxuIGh0dHA6Ly93d3cuY29jb3MuY29tXHJcblxyXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxyXG4gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBlbmdpbmUgc291cmNlIGNvZGUgKHRoZSBcIlNvZnR3YXJlXCIpLCBhIGxpbWl0ZWQsXHJcbiAgd29ybGR3aWRlLCByb3lhbHR5LWZyZWUsIG5vbi1hc3NpZ25hYmxlLCByZXZvY2FibGUgYW5kIG5vbi1leGNsdXNpdmUgbGljZW5zZVxyXG4gdG8gdXNlIENvY29zIENyZWF0b3Igc29sZWx5IHRvIGRldmVsb3AgZ2FtZXMgb24geW91ciB0YXJnZXQgcGxhdGZvcm1zLiBZb3Ugc2hhbGxcclxuICBub3QgdXNlIENvY29zIENyZWF0b3Igc29mdHdhcmUgZm9yIGRldmVsb3Bpbmcgb3RoZXIgc29mdHdhcmUgb3IgdG9vbHMgdGhhdCdzXHJcbiAgdXNlZCBmb3IgZGV2ZWxvcGluZyBnYW1lcy4gWW91IGFyZSBub3QgZ3JhbnRlZCB0byBwdWJsaXNoLCBkaXN0cmlidXRlLFxyXG4gIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiBDb2NvcyBDcmVhdG9yLlxyXG5cclxuIFRoZSBzb2Z0d2FyZSBvciB0b29scyBpbiB0aGlzIExpY2Vuc2UgQWdyZWVtZW50IGFyZSBsaWNlbnNlZCwgbm90IHNvbGQuXHJcbiBYaWFtZW4gWWFqaSBTb2Z0d2FyZSBDby4sIEx0ZC4gcmVzZXJ2ZXMgYWxsIHJpZ2h0cyBub3QgZXhwcmVzc2x5IGdyYW50ZWQgdG8geW91LlxyXG5cclxuIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1JcclxuIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxyXG4gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXHJcbiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxyXG4gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG4gVEhFIFNPRlRXQVJFLlxyXG4qL1xyXG5cclxuLyoqXHJcbiAqIEBjYXRlZ29yeSBhc3NldFxyXG4gKi9cclxuXHJcbi8vIEB0cy1jaGVja1xyXG5pbXBvcnQge2NjY2xhc3MsIHByb3BlcnR5fSBmcm9tICcuLi9kYXRhL2NsYXNzLWRlY29yYXRvcic7XHJcbmltcG9ydCB7IEdGWERldmljZSB9IGZyb20gJy4uL2dmeC9kZXZpY2UnO1xyXG5pbXBvcnQgeyBHRlhUZXh0dXJlVmlldyB9IGZyb20gJy4uL2dmeC90ZXh0dXJlLXZpZXcnO1xyXG5pbXBvcnQgeyBnZW5TYW1wbGVySGFzaCwgU2FtcGxlckluZm9JbmRleCwgc2FtcGxlckxpYiB9IGZyb20gJy4uL3JlbmRlcmVyL2NvcmUvc2FtcGxlci1saWInO1xyXG5pbXBvcnQgSURHZW5lcmF0b3IgZnJvbSAnLi4vdXRpbHMvaWQtZ2VuZXJhdG9yJztcclxuaW1wb3J0IHsgQXNzZXQgfSBmcm9tICcuL2Fzc2V0JztcclxuaW1wb3J0IHsgRmlsdGVyLCBQaXhlbEZvcm1hdCwgV3JhcE1vZGUgfSBmcm9tICcuL2Fzc2V0LWVudW0nO1xyXG5pbXBvcnQgeyBHRlhTYW1wbGVyIH0gZnJvbSAnLi4vZ2Z4JztcclxuXHJcbmNvbnN0IENIQVJfQ09ERV8xID0gNDk7ICAgIC8vICcxJ1xyXG5cclxuY29uc3QgaWRHZW5lcmF0b3IgPSBuZXcgSURHZW5lcmF0b3IoJ1RleCcpO1xyXG4vKipcclxuICog6LS05Zu+6LWE5rqQ5Z+657G744CC5a6D5a6a5LmJ5LqG5omA5pyJ6LS05Zu+5YWx55So55qE5qaC5b+144CCXHJcbiAqL1xyXG5AY2NjbGFzcygnY2MuVGV4dHVyZUJhc2UnKVxyXG5leHBvcnQgY2xhc3MgVGV4dHVyZUJhc2UgZXh0ZW5kcyBBc3NldCB7XHJcbiAgICAvKipcclxuICAgICAqIOatpOi0tOWbvuaYr+WQpuS4uuWOi+e8qeeahOWDj+e0oOagvOW8j+OAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0IGlzQ29tcHJlc3NlZCAoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdCA+PSBQaXhlbEZvcm1hdC5SR0JfRVRDMSAmJiB0aGlzLl9mb3JtYXQgPD0gUGl4ZWxGb3JtYXQuUkdCQV9QVlJUQ180QlBQVjE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmraTotLTlm77nmoTlg4/ntKDlrr3luqbjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCB3aWR0aCAoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmraTotLTlm77nmoTlg4/ntKDpq5jluqbjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBoZWlnaHQgKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlaWdodDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIFBpeGVsRm9ybWF0ID0gUGl4ZWxGb3JtYXQ7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBXcmFwTW9kZSA9IFdyYXBNb2RlO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRmlsdGVyID0gRmlsdGVyO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9mb3JtYXQ6IG51bWJlciA9IFBpeGVsRm9ybWF0LlJHQkE4ODg4O1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9wcmVtdWx0aXBseUFscGhhID0gZmFsc2U7XHJcblxyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX2ZsaXBZID0gZmFsc2U7XHJcblxyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX21pbkZpbHRlcjogbnVtYmVyID0gRmlsdGVyLkxJTkVBUjtcclxuXHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfbWFnRmlsdGVyOiBudW1iZXIgPSBGaWx0ZXIuTElORUFSO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9taXBGaWx0ZXI6IG51bWJlciA9IEZpbHRlci5OT05FO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF93cmFwUzogbnVtYmVyID0gV3JhcE1vZGUuUkVQRUFUO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF93cmFwVDogbnVtYmVyID0gV3JhcE1vZGUuUkVQRUFUO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF93cmFwUjogbnVtYmVyID0gV3JhcE1vZGUuUkVQRUFUO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9hbmlzb3Ryb3B5ID0gODtcclxuXHJcbiAgICBwcm90ZWN0ZWQgX3dpZHRoOiBudW1iZXIgPSAwO1xyXG4gICAgcHJvdGVjdGVkIF9oZWlnaHQ6IG51bWJlciA9IDA7XHJcblxyXG4gICAgcHJpdmF0ZSBfaWQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgX3NhbXBsZXJJbmZvOiBBcnJheTxudW1iZXIgfCB1bmRlZmluZWQ+ID0gW107XHJcbiAgICBwcml2YXRlIF9zYW1wbGVySGFzaDogbnVtYmVyID0gMDtcclxuICAgIHByaXZhdGUgX2dmeFNhbXBsZXI6IEdGWFNhbXBsZXIgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgX2dmeERldmljZTogR0ZYRGV2aWNlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKGZsaXBZOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICB0aGlzLl9mbGlwWSA9IGZsaXBZO1xyXG5cclxuICAgICAgICAvLyBJZCBmb3IgZ2VuZXJhdGUgaGFzaCBpbiBtYXRlcmlhbFxyXG4gICAgICAgIHRoaXMuX2lkID0gaWRHZW5lcmF0b3IuZ2V0TmV3SWQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5sb2FkZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9nZnhEZXZpY2UgPSB0aGlzLl9nZXRHRlhEZXZpY2UoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluagh+ivhuespuOAglxyXG4gICAgICogQHJldHVybnMg5q2k6LS05Zu+55qE5qCH6K+G56ym44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRJZCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5YOP57Sg5qC85byP44CCXHJcbiAgICAgKiBAcmV0dXJucyDmraTotLTlm77nmoTlg4/ntKDmoLzlvI/jgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldFBpeGVsRm9ybWF0ICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6L+U5Zue5piv5ZCm5byA5ZCv5LqG6aKE5LmY6YCP5piO6YCa6YGT5Yqf6IO944CCXHJcbiAgICAgKiBAcmV0dXJucyDmraTotLTlm77mmK/lkKblvIDlkK/kuobpooTkuZjpgI/mmI7pgJrpgZPlip/og73jgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhc1ByZW11bHRpcGxpZWRBbHBoYSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByZW11bHRpcGx5QWxwaGEgfHwgZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blkITlkJHlvILmgKfjgIJcclxuICAgICAqIEByZXR1cm5zIOatpOi0tOWbvueahOWQhOWQkeW8guaAp+OAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0QW5pc290cm9weSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FuaXNvdHJvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7mraTotLTlm77nmoTnvKDnu5XmqKHlvI/jgIJcclxuICAgICAqIOazqOaEj++8jOiLpei0tOWbvuWwuuWvuOS4jeaYryAyIOeahOaVtOaVsOW5gu+8jOe8oOe7leaooeW8j+S7heWFgeiuuCBgV3JhcE1vZGUuQ0xBTVBfVE9fRURHRWDjgIJcclxuICAgICAqIEBwYXJhbSB3cmFwUyBTKFUpIOWdkOagh+eahOmHh+agt+aooeW8j+OAglxyXG4gICAgICogQHBhcmFtIHdyYXBUIFQoVikg5Z2Q5qCH55qE6YeH5qC35qih5byP44CCXHJcbiAgICAgKiBAcGFyYW0gd3JhcFIgUihXKSDlnZDmoIfnmoTph4fmoLfmqKHlvI/jgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFdyYXBNb2RlICh3cmFwUzogV3JhcE1vZGUsIHdyYXBUOiBXcmFwTW9kZSwgd3JhcFI/OiBXcmFwTW9kZSkge1xyXG4gICAgICAgIHRoaXMuX3dyYXBTID0gd3JhcFM7XHJcbiAgICAgICAgdGhpcy5fc2FtcGxlckluZm9bU2FtcGxlckluZm9JbmRleC5hZGRyZXNzVV0gPSB3cmFwUztcclxuICAgICAgICB0aGlzLl93cmFwVCA9IHdyYXBUO1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJJbmZvW1NhbXBsZXJJbmZvSW5kZXguYWRkcmVzc1ZdID0gd3JhcFQ7XHJcbiAgICAgICAgaWYgKHdyYXBSICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fd3JhcFIgPSB3cmFwUjtcclxuICAgICAgICAgICAgdGhpcy5fc2FtcGxlckluZm9bU2FtcGxlckluZm9JbmRleC5hZGRyZXNzV10gPSB3cmFwUjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJIYXNoID0gZ2VuU2FtcGxlckhhc2godGhpcy5fc2FtcGxlckluZm8pO1xyXG4gICAgICAgIC8vIGZvciBlZGl0b3IgYXNzZXREQlxyXG4gICAgICAgIGlmICh0aGlzLl9nZnhEZXZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2Z4U2FtcGxlciA9IHNhbXBsZXJMaWIuZ2V0U2FtcGxlcih0aGlzLl9nZnhEZXZpY2UsIHRoaXMuX3NhbXBsZXJIYXNoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7mraTotLTlm77nmoTov4fmu6Tnrpfms5XjgIJcclxuICAgICAqIEBwYXJhbSBtaW5GaWx0ZXIg57yp5bCP6L+H5ruk566X5rOV44CCXHJcbiAgICAgKiBAcGFyYW0gbWFnRmlsdGVyIOaUvuWkp+i/h+a7pOeul+azleOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0RmlsdGVycyAobWluRmlsdGVyOiBGaWx0ZXIsIG1hZ0ZpbHRlcjogRmlsdGVyKSB7XHJcbiAgICAgICAgdGhpcy5fbWluRmlsdGVyID0gbWluRmlsdGVyO1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJJbmZvW1NhbXBsZXJJbmZvSW5kZXgubWluRmlsdGVyXSA9IG1pbkZpbHRlcjtcclxuICAgICAgICB0aGlzLl9tYWdGaWx0ZXIgPSBtYWdGaWx0ZXI7XHJcbiAgICAgICAgdGhpcy5fc2FtcGxlckluZm9bU2FtcGxlckluZm9JbmRleC5tYWdGaWx0ZXJdID0gbWFnRmlsdGVyO1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJIYXNoID0gZ2VuU2FtcGxlckhhc2godGhpcy5fc2FtcGxlckluZm8pO1xyXG4gICAgICAgIGlmICh0aGlzLl9nZnhEZXZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2Z4U2FtcGxlciA9IHNhbXBsZXJMaWIuZ2V0U2FtcGxlcih0aGlzLl9nZnhEZXZpY2UsIHRoaXMuX3NhbXBsZXJIYXNoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDorr7nva7mraTotLTlm77nmoQgbWlwIOi/h+a7pOeul+azleOAglxyXG4gICAgICogQHBhcmFtIG1pcEZpbHRlciBtaXAg6L+H5ruk566X5rOV44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRNaXBGaWx0ZXIgKG1pcEZpbHRlcjogRmlsdGVyKSB7XHJcbiAgICAgICAgdGhpcy5fbWlwRmlsdGVyID0gbWlwRmlsdGVyO1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJJbmZvW1NhbXBsZXJJbmZvSW5kZXgubWlwRmlsdGVyXSA9IG1pcEZpbHRlcjtcclxuICAgICAgICB0aGlzLl9zYW1wbGVySW5mb1tTYW1wbGVySW5mb0luZGV4Lm1heExPRF0gPSBtaXBGaWx0ZXIgPT09IEZpbHRlci5OT05FID8gMCA6IDE1OyAvLyBXZWJHTDIgb24gc29tZSBwbGF0Zm9ybSBuZWVkIHRoaXNcclxuICAgICAgICB0aGlzLl9zYW1wbGVySGFzaCA9IGdlblNhbXBsZXJIYXNoKHRoaXMuX3NhbXBsZXJJbmZvKTtcclxuICAgICAgICBpZiAodGhpcy5fZ2Z4RGV2aWNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dmeFNhbXBsZXIgPSBzYW1wbGVyTGliLmdldFNhbXBsZXIodGhpcy5fZ2Z4RGV2aWNlLCB0aGlzLl9zYW1wbGVySGFzaCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5riy5p+T5pe25piv5ZCm6L+Q6KGM5bCG5q2k6LS05Zu+6L+b6KGM57+76L2s44CCXHJcbiAgICAgKiBAcGFyYW0gZmxpcFkg57+76L2s5YiZ5Li6IGB0cnVlYO+8jOWQpuWImeS4uiBgZmFsc2Vg44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRGbGlwWSAoZmxpcFk6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLl9mbGlwWSA9IGZsaXBZO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5q2k6LS05Zu+5piv5ZCm6aKE5LmY6YCP5piO6YCa6YGT44CCXHJcbiAgICAgKiBAcGFyYW0gcHJlbXVsdGlwbHlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFByZW11bHRpcGx5QWxwaGEgKHByZW11bHRpcGx5OiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5fcHJlbXVsdGlwbHlBbHBoYSA9IHByZW11bHRpcGx5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5q2k6LS05Zu+55qE5ZCE5ZCR5byC5oCn44CCXHJcbiAgICAgKiBAcGFyYW0gYW5pc290cm9weSDlkITlkJHlvILmgKfjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldEFuaXNvdHJvcHkgKGFuaXNvdHJvcHk6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX2FuaXNvdHJvcHkgPSBhbmlzb3Ryb3B5O1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJJbmZvW1NhbXBsZXJJbmZvSW5kZXgubWF4QW5pc290cm9weV0gPSBhbmlzb3Ryb3B5O1xyXG4gICAgICAgIHRoaXMuX3NhbXBsZXJIYXNoID0gZ2VuU2FtcGxlckhhc2godGhpcy5fc2FtcGxlckluZm8pO1xyXG4gICAgICAgIGlmICh0aGlzLl9nZnhEZXZpY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2Z4U2FtcGxlciA9IHNhbXBsZXJMaWIuZ2V0U2FtcGxlcih0aGlzLl9nZnhEZXZpY2UsIHRoaXMuX3NhbXBsZXJIYXNoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDplIDmr4HmraTotLTlm77vvIzlubbph4rmlL7ljaDmnInnmoTmiYDmnIkgR1BVIOi1hOa6kOOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZGVzdHJveSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRlc3Ryb3koKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluatpOi0tOWbvuW6leWxgueahCBHRlgg6LS05Zu+6KeG5Zu+5a+56LGh44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRHRlhUZXh0dXJlVmlldyAoKTogR0ZYVGV4dHVyZVZpZXcgfCBudWxsIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluatpOi0tOWbvuWGhemDqOS9v+eUqOeahCBHRlgg6YeH5qC35Zmo5L+h5oGv44CCXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2FtcGxlckhhc2ggKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zYW1wbGVySGFzaDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluatpOi0tOWbvuW6leWxgueahCBHRlgg6YeH5qC35L+h5oGv44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRHRlhTYW1wbGVyICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2dmeFNhbXBsZXIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2dmeERldmljZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZ2Z4U2FtcGxlciA9IHNhbXBsZXJMaWIuZ2V0U2FtcGxlcih0aGlzLl9nZnhEZXZpY2UsIHRoaXMuX3NhbXBsZXJIYXNoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNjLmVycm9ySUQoOTMwMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dmeFNhbXBsZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU0VSSUFMSVpBVElPTlxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHJldHVyblxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgX3NlcmlhbGl6ZSAoZXhwb3J0aW5nPzogYW55KTogYW55IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWluRmlsdGVyICsgJywnICsgdGhpcy5fbWFnRmlsdGVyICsgJywnICtcclxuICAgICAgICAgICAgdGhpcy5fd3JhcFMgKyAnLCcgKyB0aGlzLl93cmFwVCArICcsJyArXHJcbiAgICAgICAgICAgICh0aGlzLl9wcmVtdWx0aXBseUFscGhhID8gMSA6IDApICsgJywnICtcclxuICAgICAgICAgICAgdGhpcy5fbWlwRmlsdGVyICsgJywnICsgdGhpcy5fYW5pc290cm9weSArICcsJyArXHJcbiAgICAgICAgICAgICh0aGlzLl9mbGlwWSA/IDEgOiAwKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZGF0YVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgX2Rlc2VyaWFsaXplIChzZXJpYWxpemVkRGF0YTogYW55LCBoYW5kbGU6IGFueSkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBzZXJpYWxpemVkRGF0YSBhcyBzdHJpbmc7XHJcbiAgICAgICAgY29uc3QgZmllbGRzID0gZGF0YS5zcGxpdCgnLCcpO1xyXG4gICAgICAgIGZpZWxkcy51bnNoaWZ0KCcnKTtcclxuICAgICAgICBpZiAoZmllbGRzLmxlbmd0aCA+PSA2KSB7XHJcbiAgICAgICAgICAgIC8vIGRlY29kZSBmaWx0ZXJzXHJcbiAgICAgICAgICAgIHRoaXMuc2V0RmlsdGVycyhwYXJzZUludChmaWVsZHNbMV0pLCBwYXJzZUludChmaWVsZHNbMl0pKTtcclxuICAgICAgICAgICAgLy8gZGVjb2RlIHdyYXBzXHJcbiAgICAgICAgICAgIHRoaXMuc2V0V3JhcE1vZGUocGFyc2VJbnQoZmllbGRzWzNdKSwgcGFyc2VJbnQoZmllbGRzWzRdKSk7XHJcbiAgICAgICAgICAgIC8vIGRlY29kZSBwcmVtdWx0aXBseSBhbHBoYVxyXG4gICAgICAgICAgICB0aGlzLl9wcmVtdWx0aXBseUFscGhhID0gZmllbGRzWzVdLmNoYXJDb2RlQXQoMCkgPT09IENIQVJfQ09ERV8xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmllbGRzLmxlbmd0aCA+PSA4KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0TWlwRmlsdGVyKHBhcnNlSW50KGZpZWxkc1s2XSkpO1xyXG4gICAgICAgICAgICB0aGlzLnNldEFuaXNvdHJvcHkocGFyc2VJbnQoZmllbGRzWzddKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID49IDkpIHtcclxuICAgICAgICAgICAgdGhpcy5fZmxpcFkgPSBmaWVsZHNbOF0uY2hhckNvZGVBdCgwKSA9PT0gQ0hBUl9DT0RFXzE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfZ2V0R0ZYRGV2aWNlICgpOiBHRlhEZXZpY2UgfCBudWxsIHtcclxuICAgICAgICByZXR1cm4gY2MuZGlyZWN0b3Iucm9vdCAmJiBjYy5kaXJlY3Rvci5yb290LmRldmljZTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2dldEdGWEZvcm1hdCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdDtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX3NldEdGWEZvcm1hdCAoZm9ybWF0PzogUGl4ZWxGb3JtYXQpIHtcclxuICAgICAgICB0aGlzLl9mb3JtYXQgPSBmb3JtYXQgPT09IHVuZGVmaW5lZCA/IFBpeGVsRm9ybWF0LlJHQkE4ODg4IDogZm9ybWF0O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgbmFtZXNwYWNlIFRleHR1cmVCYXNlIHtcclxuICAgIGV4cG9ydCB0eXBlIFBpeGVsRm9ybWF0ID0gRW51bUFsaWFzPHR5cGVvZiBQaXhlbEZvcm1hdD47XHJcbiAgICBleHBvcnQgdHlwZSBXcmFwTW9kZSA9IEVudW1BbGlhczx0eXBlb2YgV3JhcE1vZGU+O1xyXG4gICAgZXhwb3J0IHR5cGUgRmlsdGVyID0gRW51bUFsaWFzPHR5cGVvZiBGaWx0ZXI+O1xyXG59XHJcblxyXG5jYy5UZXh0dXJlQmFzZSA9IFRleHR1cmVCYXNlO1xyXG4iXX0=