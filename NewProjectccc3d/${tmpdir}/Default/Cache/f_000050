(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./tween-system.js", "../core/index.js", "./actions/action-interval.js", "./actions/action-instant.js", "./actions/action.js", "./tween-action.js", "./set-action.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./tween-system.js"), require("../core/index.js"), require("./actions/action-interval.js"), require("./actions/action-instant.js"), require("./actions/action.js"), require("./tween-action.js"), require("./set-action.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.tweenSystem, global.index, global.actionInterval, global.actionInstant, global.action, global.tweenAction, global.setAction);
    global.tween = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _tweenSystem, _index, _actionInterval, _actionInstant, _action, _tweenAction, _setAction) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.tween = tween;
  _exports.tweenUtil = tweenUtil;
  _exports.Tween = void 0;

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  /**
   * @en
   * Tween provide a simple and flexible way to action, It's transplanted from cocos creator。
   * @zh
   * Tween 提供了一个简单灵活的方法来缓动目标，从 creator 移植而来。
   * @class Tween
   * @param {Object} [target]
   * @example
   * tween(this.node)
   *   .to(1, {scale: new Vec3(2, 2, 2), position: new Vec3(5, 5, 5)})
   *   .call(() => { console.log('This is a callback'); })
   *   .by(1, {scale: new Vec3(-1, -1, -1), position: new Vec3(-5, -5, -5)}, {easing: 'sineOutIn'})
   *   .start()
   */
  var Tween = /*#__PURE__*/function () {
    function Tween(target) {
      _classCallCheck(this, Tween);

      this._actions = [];
      this._finalAction = null;
      this._target = null;
      this._target = target === undefined ? null : target;

      if (this._target && this._target instanceof _index.Node) {
        this._target.on(_index.SystemEventType.NODE_DESTROYED, this._destroy, this);
      }
    }
    /**
     * @en
     * Insert an action or tween to this sequence.
     * @zh
     * 插入一个 tween 到队列中。
     * @method then 
     * @param {Tween} other
     * @return {Tween}
     */


    _createClass(Tween, [{
      key: "then",
      value: function then(other) {
        if (other instanceof _action.Action) {
          this._actions.push(other.clone());
        } else {
          this._actions.push(other._union());
        }

        return this;
      }
      /**
       * @en
       * Sets tween target.
       * @zh
       * 设置 tween 的 target。
       * @method target
       * @param {Object} target
       * @return {Tween}
       */

    }, {
      key: "target",
      value: function target(_target) {
        if (this._target && this._target instanceof _index.Node) {
          this._target.off(_index.SystemEventType.NODE_DESTROYED, this._destroy, this);
        }

        this._target = _target;

        if (this._target && this._target instanceof _index.Node) {
          this._target.on(_index.SystemEventType.NODE_DESTROYED, this._destroy, this);
        }

        return this;
      }
      /**
       * @en
       * Start this tween.
       * @zh
       * 运行当前 tween。
       * @method start
       * @return {Tween}
       */

    }, {
      key: "start",
      value: function start() {
        if (!this._target) {
          (0, _index.warn)('Please set target to tween first');
          return this;
        }

        if (this._finalAction) {
          _tweenSystem.TweenSystem.instance.ActionManager.removeAction(this._finalAction);
        }

        this._finalAction = this._union();

        _tweenSystem.TweenSystem.instance.ActionManager.addAction(this._finalAction, this._target, false);

        return this;
      }
      /**
       * @en
       * Stop this tween.
       * @zh
       * 停止当前 tween。
       * @method stop
       * @return {Tween}
       */

    }, {
      key: "stop",
      value: function stop() {
        if (this._finalAction) {
          _tweenSystem.TweenSystem.instance.ActionManager.removeAction(this._finalAction);
        }

        return this;
      }
      /**
       * @en
       * Clone a tween.
       * @zh
       * 克隆当前 tween。
       * @method clone
       * @param {Object} [target]
       * @return {Tween}
       */

    }, {
      key: "clone",
      value: function clone(target) {
        var action = this._union();

        return tween(target).then(action.clone());
      }
      /**
       * @en
       * Integrate all previous actions to an action.
       * @zh
       * 将之前所有的 action 整合为一个 action。
       * @method union
       * @return {Tween}
       */

    }, {
      key: "union",
      value: function union() {
        var action = this._union();

        this._actions.length = 0;

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an action which calculate with absolute value.
       * @zh
       * 添加一个对属性进行绝对值计算的 action。
       * @method to
       * @param {number} duration 缓动时间，单位为秒
       * @param {Object} props 缓动的属性列表
       * @param {Object} [opts] 可选的缓动功能
       * @param {Function} [opts.progress]
       * @param {Function|String} [opts.easing]
       * @return {Tween}
       */

    }, {
      key: "to",
      value: function to(duration, props, opts) {
        opts = opts || Object.create(null);
        opts.relative = false;
        var action = new _tweenAction.TweenAction(duration, props, opts);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an action which calculate with relative value.
       * @zh
       * 添加一个对属性进行相对值计算的 action。
       * @method by
       * @param {number} duration 缓动时间，单位为秒
       * @param {Object} props 缓动的属性列表
       * @param {Object} [opts] 可选的缓动功能
       * @param {Function} [opts.progress]
       * @param {Function|String} [opts.easing]
       * @return {Tween}
       */

    }, {
      key: "by",
      value: function by(duration, props, opts) {
        opts = opts || Object.create(null);
        opts.relative = true;
        var action = new _tweenAction.TweenAction(duration, props, opts);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Directly set target properties.
       * @zh
       * 直接设置 target 的属性。
       * @method set
       * @param {Object} props
       * @return {Tween}
       */

    }, {
      key: "set",
      value: function set(props) {
        var action = new _setAction.SetAction(props);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an delay action.
       * @zh
       * 添加一个延时 action。
       * @method delay
       * @param {number} duration 
       * @return {Tween}
       */

    }, {
      key: "delay",
      value: function delay(duration) {
        var action = (0, _actionInterval.delayTime)(duration);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an callback action.
       * @zh
       * 添加一个回调 action。
       * @method call
       * @param {Function} callback
       * @return {Tween}
       */

    }, {
      key: "call",
      value: function call(callback) {
        var action = (0, _actionInstant.callFunc)(callback);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an sequence action.
       * @zh
       * 添加一个队列 action。
       * @method sequence
       * @param {Tween} action
       * @param {Tween} ...actions
       * @return {Tween}
       */

    }, {
      key: "sequence",
      value: function sequence() {
        var action = Tween._wrappedSequence.apply(Tween, arguments);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an parallel action.
       * @zh
       * 添加一个并行 action。
       * @method parallel
       * @param {Tween} action
       * @param {Tween} ...actions
       * @return {Tween}
       */

    }, {
      key: "parallel",
      value: function parallel() {
        var action = Tween._wrappedParallel.apply(Tween, arguments);

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an repeat action.
       * This action will integrate before actions to a sequence action as their parameters.
       * @zh
       * 添加一个重复 action，这个 action 会将前一个动作作为他的参数。
       * @method repeat
       * @param {number} repeatTimes 重复次数
       * @param {Tween} embedTween 可选，嵌入 Tween
       * @return {Tween}
       */

    }, {
      key: "repeat",
      value: function repeat(repeatTimes, embedTween) {
        /** adapter */
        if (repeatTimes == Infinity) {
          return this.repeatForever(embedTween);
        }

        var actions = this._actions;
        var action;

        if (embedTween instanceof Tween) {
          action = embedTween._union();
        } else {
          action = actions.pop();
        }

        actions.push((0, _actionInterval.repeat)(action, repeatTimes));
        return this;
      }
      /**
       * @en
       * Add an repeat forever action.
       * This action will integrate before actions to a sequence action as their parameters.
       * @zh
       * 添加一个永久重复 action，这个 action 会将前一个动作作为他的参数。
       * @method repeatForever
       * @param {Tween} embedTween 可选，嵌入 Tween
       * @return {Tween}
       */

    }, {
      key: "repeatForever",
      value: function repeatForever(embedTween) {
        var actions = this._actions;
        var action;

        if (embedTween instanceof Tween) {
          action = embedTween._union();
        } else {
          action = actions.pop();
        }

        actions.push((0, _actionInterval.repeatForever)(action));
        return this;
      }
      /**
       * @en
       * Add an reverse time action.
       * This action will integrate before actions to a sequence action as their parameters.
       * @zh
       * 添加一个倒置时间 action，这个 action 会将前一个动作作为他的参数。
       * @method reverseTime
       * @param {Tween} embedTween 可选，嵌入 Tween
       * @return {Tween}
       */

    }, {
      key: "reverseTime",
      value: function reverseTime(embedTween) {
        var actions = this._actions;
        var action;

        if (embedTween instanceof Tween) {
          action = embedTween._union();
        } else {
          action = actions.pop();
        }

        actions.push((0, _actionInterval.reverseTime)(action));
        return this;
      }
      /**
       * @en
       * Add an hide action, only for node target.
       * @zh
       * 添加一个隐藏 action，只适用于 target 是节点类型的。
       * @method hide
       * @return {Tween}
       */

    }, {
      key: "hide",
      value: function hide() {
        var action = (0, _actionInstant.hide)();

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an show action, only for node target.
       * @zh
       * 添加一个显示 action，只适用于 target 是节点类型的。
       * @method show
       * @return {Tween}
       */

    }, {
      key: "show",
      value: function show() {
        var action = (0, _actionInstant.show)();

        this._actions.push(action);

        return this;
      }
      /**
       * @en
       * Add an removeSelf action, only for node target.
       * @zh
       * 添加一个移除自己 action，只适用于 target 是节点类型的。
       * @method removeSelf
       * @return {Tween}
       */

    }, {
      key: "removeSelf",
      value: function removeSelf() {
        var action = (0, _actionInstant.removeSelf)(false);

        this._actions.push(action);

        return this;
      }
    }, {
      key: "_union",
      value: function _union() {
        var actions = this._actions;
        var action;

        if (actions.length === 1) {
          action = actions[0];
        } else {
          action = (0, _actionInterval.sequence)(actions);
        }

        return action;
      }
    }, {
      key: "_destroy",
      value: function _destroy() {
        this.stop();
      }
    }], [{
      key: "_wrappedSequence",
      value: function _wrappedSequence() {
        var tmp_args = Tween._tmp_args;
        tmp_args.length = 0;

        for (var l = arguments.length, i = 0; i < l; i++) {
          var arg = tmp_args[i] = i < 0 || arguments.length <= i ? undefined : arguments[i];

          if (arg instanceof Tween) {
            tmp_args[i] = arg._union();
          }
        }

        return _actionInterval.sequence.apply(_actionInterval.sequence, tmp_args);
      }
    }, {
      key: "_wrappedParallel",
      value: function _wrappedParallel() {
        var tmp_args = Tween._tmp_args;
        tmp_args.length = 0;

        for (var l = arguments.length, i = 0; i < l; i++) {
          var arg = tmp_args[i] = i < 0 || arguments.length <= i ? undefined : arguments[i];

          if (arg instanceof Tween) {
            tmp_args[i] = arg._union();
          }
        }

        return _actionInterval.spawn.apply(_actionInterval.spawn, tmp_args);
      }
    }]);

    return Tween;
  }();

  _exports.Tween = Tween;
  Tween._tmp_args = [];
  cc.Tween = Tween;
  /**
   * @en
   * tween is a utility function that helps instantiate Tween instances.
   * @zh
   * tween 是一个工具函数，帮助实例化 Tween 实例。
   * @param target 缓动的目标
   * @returns Tween 实例
   * @example
   * tween(this.node)
   *   .to(1, {scale: new Vec3(2, 2, 2), position: new Vec3(5, 5, 5)})
   *   .call(() => { console.log('This is a callback'); })
   *   .by(1, {scale: new Vec3(-1, -1, -1)}, {easing: 'sineOutIn'})
   *   .start()
   */

  function tween(target) {
    return new Tween(target);
  }

  cc.tween = tween;
  /**
   * @en
   * tweenUtil is a utility function that helps instantiate Tween instances.
   * @zh
   * tweenUtil 是一个工具函数，帮助实例化 Tween 实例。
   * @deprecated please use `tween` instead.
   */

  function tweenUtil(target) {
    (0, _index.warn)("tweenUtil' is deprecated, please use 'tween' instead ");
    return new Tween(target);
  }

  cc.tweenUtil = tweenUtil;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvdHdlZW4vdHdlZW4udHMiXSwibmFtZXMiOlsiVHdlZW4iLCJ0YXJnZXQiLCJfYWN0aW9ucyIsIl9maW5hbEFjdGlvbiIsIl90YXJnZXQiLCJ1bmRlZmluZWQiLCJOb2RlIiwib24iLCJTeXN0ZW1FdmVudFR5cGUiLCJOT0RFX0RFU1RST1lFRCIsIl9kZXN0cm95Iiwib3RoZXIiLCJBY3Rpb24iLCJwdXNoIiwiY2xvbmUiLCJfdW5pb24iLCJvZmYiLCJUd2VlblN5c3RlbSIsImluc3RhbmNlIiwiQWN0aW9uTWFuYWdlciIsInJlbW92ZUFjdGlvbiIsImFkZEFjdGlvbiIsImFjdGlvbiIsInR3ZWVuIiwidGhlbiIsImxlbmd0aCIsImR1cmF0aW9uIiwicHJvcHMiLCJvcHRzIiwiT2JqZWN0IiwiY3JlYXRlIiwicmVsYXRpdmUiLCJUd2VlbkFjdGlvbiIsIlNldEFjdGlvbiIsImNhbGxiYWNrIiwiX3dyYXBwZWRTZXF1ZW5jZSIsIl93cmFwcGVkUGFyYWxsZWwiLCJyZXBlYXRUaW1lcyIsImVtYmVkVHdlZW4iLCJJbmZpbml0eSIsInJlcGVhdEZvcmV2ZXIiLCJhY3Rpb25zIiwicG9wIiwic3RvcCIsInRtcF9hcmdzIiwiX3RtcF9hcmdzIiwibCIsImkiLCJhcmciLCJzZXF1ZW5jZSIsImFwcGx5Iiwic3Bhd24iLCJjYyIsInR3ZWVuVXRpbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWFBOzs7Ozs7Ozs7Ozs7OztNQWNhQSxLO0FBTVQsbUJBQWFDLE1BQWIsRUFBcUM7QUFBQTs7QUFBQSxXQUo3QkMsUUFJNkIsR0FKUixFQUlRO0FBQUEsV0FIN0JDLFlBRzZCLEdBSEMsSUFHRDtBQUFBLFdBRjdCQyxPQUU2QixHQUZKLElBRUk7QUFDakMsV0FBS0EsT0FBTCxHQUFlSCxNQUFNLEtBQUtJLFNBQVgsR0FB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bUJQLFFBQW5CLENBQVA7QUFDSDs7Ozs7OztBQWpaUTVDLEVBQUFBLEssQ0F1WGU2QyxTLEdBQWdDLEU7QUE0QjVETyxFQUFBQSxFQUFFLENBQUNwRCxLQUFILEdBQVdBLEtBQVg7QUFHQTs7Ozs7Ozs7Ozs7Ozs7O0FBY08sV0FBU3VCLEtBQVQsQ0FBZ0J0QixNQUFoQixFQUFpQztBQUNwQyxXQUFPLElBQUlELEtBQUosQ0FBVUMsTUFBVixDQUFQO0FBQ0g7O0FBQ0RtRCxFQUFBQSxFQUFFLENBQUM3QixLQUFILEdBQVdBLEtBQVg7QUFFQTs7Ozs7Ozs7QUFPTyxXQUFTOEIsU0FBVCxDQUFvQnBELE1BQXBCLEVBQXFDO0FBQ3hDLHFCQUFLLHVEQUFMO0FBQ0EsV0FBTyxJQUFJRCxLQUFKLENBQVVDLE1BQVYsQ0FBUDtBQUNIOztBQUNEbUQsRUFBQUEsRUFBRSxDQUFDQyxTQUFILEdBQWVBLFNBQWYiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGNhdGVnb3J5IHR3ZWVuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgVHdlZW5TeXN0ZW0gfSBmcm9tICcuL3R3ZWVuLXN5c3RlbSc7XHJcbmltcG9ydCB7IHdhcm4sIE5vZGUsIFN5c3RlbUV2ZW50VHlwZSB9IGZyb20gJy4uL2NvcmUnO1xyXG5pbXBvcnQgeyBBY3Rpb25JbnRlcnZhbCwgc2VxdWVuY2UsIHJlcGVhdCwgcmVwZWF0Rm9yZXZlciwgcmV2ZXJzZVRpbWUsIGRlbGF5VGltZSwgc3Bhd24gfSBmcm9tICcuL2FjdGlvbnMvYWN0aW9uLWludGVydmFsJztcclxuaW1wb3J0IHsgcmVtb3ZlU2VsZiwgc2hvdywgaGlkZSwgY2FsbEZ1bmMgfSBmcm9tICcuL2FjdGlvbnMvYWN0aW9uLWluc3RhbnQnO1xyXG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL2FjdGlvbnMvYWN0aW9uJztcclxuaW1wb3J0IHsgSVR3ZWVuT3B0aW9uIH0gZnJvbSAnLi9leHBvcnQtYXBpJztcclxuaW1wb3J0IHsgVHdlZW5BY3Rpb24gfSBmcm9tICcuL3R3ZWVuLWFjdGlvbic7XHJcbmltcG9ydCB7IFNldEFjdGlvbiB9IGZyb20gJy4vc2V0LWFjdGlvbic7XHJcblxyXG4vKipcclxuICogQGVuXHJcbiAqIFR3ZWVuIHByb3ZpZGUgYSBzaW1wbGUgYW5kIGZsZXhpYmxlIHdheSB0byBhY3Rpb24sIEl0J3MgdHJhbnNwbGFudGVkIGZyb20gY29jb3MgY3JlYXRvcuOAglxyXG4gKiBAemhcclxuICogVHdlZW4g5o+Q5L6b5LqG5LiA5Liq566A5Y2V54G15rS755qE5pa55rOV5p2l57yT5Yqo55uu5qCH77yM5LuOIGNyZWF0b3Ig56e75qSN6ICM5p2l44CCXHJcbiAqIEBjbGFzcyBUd2VlblxyXG4gKiBAcGFyYW0ge09iamVjdH0gW3RhcmdldF1cclxuICogQGV4YW1wbGVcclxuICogdHdlZW4odGhpcy5ub2RlKVxyXG4gKiAgIC50bygxLCB7c2NhbGU6IG5ldyBWZWMzKDIsIDIsIDIpLCBwb3NpdGlvbjogbmV3IFZlYzMoNSwgNSwgNSl9KVxyXG4gKiAgIC5jYWxsKCgpID0+IHsgY29uc29sZS5sb2coJ1RoaXMgaXMgYSBjYWxsYmFjaycpOyB9KVxyXG4gKiAgIC5ieSgxLCB7c2NhbGU6IG5ldyBWZWMzKC0xLCAtMSwgLTEpLCBwb3NpdGlvbjogbmV3IFZlYzMoLTUsIC01LCAtNSl9LCB7ZWFzaW5nOiAnc2luZU91dEluJ30pXHJcbiAqICAgLnN0YXJ0KClcclxuICovXHJcbmV4cG9ydCBjbGFzcyBUd2VlbiB7XHJcblxyXG4gICAgcHJpdmF0ZSBfYWN0aW9uczogQWN0aW9uW10gPSBbXTtcclxuICAgIHByaXZhdGUgX2ZpbmFsQWN0aW9uOiBBY3Rpb24gfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgX3RhcmdldDogb2JqZWN0IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKHRhcmdldD86IG9iamVjdCB8IG51bGwpIHtcclxuICAgICAgICB0aGlzLl90YXJnZXQgPSB0YXJnZXQgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB0YXJnZXQ7XHJcbiAgICAgICAgaWYgKHRoaXMuX3RhcmdldCAmJiB0aGlzLl90YXJnZXQgaW5zdGFuY2VvZiBOb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RhcmdldC5vbihTeXN0ZW1FdmVudFR5cGUuTk9ERV9ERVNUUk9ZRUQsIHRoaXMuX2Rlc3Ryb3ksIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogSW5zZXJ0IGFuIGFjdGlvbiBvciB0d2VlbiB0byB0aGlzIHNlcXVlbmNlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmj5LlhaXkuIDkuKogdHdlZW4g5Yiw6Zif5YiX5Lit44CCXHJcbiAgICAgKiBAbWV0aG9kIHRoZW4gXHJcbiAgICAgKiBAcGFyYW0ge1R3ZWVufSBvdGhlclxyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHRoZW4gKG90aGVyOiBUd2Vlbik6IFR3ZWVuIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBBY3Rpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKG90aGVyLmNsb25lKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKG90aGVyLl91bmlvbigpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFNldHMgdHdlZW4gdGFyZ2V0LlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDorr7nva4gdHdlZW4g55qEIHRhcmdldOOAglxyXG4gICAgICogQG1ldGhvZCB0YXJnZXRcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0YXJnZXRcclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICB0YXJnZXQgKHRhcmdldDogb2JqZWN0IHwgbnVsbCk6IFR3ZWVuIHtcclxuICAgICAgICBpZiAodGhpcy5fdGFyZ2V0ICYmIHRoaXMuX3RhcmdldCBpbnN0YW5jZW9mIE5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGFyZ2V0Lm9mZihTeXN0ZW1FdmVudFR5cGUuTk9ERV9ERVNUUk9ZRUQsIHRoaXMuX2Rlc3Ryb3ksIHRoaXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fdGFyZ2V0ICYmIHRoaXMuX3RhcmdldCBpbnN0YW5jZW9mIE5vZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fdGFyZ2V0Lm9uKFN5c3RlbUV2ZW50VHlwZS5OT0RFX0RFU1RST1lFRCwgdGhpcy5fZGVzdHJveSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTdGFydCB0aGlzIHR3ZWVuLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDov5DooYzlvZPliY0gdHdlZW7jgIJcclxuICAgICAqIEBtZXRob2Qgc3RhcnRcclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICBzdGFydCAoKTogVHdlZW4ge1xyXG4gICAgICAgIGlmICghdGhpcy5fdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHdhcm4oJ1BsZWFzZSBzZXQgdGFyZ2V0IHRvIHR3ZWVuIGZpcnN0Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fZmluYWxBY3Rpb24pIHtcclxuICAgICAgICAgICAgVHdlZW5TeXN0ZW0uaW5zdGFuY2UuQWN0aW9uTWFuYWdlci5yZW1vdmVBY3Rpb24odGhpcy5fZmluYWxBY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9maW5hbEFjdGlvbiA9IHRoaXMuX3VuaW9uKCk7XHJcbiAgICAgICAgVHdlZW5TeXN0ZW0uaW5zdGFuY2UuQWN0aW9uTWFuYWdlci5hZGRBY3Rpb24odGhpcy5fZmluYWxBY3Rpb24sIHRoaXMuX3RhcmdldCBhcyBhbnksIGZhbHNlKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogU3RvcCB0aGlzIHR3ZWVuLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDlgZzmraLlvZPliY0gdHdlZW7jgIJcclxuICAgICAqIEBtZXRob2Qgc3RvcFxyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHN0b3AgKCk6IFR3ZWVuIHtcclxuICAgICAgICBpZiAodGhpcy5fZmluYWxBY3Rpb24pIHtcclxuICAgICAgICAgICAgVHdlZW5TeXN0ZW0uaW5zdGFuY2UuQWN0aW9uTWFuYWdlci5yZW1vdmVBY3Rpb24odGhpcy5fZmluYWxBY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQ2xvbmUgYSB0d2Vlbi5cclxuICAgICAqIEB6aFxyXG4gICAgICog5YWL6ZqG5b2T5YmNIHR3ZWVu44CCXHJcbiAgICAgKiBAbWV0aG9kIGNsb25lXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW3RhcmdldF1cclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICBjbG9uZSAodGFyZ2V0OiBvYmplY3QpOiBUd2VlbiB7XHJcbiAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMuX3VuaW9uKCk7XHJcbiAgICAgICAgcmV0dXJuIHR3ZWVuKHRhcmdldCkudGhlbihhY3Rpb24uY2xvbmUoKSBhcyBhbnkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBJbnRlZ3JhdGUgYWxsIHByZXZpb3VzIGFjdGlvbnMgdG8gYW4gYWN0aW9uLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDlsIbkuYvliY3miYDmnInnmoQgYWN0aW9uIOaVtOWQiOS4uuS4gOS4qiBhY3Rpb27jgIJcclxuICAgICAqIEBtZXRob2QgdW5pb25cclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICB1bmlvbiAoKTogVHdlZW4ge1xyXG4gICAgICAgIGxldCBhY3Rpb24gPSB0aGlzLl91bmlvbigpO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbnMubGVuZ3RoID0gMDtcclxuICAgICAgICB0aGlzLl9hY3Rpb25zLnB1c2goYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQWRkIGFuIGFjdGlvbiB3aGljaCBjYWxjdWxhdGUgd2l0aCBhYnNvbHV0ZSB2YWx1ZS5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5LiA5Liq5a+55bGe5oCn6L+b6KGM57ud5a+55YC86K6h566X55qEIGFjdGlvbuOAglxyXG4gICAgICogQG1ldGhvZCB0b1xyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIOe8k+WKqOaXtumXtO+8jOWNleS9jeS4uuenklxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzIOe8k+WKqOeahOWxnuaAp+WIl+ihqFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRzXSDlj6/pgInnmoTnvJPliqjlip/og71cclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvcHRzLnByb2dyZXNzXVxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IFtvcHRzLmVhc2luZ11cclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICB0byAoZHVyYXRpb246IG51bWJlciwgcHJvcHM6IG9iamVjdCwgb3B0cz86IElUd2Vlbk9wdGlvbik6IFR3ZWVuIHtcclxuICAgICAgICBvcHRzID0gb3B0cyB8fCBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIChvcHRzIGFzIGFueSkucmVsYXRpdmUgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBhY3Rpb24gPSBuZXcgVHdlZW5BY3Rpb24oZHVyYXRpb24sIHByb3BzLCBvcHRzKTtcclxuICAgICAgICB0aGlzLl9hY3Rpb25zLnB1c2goYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQWRkIGFuIGFjdGlvbiB3aGljaCBjYWxjdWxhdGUgd2l0aCByZWxhdGl2ZSB2YWx1ZS5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5LiA5Liq5a+55bGe5oCn6L+b6KGM55u45a+55YC86K6h566X55qEIGFjdGlvbuOAglxyXG4gICAgICogQG1ldGhvZCBieVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIOe8k+WKqOaXtumXtO+8jOWNleS9jeS4uuenklxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzIOe8k+WKqOeahOWxnuaAp+WIl+ihqFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRzXSDlj6/pgInnmoTnvJPliqjlip/og71cclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvcHRzLnByb2dyZXNzXVxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IFtvcHRzLmVhc2luZ11cclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICBieSAoZHVyYXRpb246IG51bWJlciwgcHJvcHM6IG9iamVjdCwgb3B0cz86IElUd2Vlbk9wdGlvbik6IFR3ZWVuIHtcclxuICAgICAgICBvcHRzID0gb3B0cyB8fCBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIChvcHRzIGFzIGFueSkucmVsYXRpdmUgPSB0cnVlO1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBUd2VlbkFjdGlvbihkdXJhdGlvbiwgcHJvcHMsIG9wdHMpO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBEaXJlY3RseSBzZXQgdGFyZ2V0IHByb3BlcnRpZXMuXHJcbiAgICAgKiBAemhcclxuICAgICAqIOebtOaOpeiuvue9riB0YXJnZXQg55qE5bGe5oCn44CCXHJcbiAgICAgKiBAbWV0aG9kIHNldFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHByb3BzXHJcbiAgICAgKiBAcmV0dXJuIHtUd2Vlbn1cclxuICAgICAqL1xyXG4gICAgc2V0IChwcm9wczogb2JqZWN0KTogVHdlZW4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBTZXRBY3Rpb24ocHJvcHMpO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBZGQgYW4gZGVsYXkgYWN0aW9uLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmt7vliqDkuIDkuKrlu7bml7YgYWN0aW9u44CCXHJcbiAgICAgKiBAbWV0aG9kIGRlbGF5XHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24gXHJcbiAgICAgKiBAcmV0dXJuIHtUd2Vlbn1cclxuICAgICAqL1xyXG4gICAgZGVsYXkgKGR1cmF0aW9uOiBudW1iZXIpOiBUd2VlbiB7XHJcbiAgICAgICAgY29uc3QgYWN0aW9uID0gZGVsYXlUaW1lKGR1cmF0aW9uKTtcclxuICAgICAgICB0aGlzLl9hY3Rpb25zLnB1c2goYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQWRkIGFuIGNhbGxiYWNrIGFjdGlvbi5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5LiA5Liq5Zue6LCDIGFjdGlvbuOAglxyXG4gICAgICogQG1ldGhvZCBjYWxsXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIGNhbGwgKGNhbGxiYWNrOiBGdW5jdGlvbik6IFR3ZWVuIHtcclxuICAgICAgICBjb25zdCBhY3Rpb24gPSBjYWxsRnVuYyhjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEFkZCBhbiBzZXF1ZW5jZSBhY3Rpb24uXHJcbiAgICAgKiBAemhcclxuICAgICAqIOa3u+WKoOS4gOS4qumYn+WIlyBhY3Rpb27jgIJcclxuICAgICAqIEBtZXRob2Qgc2VxdWVuY2VcclxuICAgICAqIEBwYXJhbSB7VHdlZW59IGFjdGlvblxyXG4gICAgICogQHBhcmFtIHtUd2Vlbn0gLi4uYWN0aW9uc1xyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHNlcXVlbmNlICguLi5hcmdzOiBUd2VlbltdKTogVHdlZW4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IFR3ZWVuLl93cmFwcGVkU2VxdWVuY2UoLi4uYXJncyk7XHJcbiAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEFkZCBhbiBwYXJhbGxlbCBhY3Rpb24uXHJcbiAgICAgKiBAemhcclxuICAgICAqIOa3u+WKoOS4gOS4quW5tuihjCBhY3Rpb27jgIJcclxuICAgICAqIEBtZXRob2QgcGFyYWxsZWxcclxuICAgICAqIEBwYXJhbSB7VHdlZW59IGFjdGlvblxyXG4gICAgICogQHBhcmFtIHtUd2Vlbn0gLi4uYWN0aW9uc1xyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHBhcmFsbGVsICguLi5hcmdzOiBUd2VlbltdKTogVHdlZW4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IFR3ZWVuLl93cmFwcGVkUGFyYWxsZWwoLi4uYXJncyk7XHJcbiAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEFkZCBhbiByZXBlYXQgYWN0aW9uLlxyXG4gICAgICogVGhpcyBhY3Rpb24gd2lsbCBpbnRlZ3JhdGUgYmVmb3JlIGFjdGlvbnMgdG8gYSBzZXF1ZW5jZSBhY3Rpb24gYXMgdGhlaXIgcGFyYW1ldGVycy5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5LiA5Liq6YeN5aSNIGFjdGlvbu+8jOi/meS4qiBhY3Rpb24g5Lya5bCG5YmN5LiA5Liq5Yqo5L2c5L2c5Li65LuW55qE5Y+C5pWw44CCXHJcbiAgICAgKiBAbWV0aG9kIHJlcGVhdFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJlcGVhdFRpbWVzIOmHjeWkjeasoeaVsFxyXG4gICAgICogQHBhcmFtIHtUd2Vlbn0gZW1iZWRUd2VlbiDlj6/pgInvvIzltYzlhaUgVHdlZW5cclxuICAgICAqIEByZXR1cm4ge1R3ZWVufVxyXG4gICAgICovXHJcbiAgICByZXBlYXQgKHJlcGVhdFRpbWVzOiBudW1iZXIsIGVtYmVkVHdlZW4/OiBUd2Vlbik6IFR3ZWVuIHtcclxuICAgICAgICAvKiogYWRhcHRlciAqL1xyXG4gICAgICAgIGlmIChyZXBlYXRUaW1lcyA9PSBJbmZpbml0eSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBlYXRGb3JldmVyKGVtYmVkVHdlZW4pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuX2FjdGlvbnM7XHJcbiAgICAgICAgbGV0IGFjdGlvbjogYW55O1xyXG5cclxuICAgICAgICBpZiAoZW1iZWRUd2VlbiBpbnN0YW5jZW9mIFR3ZWVuKSB7XHJcbiAgICAgICAgICAgIGFjdGlvbiA9IGVtYmVkVHdlZW4uX3VuaW9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYWN0aW9uID0gYWN0aW9ucy5wb3AoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFjdGlvbnMucHVzaChyZXBlYXQoYWN0aW9uLCByZXBlYXRUaW1lcykpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBZGQgYW4gcmVwZWF0IGZvcmV2ZXIgYWN0aW9uLlxyXG4gICAgICogVGhpcyBhY3Rpb24gd2lsbCBpbnRlZ3JhdGUgYmVmb3JlIGFjdGlvbnMgdG8gYSBzZXF1ZW5jZSBhY3Rpb24gYXMgdGhlaXIgcGFyYW1ldGVycy5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5LiA5Liq5rC45LmF6YeN5aSNIGFjdGlvbu+8jOi/meS4qiBhY3Rpb24g5Lya5bCG5YmN5LiA5Liq5Yqo5L2c5L2c5Li65LuW55qE5Y+C5pWw44CCXHJcbiAgICAgKiBAbWV0aG9kIHJlcGVhdEZvcmV2ZXJcclxuICAgICAqIEBwYXJhbSB7VHdlZW59IGVtYmVkVHdlZW4g5Y+v6YCJ77yM5bWM5YWlIFR3ZWVuXHJcbiAgICAgKiBAcmV0dXJuIHtUd2Vlbn1cclxuICAgICAqL1xyXG4gICAgcmVwZWF0Rm9yZXZlciAoZW1iZWRUd2Vlbj86IFR3ZWVuKTogVHdlZW4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbnMgPSB0aGlzLl9hY3Rpb25zO1xyXG4gICAgICAgIGxldCBhY3Rpb246IGFueTtcclxuXHJcbiAgICAgICAgaWYgKGVtYmVkVHdlZW4gaW5zdGFuY2VvZiBUd2Vlbikge1xyXG4gICAgICAgICAgICBhY3Rpb24gPSBlbWJlZFR3ZWVuLl91bmlvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFjdGlvbiA9IGFjdGlvbnMucG9wKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhY3Rpb25zLnB1c2gocmVwZWF0Rm9yZXZlcihhY3Rpb24gYXMgQWN0aW9uSW50ZXJ2YWwpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQWRkIGFuIHJldmVyc2UgdGltZSBhY3Rpb24uXHJcbiAgICAgKiBUaGlzIGFjdGlvbiB3aWxsIGludGVncmF0ZSBiZWZvcmUgYWN0aW9ucyB0byBhIHNlcXVlbmNlIGFjdGlvbiBhcyB0aGVpciBwYXJhbWV0ZXJzLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmt7vliqDkuIDkuKrlgJLnva7ml7bpl7QgYWN0aW9u77yM6L+Z5LiqIGFjdGlvbiDkvJrlsIbliY3kuIDkuKrliqjkvZzkvZzkuLrku5bnmoTlj4LmlbDjgIJcclxuICAgICAqIEBtZXRob2QgcmV2ZXJzZVRpbWVcclxuICAgICAqIEBwYXJhbSB7VHdlZW59IGVtYmVkVHdlZW4g5Y+v6YCJ77yM5bWM5YWlIFR3ZWVuXHJcbiAgICAgKiBAcmV0dXJuIHtUd2Vlbn1cclxuICAgICAqL1xyXG4gICAgcmV2ZXJzZVRpbWUgKGVtYmVkVHdlZW4/OiBUd2Vlbik6IFR3ZWVuIHtcclxuICAgICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5fYWN0aW9ucztcclxuICAgICAgICBsZXQgYWN0aW9uOiBhbnk7XHJcblxyXG4gICAgICAgIGlmIChlbWJlZFR3ZWVuIGluc3RhbmNlb2YgVHdlZW4pIHtcclxuICAgICAgICAgICAgYWN0aW9uID0gZW1iZWRUd2Vlbi5fdW5pb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhY3Rpb24gPSBhY3Rpb25zLnBvcCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWN0aW9ucy5wdXNoKHJldmVyc2VUaW1lKGFjdGlvbiBhcyBBY3Rpb25JbnRlcnZhbCkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBZGQgYW4gaGlkZSBhY3Rpb24sIG9ubHkgZm9yIG5vZGUgdGFyZ2V0LlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmt7vliqDkuIDkuKrpmpDol48gYWN0aW9u77yM5Y+q6YCC55So5LqOIHRhcmdldCDmmK/oioLngrnnsbvlnovnmoTjgIJcclxuICAgICAqIEBtZXRob2QgaGlkZVxyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIGhpZGUgKCk6IFR3ZWVuIHtcclxuICAgICAgICBsZXQgYWN0aW9uID0gaGlkZSgpO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBZGQgYW4gc2hvdyBhY3Rpb24sIG9ubHkgZm9yIG5vZGUgdGFyZ2V0LlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmt7vliqDkuIDkuKrmmL7npLogYWN0aW9u77yM5Y+q6YCC55So5LqOIHRhcmdldCDmmK/oioLngrnnsbvlnovnmoTjgIJcclxuICAgICAqIEBtZXRob2Qgc2hvd1xyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHNob3cgKCk6IFR3ZWVuIHtcclxuICAgICAgICBsZXQgYWN0aW9uID0gc2hvdygpO1xyXG4gICAgICAgIHRoaXMuX2FjdGlvbnMucHVzaChhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBZGQgYW4gcmVtb3ZlU2VsZiBhY3Rpb24sIG9ubHkgZm9yIG5vZGUgdGFyZ2V0LlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmt7vliqDkuIDkuKrnp7vpmaToh6rlt7EgYWN0aW9u77yM5Y+q6YCC55So5LqOIHRhcmdldCDmmK/oioLngrnnsbvlnovnmoTjgIJcclxuICAgICAqIEBtZXRob2QgcmVtb3ZlU2VsZlxyXG4gICAgICogQHJldHVybiB7VHdlZW59XHJcbiAgICAgKi9cclxuICAgIHJlbW92ZVNlbGYgKCk6IFR3ZWVuIHtcclxuICAgICAgICBsZXQgYWN0aW9uID0gcmVtb3ZlU2VsZihmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5fYWN0aW9ucy5wdXNoKGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfdW5pb24gKCkge1xyXG4gICAgICAgIGxldCBhY3Rpb25zID0gdGhpcy5fYWN0aW9ucztcclxuICAgICAgICBsZXQgYWN0aW9uOiBBY3Rpb247XHJcbiAgICAgICAgaWYgKGFjdGlvbnMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIGFjdGlvbiA9IGFjdGlvbnNbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhY3Rpb24gPSBzZXF1ZW5jZShhY3Rpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBhY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZGVzdHJveSAoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9wKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgX3RtcF9hcmdzOiBUd2VlbltdIHwgQWN0aW9uW10gPSBbXTtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBfd3JhcHBlZFNlcXVlbmNlICguLi5hcmdzOiBBY3Rpb25bXSB8IFR3ZWVuW10pIHtcclxuICAgICAgICBjb25zdCB0bXBfYXJncyA9IFR3ZWVuLl90bXBfYXJncztcclxuICAgICAgICB0bXBfYXJncy5sZW5ndGggPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGwgPSBhcmdzLmxlbmd0aCwgaSA9IDA7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGFyZyA9IHRtcF9hcmdzW2ldID0gYXJnc1tpXTtcclxuICAgICAgICAgICAgaWYgKGFyZyBpbnN0YW5jZW9mIFR3ZWVuKSB7XHJcbiAgICAgICAgICAgICAgICB0bXBfYXJnc1tpXSA9IGFyZy5fdW5pb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNlcXVlbmNlLmFwcGx5KHNlcXVlbmNlLCB0bXBfYXJncyBhcyBhbnkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIF93cmFwcGVkUGFyYWxsZWwgKC4uLmFyZ3M6IEFjdGlvbltdIHwgVHdlZW5bXSkge1xyXG4gICAgICAgIGNvbnN0IHRtcF9hcmdzID0gVHdlZW4uX3RtcF9hcmdzO1xyXG4gICAgICAgIHRtcF9hcmdzLmxlbmd0aCA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgbCA9IGFyZ3MubGVuZ3RoLCBpID0gMDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgYXJnID0gdG1wX2FyZ3NbaV0gPSBhcmdzW2ldO1xyXG4gICAgICAgICAgICBpZiAoYXJnIGluc3RhbmNlb2YgVHdlZW4pIHtcclxuICAgICAgICAgICAgICAgIHRtcF9hcmdzW2ldID0gYXJnLl91bmlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc3Bhd24uYXBwbHkoc3Bhd24sIHRtcF9hcmdzIGFzIGFueSk7XHJcbiAgICB9XHJcbn1cclxuY2MuVHdlZW4gPSBUd2VlbjtcclxuXHJcblxyXG4vKipcclxuICogQGVuXHJcbiAqIHR3ZWVuIGlzIGEgdXRpbGl0eSBmdW5jdGlvbiB0aGF0IGhlbHBzIGluc3RhbnRpYXRlIFR3ZWVuIGluc3RhbmNlcy5cclxuICogQHpoXHJcbiAqIHR3ZWVuIOaYr+S4gOS4quW3peWFt+WHveaVsO+8jOW4ruWKqeWunuS+i+WMliBUd2VlbiDlrp7kvovjgIJcclxuICogQHBhcmFtIHRhcmdldCDnvJPliqjnmoTnm67moIdcclxuICogQHJldHVybnMgVHdlZW4g5a6e5L6LXHJcbiAqIEBleGFtcGxlXHJcbiAqIHR3ZWVuKHRoaXMubm9kZSlcclxuICogICAudG8oMSwge3NjYWxlOiBuZXcgVmVjMygyLCAyLCAyKSwgcG9zaXRpb246IG5ldyBWZWMzKDUsIDUsIDUpfSlcclxuICogICAuY2FsbCgoKSA9PiB7IGNvbnNvbGUubG9nKCdUaGlzIGlzIGEgY2FsbGJhY2snKTsgfSlcclxuICogICAuYnkoMSwge3NjYWxlOiBuZXcgVmVjMygtMSwgLTEsIC0xKX0sIHtlYXNpbmc6ICdzaW5lT3V0SW4nfSlcclxuICogICAuc3RhcnQoKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHR3ZWVuICh0YXJnZXQ/OiBvYmplY3QpIHtcclxuICAgIHJldHVybiBuZXcgVHdlZW4odGFyZ2V0KTtcclxufVxyXG5jYy50d2VlbiA9IHR3ZWVuO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiB0d2VlblV0aWwgaXMgYSB1dGlsaXR5IGZ1bmN0aW9uIHRoYXQgaGVscHMgaW5zdGFudGlhdGUgVHdlZW4gaW5zdGFuY2VzLlxyXG4gKiBAemhcclxuICogdHdlZW5VdGlsIOaYr+S4gOS4quW3peWFt+WHveaVsO+8jOW4ruWKqeWunuS+i+WMliBUd2VlbiDlrp7kvovjgIJcclxuICogQGRlcHJlY2F0ZWQgcGxlYXNlIHVzZSBgdHdlZW5gIGluc3RlYWQuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdHdlZW5VdGlsICh0YXJnZXQ/OiBvYmplY3QpIHtcclxuICAgIHdhcm4oXCJ0d2VlblV0aWwnIGlzIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgJ3R3ZWVuJyBpbnN0ZWFkIFwiKTtcclxuICAgIHJldHVybiBuZXcgVHdlZW4odGFyZ2V0KTtcclxufVxyXG5jYy50d2VlblV0aWwgPSB0d2VlblV0aWw7Il19