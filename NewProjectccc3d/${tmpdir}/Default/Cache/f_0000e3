(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../../core/components/index.js", "../../core/data/class-decorator.js", "../../core/platform/index.js", "../../core/math/index.js", "../../core/value-types/enum.js", "./layout-component.js", "./page-view-indicator-component.js", "./scroll-view-component.js", "./scroll-bar-component.js", "../../core/platform/debug.js", "../../core/data/utils/extends-enum.js", "../../core/default-constants.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../../core/components/index.js"), require("../../core/data/class-decorator.js"), require("../../core/platform/index.js"), require("../../core/math/index.js"), require("../../core/value-types/enum.js"), require("./layout-component.js"), require("./page-view-indicator-component.js"), require("./scroll-view-component.js"), require("./scroll-bar-component.js"), require("../../core/platform/debug.js"), require("../../core/data/utils/extends-enum.js"), require("../../core/default-constants.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.index, global.classDecorator, global.index, global.index, global._enum, global.layoutComponent, global.pageViewIndicatorComponent, global.scrollViewComponent, global.scrollBarComponent, global.debug, global.extendsEnum, global.defaultConstants);
    global.pageViewComponent = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _index, _classDecorator, _index2, _index3, _enum, _layoutComponent, _pageViewIndicatorComponent, _scrollViewComponent, _scrollBarComponent, _debug, _extendsEnum, _defaultConstants) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.PageViewComponent = void 0;

  var _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _class, _class2, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _class3, _temp;

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function set(target, property, value, receiver) { if (typeof Reflect !== "undefined" && Reflect.set) { set = Reflect.set; } else { set = function set(target, property, value, receiver) { var base = _superPropBase(target, property); var desc; if (base) { desc = Object.getOwnPropertyDescriptor(base, property); if (desc.set) { desc.set.call(receiver, value); return true; } else if (!desc.writable) { return false; } } desc = Object.getOwnPropertyDescriptor(receiver, property); if (desc) { if (!desc.writable) { return false; } desc.value = value; Object.defineProperty(receiver, property, desc); } else { _defineProperty(receiver, property, value); } return true; }; } return set(target, property, value, receiver); }

  function _set(target, property, value, receiver, isStrict) { var s = set(target, property, value, receiver || target); if (!s && isStrict) { throw new Error('failed to set property'); } return value; }

  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

  function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

  function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  var _temp_vec2 = new _index3.Vec2();
  /**
   * @en Enum for Page View Size Mode.
   *
   * @zh 页面视图每个页面统一的大小类型
   */


  var SizeMode;

  (function (SizeMode) {
    SizeMode[SizeMode["Unified"] = 0] = "Unified";
    SizeMode[SizeMode["Free"] = 1] = "Free";
  })(SizeMode || (SizeMode = {}));

  (0, _enum.ccenum)(SizeMode);
  /**
   * @en Enum for Page View Direction.
   *
   * @zh 页面视图滚动类型
   */

  var Direction;

  (function (Direction) {
    Direction[Direction["Horizontal"] = 0] = "Horizontal";
    Direction[Direction["Vertical"] = 1] = "Vertical";
  })(Direction || (Direction = {}));

  (0, _enum.ccenum)(Direction);
  /**
   * @en Enum for ScrollView event type.
   *
   * @zh 滚动视图事件类型
   */

  var EventType;
  /**
   * @en
   * The PageView control.
   *
   * @zh
   * 页面视图组件
   */

  (function (EventType) {
    EventType["PAGE_TURNING"] = "page-turning";
  })(EventType || (EventType = {}));

  var // @ts-ignore
  PageViewComponent = (_dec = (0, _classDecorator.ccclass)('cc.PageViewComponent'), _dec2 = (0, _classDecorator.help)('i18n:cc.PageViewComponent'), _dec3 = (0, _classDecorator.executionOrder)(110), _dec4 = (0, _classDecorator.menu)('UI/PageView'), _dec5 = (0, _classDecorator.property)({
    type: SizeMode,
    tooltip: '页面视图中每个页面大小类型'
  }), _dec6 = (0, _classDecorator.property)({
    type: Direction,
    tooltip: '页面视图滚动类型'
  }), _dec7 = (0, _classDecorator.property)({
    slide: true,
    range: [0, 1, 0.01],
    tooltip: '滚动临界值，默认单位百分比，当拖拽超出该数值时，松开会自动滚动下一页，小于时则还原'
  }), _dec8 = (0, _classDecorator.property)({
    slide: true,
    range: [0, 1, 0.01],
    tooltip: '设置 PageView PageTurning 事件的发送时机'
  }), _dec9 = (0, _classDecorator.property)({
    type: _pageViewIndicatorComponent.PageViewIndicatorComponent,
    tooltip: '页面视图指示器组件'
  }), _dec10 = (0, _classDecorator.property)({
    tooltip: '快速滑动翻页临界值\n当用户快速滑动时，会根据滑动开始和结束的距离与时间计算出一个速度值\n该值与此临界值相比较，如果大于临界值，则进行自动翻页'
  }), _dec11 = (0, _classDecorator.property)({
    type: _scrollBarComponent.ScrollBarComponent,
    visible: false,
    override: true
  }), _dec12 = (0, _classDecorator.property)({
    type: _scrollBarComponent.ScrollBarComponent,
    visible: false,
    override: true
  }), _dec13 = (0, _classDecorator.property)({
    visible: false,
    override: true
  }), _dec14 = (0, _classDecorator.property)({
    visible: false,
    override: true
  }), _dec15 = (0, _classDecorator.property)({
    visible: false,
    override: true
  }), _dec16 = (0, _classDecorator.property)({
    visible: false,
    override: true,
    type: [_index.EventHandler]
  }), _dec17 = (0, _classDecorator.property)({
    type: [_index.EventHandler],
    tooltip: '滚动视图的事件回调函数'
  }), _dec(_class = _dec2(_class = _dec3(_class = _dec4(_class = (_class2 = (_temp = _class3 = /*#__PURE__*/function (_ScrollViewComponent) {
    _inherits(PageViewComponent, _ScrollViewComponent);

    function PageViewComponent() {
      var _getPrototypeOf2;

      var _this;

      _classCallCheck(this, PageViewComponent);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PageViewComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));

      _initializerDefineProperty(_this, "autoPageTurningThreshold", _descriptor, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "horizontal", _descriptor2, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "vertical", _descriptor3, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "cancelInnerEvents", _descriptor4, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "scrollEvents", _descriptor5, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "pageTurningSpeed", _descriptor6, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "pageEvents", _descriptor7, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_sizeMode", _descriptor8, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_direction", _descriptor9, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_scrollThreshold", _descriptor10, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_pageTurningEventTiming", _descriptor11, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_indicator", _descriptor12, _assertThisInitialized(_this));

      _this._curPageIdx = 0;
      _this._lastPageIdx = 0;
      _this._pages = [];
      _this._initContentPos = new _index3.Vec3();
      _this._scrollCenterOffsetX = [];
      _this._scrollCenterOffsetY = [];
      _this._touchBeganPosition = new _index3.Vec3();
      _this._touchEndPosition = new _index3.Vec3();
      return _this;
    }

    _createClass(PageViewComponent, [{
      key: "__preload",
      value: function __preload() {
        this.node.on(_index2.SystemEventType.SIZE_CHANGED, this._updateAllPagesSize, this);
      }
    }, {
      key: "onEnable",
      value: function onEnable() {
        _get(_getPrototypeOf(PageViewComponent.prototype), "onEnable", this).call(this);

        if (!_defaultConstants.EDITOR) {
          this.node.on(PageViewComponent.EventType.SCROLL_ENG_WITH_THRESHOLD, this._dispatchPageTurningEvent, this);
        }
      }
    }, {
      key: "onDisable",
      value: function onDisable() {
        _get(_getPrototypeOf(PageViewComponent.prototype), "onDisable", this).call(this);

        if (!_defaultConstants.EDITOR) {
          this.node.off(PageViewComponent.EventType.SCROLL_ENG_WITH_THRESHOLD, this._dispatchPageTurningEvent, this);
        }
      }
    }, {
      key: "onLoad",
      value: function onLoad() {
        this._initPages();

        if (this.indicator) {
          this.indicator.setPageView(this);
        }
      }
    }, {
      key: "onDestroy",
      value: function onDestroy() {
        this.node.off(_index2.SystemEventType.SIZE_CHANGED, this._updateAllPagesSize, this);
      }
      /**
       * @en
       * Returns current page index.
       *
       * @zh
       * 返回当前页面索引。
       *
       * @returns 当前页面索引。
       */

    }, {
      key: "getCurrentPageIndex",
      value: function getCurrentPageIndex() {
        return this._curPageIdx;
      }
      /**
       * @en
       * Set current page index.
       *
       * @zh
       * 设置当前页面索引。
       * @param index 索引。
       */

    }, {
      key: "setCurrentPageIndex",
      value: function setCurrentPageIndex(index) {
        this.scrollToPage(index, 1);
      }
      /**
       * @en
       * Returns all pages of pageview.
       *
       * @zh
       * 返回视图中的所有页面。
       *
       * @returns 输=视图所有页面。
       */

    }, {
      key: "getPages",
      value: function getPages() {
        return this._pages;
      }
      /**
       * @en
       * At the end of the current page view to insert a new view.
       *
       * @zh
       * 在当前页面视图的尾部插入一个新视图。
       *
       * @param page 新视图。
       */

    }, {
      key: "addPage",
      value: function addPage(page) {
        if (!page || this._pages.indexOf(page) !== -1 || !this.content) {
          return;
        }

        this.content.addChild(page);

        this._pages.push(page);

        this._updatePageView();
      }
      /**
       * @en
       * Inserts a page in the specified location.
       *
       * @zh
       * 将页面插入指定位置中。
       *
       * @param page 新视图。
       * @param index 指定位置。
       */

    }, {
      key: "insertPage",
      value: function insertPage(page, index) {
        if (index < 0 || !page || this._pages.indexOf(page) !== -1 || !this.content) {
          return;
        }

        var pageCount = this._pages.length;

        if (index >= pageCount) {
          this.addPage(page);
        } else {
          this._pages.splice(index, 0, page);

          this.content.insertChild(page, index);

          this._updatePageView();
        }
      }
      /**
       * @en
       * Removes a page from PageView.
       *
       * @zh
       * 移除指定页面。
       *
       * @param page 指定页面。
       */

    }, {
      key: "removePage",
      value: function removePage(page) {
        if (!page || !this.content) {
          return;
        }

        var index = this._pages.indexOf(page);

        if (index === -1) {
          (0, _debug.warnID)(4300, page.name);
          return;
        }

        this.removePageAtIndex(index);
      }
      /**
       * @en
       * Removes a page at index of PageView.
       *
       * @zh
       * 移除指定下标的页面。
       *
       * @param index 页面下标。
       */

    }, {
      key: "removePageAtIndex",
      value: function removePageAtIndex(index) {
        var pageList = this._pages;

        if (index < 0 || index >= pageList.length) {
          return;
        }

        var page = pageList[index];

        if (!page || !this.content) {
          return;
        }

        this.content.removeChild(page);
        pageList.splice(index, 1);

        this._updatePageView();
      }
      /**
       * @en
       * Removes all pages from PageView.
       *
       * @zh
       * 移除所有页面。
       */

    }, {
      key: "removeAllPages",
      value: function removeAllPages() {
        if (!this.content) {
          return;
        }

        var locPages = this._pages;

        for (var i = 0, len = locPages.length; i < len; i++) {
          this.content.removeChild(locPages[i]);
        }

        this._pages.length = 0;

        this._updatePageView();
      }
      /**
       * @en
       * Scroll PageView to index.
       *
       * @zh
       * 滚动到指定页面
       *
       * @param idx index of page.
       * @param timeInSecond scrolling time.
       */

    }, {
      key: "scrollToPage",
      value: function scrollToPage(idx) {
        var timeInSecond = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.3;

        if (idx < 0 || idx >= this._pages.length) {
          return;
        }

        this._curPageIdx = idx;
        this.scrollToOffset(this._moveOffsetValue(idx), timeInSecond, true);

        if (this.indicator) {
          this.indicator._changedState();
        }
      } // override the method of ScrollView

    }, {
      key: "getScrollEndedEventTiming",
      value: function getScrollEndedEventTiming() {
        return this.pageTurningEventTiming;
      } // 刷新页面视图

    }, {
      key: "_updatePageView",
      value: function _updatePageView() {
        // 当页面数组变化时修改 content 大小
        var layout = this.content.getComponent(_layoutComponent.LayoutComponent);

        if (layout && layout.enabled) {
          layout.updateLayout();
        }

        var pageCount = this._pages.length;

        if (this._curPageIdx >= pageCount) {
          this._curPageIdx = pageCount === 0 ? 0 : pageCount - 1;
          this._lastPageIdx = this._curPageIdx;
        } // 进行排序


        var contentPos = this._initContentPos;

        for (var i = 0; i < pageCount; ++i) {
          var page = this._pages[i]; // page.setSiblingIndex(i);

          var pos = page.position;

          if (this.direction === Direction.Horizontal) {
            this._scrollCenterOffsetX[i] = Math.abs(contentPos.x + pos.x);
          } else {
            this._scrollCenterOffsetY[i] = Math.abs(contentPos.y + pos.y);
          }
        } // 刷新 indicator 信息与状态


        if (this.indicator) {
          this.indicator._refresh();
        }
      } // 刷新所有页面的大小

    }, {
      key: "_updateAllPagesSize",
      value: function _updateAllPagesSize() {
        if (!this.content || !this.view) {
          return;
        }

        if (this._sizeMode !== SizeMode.Unified) {
          return;
        }

        var locPages = _defaultConstants.EDITOR ? this.content.children : this._pages;
        var selfSize = this.view.getContentSize();

        for (var i = 0, len = locPages.length; i < len; i++) {
          locPages[i].setContentSize(selfSize);
        }
      }
    }, {
      key: "_handleReleaseLogic",
      value: function _handleReleaseLogic() {
        this._autoScrollToPage();

        if (this._scrolling) {
          this._scrolling = false;

          if (!this._autoScrolling) {
            this._dispatchEvent(PageViewComponent.EventType.SCROLL_ENDED);
          }
        }
      }
    }, {
      key: "_onTouchBegan",
      value: function _onTouchBegan(event, captureListeners) {
        event.touch.getUILocation(_temp_vec2);

        _index3.Vec3.set(this._touchBeganPosition, _temp_vec2.x, _temp_vec2.y, 0);

        _get(_getPrototypeOf(PageViewComponent.prototype), "_onTouchBegan", this).call(this, event, captureListeners);
      }
    }, {
      key: "_onTouchMoved",
      value: function _onTouchMoved(event, captureListeners) {
        _get(_getPrototypeOf(PageViewComponent.prototype), "_onTouchMoved", this).call(this, event, captureListeners);
      }
    }, {
      key: "_onTouchEnded",
      value: function _onTouchEnded(event, captureListeners) {
        event.touch.getUILocation(_temp_vec2);

        _index3.Vec3.set(this._touchEndPosition, _temp_vec2.x, _temp_vec2.y, 0);

        _get(_getPrototypeOf(PageViewComponent.prototype), "_onTouchEnded", this).call(this, event, captureListeners);
      }
    }, {
      key: "_onTouchCancelled",
      value: function _onTouchCancelled(event, captureListeners) {
        event.touch.getUILocation(_temp_vec2);

        _index3.Vec3.set(this._touchEndPosition, _temp_vec2.x, _temp_vec2.y, 0);

        _get(_getPrototypeOf(PageViewComponent.prototype), "_onTouchCancelled", this).call(this, event, captureListeners);
      }
    }, {
      key: "_onMouseWheel",
      value: function _onMouseWheel() {}
    }, {
      key: "_syncScrollDirection",
      value: function _syncScrollDirection() {
        this.horizontal = this.direction === Direction.Horizontal;
        this.vertical = this.direction === Direction.Vertical;
      }
    }, {
      key: "_syncSizeMode",
      value: function _syncSizeMode() {
        var view = this.view;

        if (!this.content || !view) {
          return;
        }

        var layout = this.content.getComponent(_layoutComponent.LayoutComponent);

        if (layout) {
          if (this._sizeMode === SizeMode.Free && this._pages.length > 0) {
            var lastPage = this._pages[this._pages.length - 1];

            if (this.direction === Direction.Horizontal) {
              layout.paddingLeft = (view.width - this._pages[0].width) / 2;
              layout.paddingRight = (view.width - lastPage.width) / 2;
            } else if (this.direction === Direction.Vertical) {
              layout.paddingTop = (view.height - this._pages[0].height) / 2;
              layout.paddingBottom = (view.height - lastPage.height) / 2;
            }
          }

          layout.updateLayout();
        }
      } // 初始化页面

    }, {
      key: "_initPages",
      value: function _initPages() {
        if (!this.content) {
          return;
        }

        this._initContentPos = this.content.position;
        var children = this.content.children;

        for (var i = 0; i < children.length; ++i) {
          var page = children[i];

          if (this._pages.indexOf(page) >= 0) {
            continue;
          }

          this._pages.push(page);
        }

        this._syncScrollDirection();

        this._syncSizeMode();

        this._updatePageView();
      }
    }, {
      key: "_dispatchPageTurningEvent",
      value: function _dispatchPageTurningEvent() {
        if (this._lastPageIdx === this._curPageIdx) {
          return;
        }

        this._lastPageIdx = this._curPageIdx;

        _index.EventHandler.emitEvents(this.pageEvents, this);

        this.node.emit(EventType.PAGE_TURNING, this);
      } // 快速滑动

    }, {
      key: "_isQuicklyScrollable",
      value: function _isQuicklyScrollable(touchMoveVelocity) {
        if (this.direction === Direction.Horizontal) {
          if (Math.abs(touchMoveVelocity.x) > this.autoPageTurningThreshold) {
            return true;
          }
        } else if (this.direction === Direction.Vertical) {
          if (Math.abs(touchMoveVelocity.y) > this.autoPageTurningThreshold) {
            return true;
          }
        }

        return false;
      } // 通过 idx 获取偏移值数值

    }, {
      key: "_moveOffsetValue",
      value: function _moveOffsetValue(idx) {
        var offset = new _index3.Vec3();

        if (this._sizeMode === SizeMode.Free) {
          if (this.direction === Direction.Horizontal) {
            offset.x = this._scrollCenterOffsetX[idx];
          } else if (this.direction === Direction.Vertical) {
            offset.y = this._scrollCenterOffsetY[idx];
          }
        } else {
          var view = this.view;

          if (!view) {
            return offset;
          }

          if (this.direction === Direction.Horizontal) {
            offset.x = idx * view.width;
          } else if (this.direction === Direction.Vertical) {
            offset.y = idx * view.height;
          }
        }

        return offset;
      }
    }, {
      key: "_getDragDirection",
      value: function _getDragDirection(moveOffset) {
        if (this._direction === Direction.Horizontal) {
          if (moveOffset.x === 0) {
            return 0;
          }

          return moveOffset.x > 0 ? 1 : -1;
        } else {
          // 由于滚动 Y 轴的原点在在右上角所以应该是小于 0
          if (moveOffset.y === 0) {
            return 0;
          }

          return moveOffset.y < 0 ? 1 : -1;
        }
      } // 是否超过自动滚动临界值

    }, {
      key: "_isScrollable",
      value: function _isScrollable(offset, index, nextIndex) {
        if (this._sizeMode === SizeMode.Free) {
          var curPageCenter = 0;
          var nextPageCenter = 0;

          if (this.direction === Direction.Horizontal) {
            curPageCenter = this._scrollCenterOffsetX[index];
            nextPageCenter = this._scrollCenterOffsetX[nextIndex];
            return Math.abs(offset.x) >= Math.abs(curPageCenter - nextPageCenter) * this.scrollThreshold;
          } else if (this.direction === Direction.Vertical) {
            curPageCenter = this._scrollCenterOffsetY[index];
            nextPageCenter = this._scrollCenterOffsetY[nextIndex];
            return Math.abs(offset.y) >= Math.abs(curPageCenter - nextPageCenter) * this.scrollThreshold;
          }
        } else {
          var view = this.view;

          if (!view) {
            return;
          }

          if (this.direction === Direction.Horizontal) {
            return Math.abs(offset.x) >= view.width * this.scrollThreshold;
          } else if (this.direction === Direction.Vertical) {
            return Math.abs(offset.y) >= view.height * this.scrollThreshold;
          }
        }
      }
    }, {
      key: "_autoScrollToPage",
      value: function _autoScrollToPage() {
        var bounceBackStarted = this._startBounceBackIfNeeded(); // Note:


        var moveOffset = new _index3.Vec3();

        _index3.Vec3.subtract(moveOffset, this._touchBeganPosition, this._touchEndPosition); // this._touchBeganPosition.subtract(this._touchEndPosition);


        if (bounceBackStarted) {
          var dragDirection = this._getDragDirection(moveOffset);

          if (dragDirection === 0) {
            return;
          }

          if (dragDirection > 0) {
            this._curPageIdx = this._pages.length - 1;
          } else {
            this._curPageIdx = 0;
          }

          if (this.indicator) {
            this.indicator._changedState();
          }
        } else {
          var index = this._curPageIdx;

          var nextIndex = index + this._getDragDirection(moveOffset);

          var timeInSecond = this.pageTurningSpeed * Math.abs(index - nextIndex);

          if (nextIndex < this._pages.length) {
            if (this._isScrollable(moveOffset, index, nextIndex)) {
              this.scrollToPage(nextIndex, timeInSecond);
              return;
            } else {
              var touchMoveVelocity = this._calculateTouchMoveVelocity();

              if (this._isQuicklyScrollable(touchMoveVelocity)) {
                this.scrollToPage(nextIndex, timeInSecond);
                return;
              }
            }
          }

          this.scrollToPage(index, timeInSecond);
        }
      }
    }, {
      key: "sizeMode",

      /**
       * @en
       * Specify the size type of each page in PageView.
       *
       * @zh
       * 页面视图中每个页面大小类型
       */
      get: function get() {
        return this._sizeMode;
      },
      set: function set(value) {
        if (this._sizeMode === value) {
          return;
        }

        this._sizeMode = value;

        this._syncSizeMode();
      }
      /**
       * @en
       * The page view direction.
       *
       * @zh
       * 页面视图滚动类型
       */

    }, {
      key: "direction",
      get: function get() {
        return this._direction;
      },
      set: function set(value) {
        if (this._direction === value) {
          return;
        }

        this._direction = value;

        this._syncScrollDirection();
      }
      /**
       * @en
       * The scroll threshold value, when drag exceeds this value,
       * release the next page will automatically scroll, less than the restore.
       *
       * @zh
       * 滚动临界值，默认单位百分比，当拖拽超出该数值时，松开会自动滚动下一页，小于时则还原。
       */

    }, {
      key: "scrollThreshold",
      get: function get() {
        return this._scrollThreshold;
      },
      set: function set(value) {
        if (this._scrollThreshold === value) {
          return;
        }

        this._scrollThreshold = value;
      }
      /**
       * @en
       * Change the PageTurning event timing of PageView.
       *
       * @zh
       * 设置 PageView PageTurning 事件的发送时机。
       */

    }, {
      key: "pageTurningEventTiming",
      get: function get() {
        return this._pageTurningEventTiming;
      },
      set: function set(value) {
        if (this._pageTurningEventTiming === value) {
          return;
        }

        this._pageTurningEventTiming = value;
      }
      /**
       * @en
       * The Page View Indicator.
       *
       * @zh
       * 页面视图指示器组件
       */

    }, {
      key: "indicator",
      get: function get() {
        return this._indicator;
      },
      set: function set(value) {
        if (this._indicator === value) {
          return;
        }

        this._indicator = value;

        if (this.indicator) {
          this.indicator.setPageView(this);
        }
      }
    }, {
      key: "curPageIdx",
      get: function get() {
        return this._curPageIdx;
      }
    }, {
      key: "verticalScrollBar",
      get: function get() {
        return _get(_getPrototypeOf(PageViewComponent.prototype), "verticalScrollBar", this);
      },
      set: function set(value) {
        _set(_getPrototypeOf(PageViewComponent.prototype), "verticalScrollBar", value, this, true);
      }
    }, {
      key: "horizontalScrollBar",
      get: function get() {
        return _get(_getPrototypeOf(PageViewComponent.prototype), "horizontalScrollBar", this);
      },
      set: function set(value) {
        _set(_getPrototypeOf(PageViewComponent.prototype), "horizontalScrollBar", value, this, true);
      }
    }]);

    return PageViewComponent;
  }(_scrollViewComponent.ScrollViewComponent), _class3.SizeMode = SizeMode, _class3.Direction = Direction, _class3.EventType = (0, _extendsEnum.extendsEnum)(EventType, _scrollViewComponent.EventType), _temp), (_applyDecoratedDescriptor(_class2.prototype, "sizeMode", [_dec5], Object.getOwnPropertyDescriptor(_class2.prototype, "sizeMode"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "direction", [_dec6], Object.getOwnPropertyDescriptor(_class2.prototype, "direction"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "scrollThreshold", [_dec7], Object.getOwnPropertyDescriptor(_class2.prototype, "scrollThreshold"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "pageTurningEventTiming", [_dec8], Object.getOwnPropertyDescriptor(_class2.prototype, "pageTurningEventTiming"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "indicator", [_dec9], Object.getOwnPropertyDescriptor(_class2.prototype, "indicator"), _class2.prototype), _descriptor = _applyDecoratedDescriptor(_class2.prototype, "autoPageTurningThreshold", [_dec10], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 100;
    }
  }), _applyDecoratedDescriptor(_class2.prototype, "verticalScrollBar", [_dec11], Object.getOwnPropertyDescriptor(_class2.prototype, "verticalScrollBar"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "horizontalScrollBar", [_dec12], Object.getOwnPropertyDescriptor(_class2.prototype, "horizontalScrollBar"), _class2.prototype), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "horizontal", [_dec13], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return true;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "vertical", [_dec14], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return true;
    }
  }), _descriptor4 = _applyDecoratedDescriptor(_class2.prototype, "cancelInnerEvents", [_dec15], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return true;
    }
  }), _descriptor5 = _applyDecoratedDescriptor(_class2.prototype, "scrollEvents", [_dec16], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return [];
    }
  }), _descriptor6 = _applyDecoratedDescriptor(_class2.prototype, "pageTurningSpeed", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 0.3;
    }
  }), _descriptor7 = _applyDecoratedDescriptor(_class2.prototype, "pageEvents", [_dec17], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return [];
    }
  }), _descriptor8 = _applyDecoratedDescriptor(_class2.prototype, "_sizeMode", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return SizeMode.Unified;
    }
  }), _descriptor9 = _applyDecoratedDescriptor(_class2.prototype, "_direction", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return Direction.Horizontal;
    }
  }), _descriptor10 = _applyDecoratedDescriptor(_class2.prototype, "_scrollThreshold", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 0.5;
    }
  }), _descriptor11 = _applyDecoratedDescriptor(_class2.prototype, "_pageTurningEventTiming", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return 0.1;
    }
  }), _descriptor12 = _applyDecoratedDescriptor(_class2.prototype, "_indicator", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  })), _class2)) || _class) || _class) || _class) || _class);
  _exports.PageViewComponent = PageViewComponent;
  cc.PageViewComponent = PageViewComponent;
  /**
   * @en
   * Note: This event is emitted from the node to which the component belongs.
   * @zh
   * 注意：此事件是从该组件所属的 Node 上面派发出来的，需要用 node.on 来监听。
   * @event page-turning
   * @param {Event.EventCustom} event
   * @param {PageView} pageView - The PageView component.
   */
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvdWkvY29tcG9uZW50cy9wYWdlLXZpZXctY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbIl90ZW1wX3ZlYzIiLCJWZWMyIiwiU2l6ZU1vZGUiLCJEaXJlY3Rpb24iLCJFdmVudFR5cGUiLCJQYWdlVmlld0NvbXBvbmVudCIsInR5cGUiLCJ0b29sdGlwIiwic2xpZGUiLCJyYW5nZSIsIlBhZ2VWaWV3SW5kaWNhdG9yQ29tcG9uZW50IiwiU2Nyb2xsQmFyQ29tcG9uZW50IiwidmlzaWJsZSIsIm92ZXJyaWRlIiwiQ29tcG9uZW50RXZlbnRIYW5kbGVyIiwiX2N1clBhZ2VJZHgiLCJfbGFzdFBhZ2VJZHgiLCJfcGFnZXMiLCJfaW5pdENvbnRlbnRQb3MiLCJWZWMzIiwiX3Njcm9sbENlbnRlck9mZnNldFgiLCJfc2Nyb2xsQ2VudGVyT2Zmc2V0WSIsIl90b3VjaEJlZ2FuUG9zaXRpb24iLCJfdG91Y2hFbmRQb3NpdGlvbiIsIm5vZGUiLCJvbiIsIlN5c3RlbUV2ZW50VHlwZSIsIlNJWkVfQ0hBTkdFRCIsIl91cGRhdGVBbGxQYWdlc1NpemUiLCJFRElUT1IiLCJTQ1JPTExfRU5HX1dJVEhfVEhSRVNIT0xEIiwiX2Rpc3BhdGNoUGFnZVR1cm5pbmdFdmVudCIsIm9mZiIsIl9pbml0UGFnZXMiLCJpbmRpY2F0b3IiLCJzZXRQYWdlVmlldyIsImluZGV4Iiwic2Nyb2xsVG9QYWdlIiwicGFnZSIsImluZGV4T2YiLCJjb250ZW50IiwiYWRkQ2hpbGQiLCJwdXNoIiwiX3VwZGF0ZVBhZ2VWaWV3IiwicGFnZUNvdW50IiwibGVuZ3RoIiwiYWRkUGFnZSIsInNwbGljZSIsImluc2VydENoaWxkIiwibmFtZSIsInJlbW92ZVBhZ2VBdEluZGV4IiwicGFnZUxpc3QiLCJyZW1vdmVDaGlsZCIsImxvY1BhZ2VzIiwiaSIsImxlbiIsImlkeCIsInRpbWVJblNlY29uZCIsInNjcm9sbFRvT2Zmc2V0IiwiX21vdmVPZmZzZXRWYWx1ZSIsIl9jaGFuZ2VkU3RhdGUiLCJwYWdlVHVybmluZ0V2ZW50VGltaW5nIiwibGF5b3V0IiwiZ2V0Q29tcG9uZW50IiwiTGF5b3V0Q29tcG9uZW50IiwiZW5hYmxlZCIsInVwZGF0ZUxheW91dCIsImNvbnRlbnRQb3MiLCJwb3MiLCJwb3NpdGlvbiIsImRpcmVjdGlvbiIsIkhvcml6b250YWwiLCJNYXRoIiwiYWJzIiwieCIsInkiLCJfcmVmcmVzaCIsInZpZXciLCJfc2l6ZU1vZGUiLCJVbmlmaWVkIiwiY2hpbGRyZW4iLCJzZWxmU2l6ZSIsImdldENvbnRlbnRTaXplIiwic2V0Q29udGVudFNpemUiLCJfYXV0b1Njcm9sbFRvUGFnZSIsIl9zY3JvbGxpbmciLCJfYXV0b1Njcm9sbGluZyIsIl9kaXNwYXRjaEV2ZW50IiwiU0NST0xMX0VOREVEIiwiZXZlbnQiLCJjYXB0dXJlTGlzdGVuZXJzIiwidG91Y2giLCJnZXRVSUxvY2F0aW9uIiwic2V0IiwiaG9yaXpvbnRhbCIsInZlcnRpY2FsIiwiVmVydGljYWwiLCJGcmVlIiwibGFzdFBhZ2UiLCJwYWRkaW5nTGVmdCIsIndpZHRoIiwicGFkZGluZ1JpZ2h0IiwicGFkZGluZ1RvcCIsImhlaWdodCIsInBhZGRpbmdCb3R0b20iLCJfc3luY1Njcm9sbERpcmVjdGlvbiIsIl9zeW5jU2l6ZU1vZGUiLCJlbWl0RXZlbnRzIiwicGFnZUV2ZW50cyIsImVtaXQiLCJQQUdFX1RVUk5JTkciLCJ0b3VjaE1vdmVWZWxvY2l0eSIsImF1dG9QYWdlVHVybmluZ1RocmVzaG9sZCIsIm9mZnNldCIsIm1vdmVPZmZzZXQiLCJfZGlyZWN0aW9uIiwibmV4dEluZGV4IiwiY3VyUGFnZUNlbnRlciIsIm5leHRQYWdlQ2VudGVyIiwic2Nyb2xsVGhyZXNob2xkIiwiYm91bmNlQmFja1N0YXJ0ZWQiLCJfc3RhcnRCb3VuY2VCYWNrSWZOZWVkZWQiLCJzdWJ0cmFjdCIsImRyYWdEaXJlY3Rpb24iLCJfZ2V0RHJhZ0RpcmVjdGlvbiIsInBhZ2VUdXJuaW5nU3BlZWQiLCJfaXNTY3JvbGxhYmxlIiwiX2NhbGN1bGF0ZVRvdWNoTW92ZVZlbG9jaXR5IiwiX2lzUXVpY2tseVNjcm9sbGFibGUiLCJ2YWx1ZSIsIl9zY3JvbGxUaHJlc2hvbGQiLCJfcGFnZVR1cm5pbmdFdmVudFRpbWluZyIsIl9pbmRpY2F0b3IiLCJTY3JvbGxWaWV3Q29tcG9uZW50IiwiU2Nyb2xsRXZlbnRUeXBlIiwicHJvcGVydHkiLCJjYyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUE0Q0EsTUFBTUEsVUFBVSxHQUFHLElBQUlDLFlBQUosRUFBbkI7QUFFQTs7Ozs7OztNQUtLQyxROzthQUFBQSxRO0FBQUFBLElBQUFBLFEsQ0FBQUEsUTtBQUFBQSxJQUFBQSxRLENBQUFBLFE7S0FBQUEsUSxLQUFBQSxROztBQWFMLG9CQUFPQSxRQUFQO0FBRUE7Ozs7OztNQUtLQyxTOzthQUFBQSxTO0FBQUFBLElBQUFBLFMsQ0FBQUEsUztBQUFBQSxJQUFBQSxTLENBQUFBLFM7S0FBQUEsUyxLQUFBQSxTOztBQWFMLG9CQUFPQSxTQUFQO0FBRUE7Ozs7OztNQUtLQyxTO0FBSUw7Ozs7Ozs7O2FBSktBLFM7QUFBQUEsSUFBQUEsUztLQUFBQSxTLEtBQUFBLFM7O01BZUw7QUFDYUMsRUFBQUEsaUIsV0FMWiw2QkFBUSxzQkFBUixDLFVBQ0EsMEJBQUssMkJBQUwsQyxVQUNBLG9DQUFlLEdBQWYsQyxVQUNBLDBCQUFLLGFBQUwsQyxVQVVJLDhCQUFTO0FBQ05DLElBQUFBLElBQUksRUFBRUosUUFEQTtBQUVOSyxJQUFBQSxPQUFPLEVBQUU7QUFGSCxHQUFULEMsVUF3QkEsOEJBQVM7QUFDTkQsSUFBQUEsSUFBSSxFQUFFSCxTQURBO0FBRU5JLElBQUFBLE9BQU8sRUFBRTtBQUZILEdBQVQsQyxVQXlCQSw4QkFBUztBQUNOQyxJQUFBQSxLQUFLLEVBQUUsSUFERDtBQUVOQyxJ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IENodWtvbmcgVGVjaG5vbG9naWVzIEluYy5cclxuIENvcHlyaWdodCAoYykgMjAxNy0yMDE4IFhpYW1lbiBZYWppIFNvZnR3YXJlIENvLiwgTHRkLlxyXG5cclxuIGh0dHBzOi8vd3d3LmNvY29zLmNvbS9cclxuXHJcbiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGVuZ2luZSBzb3VyY2UgY29kZSAodGhlIFwiU29mdHdhcmVcIiksIGEgbGltaXRlZCxcclxuIHdvcmxkd2lkZSwgcm95YWx0eS1mcmVlLCBub24tYXNzaWduYWJsZSwgcmV2b2NhYmxlIGFuZCBub24tZXhjbHVzaXZlIGxpY2Vuc2VcclxuIHRvIHVzZSBDb2NvcyBDcmVhdG9yIHNvbGVseSB0byBkZXZlbG9wIGdhbWVzIG9uIHlvdXIgdGFyZ2V0IHBsYXRmb3Jtcy4gWW91IHNoYWxsXHJcbiBub3QgdXNlIENvY29zIENyZWF0b3Igc29mdHdhcmUgZm9yIGRldmVsb3Bpbmcgb3RoZXIgc29mdHdhcmUgb3IgdG9vbHMgdGhhdCdzXHJcbiB1c2VkIGZvciBkZXZlbG9waW5nIGdhbWVzLiBZb3UgYXJlIG5vdCBncmFudGVkIHRvIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsXHJcbiBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgQ29jb3MgQ3JlYXRvci5cclxuXHJcbiBUaGUgc29mdHdhcmUgb3IgdG9vbHMgaW4gdGhpcyBMaWNlbnNlIEFncmVlbWVudCBhcmUgbGljZW5zZWQsIG5vdCBzb2xkLlxyXG4gWGlhbWVuIFlhamkgU29mdHdhcmUgQ28uLCBMdGQuIHJlc2VydmVzIGFsbCByaWdodHMgbm90IGV4cHJlc3NseSBncmFudGVkIHRvIHlvdS5cclxuXHJcbiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXHJcbiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxyXG4gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxyXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cclxuIFRIRSBTT0ZUV0FSRS5cclxuKi9cclxuLyoqXHJcbiAqIEBjYXRlZ29yeSB1aVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEV2ZW50SGFuZGxlciBhcyBDb21wb25lbnRFdmVudEhhbmRsZXIgfSBmcm9tICcuLi8uLi9jb3JlL2NvbXBvbmVudHMnO1xyXG5pbXBvcnQgeyBjY2NsYXNzLCBoZWxwLCBleGVjdXRpb25PcmRlciwgbWVudSwgcHJvcGVydHkgfSBmcm9tICcuLi8uLi9jb3JlL2RhdGEvY2xhc3MtZGVjb3JhdG9yJztcclxuaW1wb3J0IHsgRXZlbnRUb3VjaCwgU3lzdGVtRXZlbnRUeXBlIH0gZnJvbSAnLi4vLi4vY29yZS9wbGF0Zm9ybSc7XHJcbmltcG9ydCB7IFZlYzIsIFZlYzMgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgnO1xyXG5pbXBvcnQgeyBjY2VudW0gfSBmcm9tICcuLi8uLi9jb3JlL3ZhbHVlLXR5cGVzL2VudW0nO1xyXG5pbXBvcnQgeyBMYXlvdXRDb21wb25lbnQgfSBmcm9tICcuL2xheW91dC1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBQYWdlVmlld0luZGljYXRvckNvbXBvbmVudCB9IGZyb20gJy4vcGFnZS12aWV3LWluZGljYXRvci1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTY3JvbGxWaWV3Q29tcG9uZW50IH0gZnJvbSAnLi9zY3JvbGwtdmlldy1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTY3JvbGxCYXJDb21wb25lbnQgfSBmcm9tICcuL3Njcm9sbC1iYXItY29tcG9uZW50JztcclxuaW1wb3J0IHsgd2FybklEIH0gZnJvbSAnLi4vLi4vY29yZS9wbGF0Zm9ybS9kZWJ1Zyc7XHJcbmltcG9ydCB7IGV4dGVuZHNFbnVtIH0gZnJvbSAnLi4vLi4vY29yZS9kYXRhL3V0aWxzL2V4dGVuZHMtZW51bSc7XHJcbmltcG9ydCB7IEV2ZW50VHlwZSBhcyBTY3JvbGxFdmVudFR5cGUgfSBmcm9tICcuL3Njcm9sbC12aWV3LWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tICcuLi8uLi9jb3JlJztcclxuaW1wb3J0IHsgRURJVE9SIH0gZnJvbSAnaW50ZXJuYWw6Y29uc3RhbnRzJztcclxuXHJcbmNvbnN0IF90ZW1wX3ZlYzIgPSBuZXcgVmVjMigpO1xyXG5cclxuLyoqXHJcbiAqIEBlbiBFbnVtIGZvciBQYWdlIFZpZXcgU2l6ZSBNb2RlLlxyXG4gKlxyXG4gKiBAemgg6aG16Z2i6KeG5Zu+5q+P5Liq6aG16Z2i57uf5LiA55qE5aSn5bCP57G75Z6LXHJcbiAqL1xyXG5lbnVtIFNpemVNb2RlIHtcclxuICAgIC8qKlxyXG4gICAgICogQGVuIEVhY2ggcGFnZSBpcyB1bmlmaWVkIGluIHNpemVcclxuICAgICAqIEB6aCDmr4/kuKrpobXpnaLnu5/kuIDlpKflsI9cclxuICAgICAqL1xyXG4gICAgVW5pZmllZCA9IDAsXHJcbiAgICAvKipcclxuICAgICAqIEBlbiBFYWNoIHBhZ2UgaXMgaW4gZnJlZSBzaXplXHJcbiAgICAgKiBAemgg5q+P5Liq6aG16Z2i5aSn5bCP6ZqP5oSPXHJcbiAgICAgKi9cclxuICAgIEZyZWUgPSAxLFxyXG59XHJcblxyXG5jY2VudW0oU2l6ZU1vZGUpO1xyXG5cclxuLyoqXHJcbiAqIEBlbiBFbnVtIGZvciBQYWdlIFZpZXcgRGlyZWN0aW9uLlxyXG4gKlxyXG4gKiBAemgg6aG16Z2i6KeG5Zu+5rua5Yqo57G75Z6LXHJcbiAqL1xyXG5lbnVtIERpcmVjdGlvbiB7XHJcbiAgICAvKipcclxuICAgICAqIEBlbiBIb3Jpem9udGFsIHNjcm9sbC5cclxuICAgICAqIEB6aCDmsLTlubPmu5rliqhcclxuICAgICAqL1xyXG4gICAgSG9yaXpvbnRhbCA9IDAsXHJcbiAgICAvKipcclxuICAgICAqIEBlbiBWZXJ0aWNhbCBzY3JvbGwuXHJcbiAgICAgKiBAemgg5Z6C55u05rua5YqoXHJcbiAgICAgKi9cclxuICAgIFZlcnRpY2FsID0gMSxcclxufVxyXG5cclxuY2NlbnVtKERpcmVjdGlvbik7XHJcblxyXG4vKipcclxuICogQGVuIEVudW0gZm9yIFNjcm9sbFZpZXcgZXZlbnQgdHlwZS5cclxuICpcclxuICogQHpoIOa7muWKqOinhuWbvuS6i+S7tuexu+Wei1xyXG4gKi9cclxuZW51bSBFdmVudFR5cGUge1xyXG4gICAgUEFHRV9UVVJOSU5HID0gJ3BhZ2UtdHVybmluZycsXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAZW5cclxuICogVGhlIFBhZ2VWaWV3IGNvbnRyb2wuXHJcbiAqXHJcbiAqIEB6aFxyXG4gKiDpobXpnaLop4blm77nu4Tku7ZcclxuICovXHJcbkBjY2NsYXNzKCdjYy5QYWdlVmlld0NvbXBvbmVudCcpXHJcbkBoZWxwKCdpMThuOmNjLlBhZ2VWaWV3Q29tcG9uZW50JylcclxuQGV4ZWN1dGlvbk9yZGVyKDExMClcclxuQG1lbnUoJ1VJL1BhZ2VWaWV3JylcclxuLy8gQHRzLWlnbm9yZVxyXG5leHBvcnQgY2xhc3MgUGFnZVZpZXdDb21wb25lbnQgZXh0ZW5kcyBTY3JvbGxWaWV3Q29tcG9uZW50IHtcclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTcGVjaWZ5IHRoZSBzaXplIHR5cGUgb2YgZWFjaCBwYWdlIGluIFBhZ2VWaWV3LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6aG16Z2i6KeG5Zu+5Lit5q+P5Liq6aG16Z2i5aSn5bCP57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdHlwZTogU2l6ZU1vZGUsXHJcbiAgICAgICAgdG9vbHRpcDogJ+mhtemdouinhuWbvuS4reavj+S4qumhtemdouWkp+Wwj+exu+WeiycsXHJcbiAgICB9KVxyXG4gICAgZ2V0IHNpemVNb2RlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaXplTW9kZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc2l6ZU1vZGUodmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2l6ZU1vZGUgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3NpemVNb2RlID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5fc3luY1NpemVNb2RlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFRoZSBwYWdlIHZpZXcgZGlyZWN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6aG16Z2i6KeG5Zu+5rua5Yqo57G75Z6LXHJcbiAgICAgKi9cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdHlwZTogRGlyZWN0aW9uLFxyXG4gICAgICAgIHRvb2x0aXA6ICfpobXpnaLop4blm77mu5rliqjnsbvlnosnLFxyXG4gICAgfSlcclxuICAgIGdldCBkaXJlY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgZGlyZWN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RpcmVjdGlvbiA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fZGlyZWN0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5fc3luY1Njcm9sbERpcmVjdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBUaGUgc2Nyb2xsIHRocmVzaG9sZCB2YWx1ZSwgd2hlbiBkcmFnIGV4Y2VlZHMgdGhpcyB2YWx1ZSxcclxuICAgICAqIHJlbGVhc2UgdGhlIG5leHQgcGFnZSB3aWxsIGF1dG9tYXRpY2FsbHkgc2Nyb2xsLCBsZXNzIHRoYW4gdGhlIHJlc3RvcmUuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDmu5rliqjkuLTnlYzlgLzvvIzpu5jorqTljZXkvY3nmb7liIbmr5TvvIzlvZPmi5bmi73otoXlh7ror6XmlbDlgLzml7bvvIzmnb7lvIDkvJroh6rliqjmu5rliqjkuIvkuIDpobXvvIzlsI/kuo7ml7bliJnov5jljp/jgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBzbGlkZTogdHJ1ZSxcclxuICAgICAgICByYW5nZTogWzAsIDEsIDAuMDFdLFxyXG4gICAgICAgIHRvb2x0aXA6ICfmu5rliqjkuLTnlYzlgLzvvIzpu5jorqTljZXkvY3nmb7liIbmr5TvvIzlvZPmi5bmi73otoXlh7ror6XmlbDlgLzml7bvvIzmnb7lvIDkvJroh6rliqjmu5rliqjkuIvkuIDpobXvvIzlsI/kuo7ml7bliJnov5jljp8nLFxyXG4gICAgfSlcclxuICAgIGdldCBzY3JvbGxUaHJlc2hvbGQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbFRocmVzaG9sZDtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc2Nyb2xsVGhyZXNob2xkKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbFRocmVzaG9sZCA9PT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsVGhyZXNob2xkID0gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIENoYW5nZSB0aGUgUGFnZVR1cm5pbmcgZXZlbnQgdGltaW5nIG9mIFBhZ2VWaWV3LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6K6+572uIFBhZ2VWaWV3IFBhZ2VUdXJuaW5nIOS6i+S7tueahOWPkemAgeaXtuacuuOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHNsaWRlOiB0cnVlLFxyXG4gICAgICAgIHJhbmdlOiBbMCwgMSwgMC4wMV0sXHJcbiAgICAgICAgdG9vbHRpcDogJ+iuvue9riBQYWdlVmlldyBQYWdlVHVybmluZyDkuovku7bnmoTlj5HpgIHml7bmnLonLFxyXG4gICAgfSlcclxuICAgIGdldCBwYWdlVHVybmluZ0V2ZW50VGltaW5nKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYWdlVHVybmluZ0V2ZW50VGltaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIHNldCBwYWdlVHVybmluZ0V2ZW50VGltaW5nKHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3BhZ2VUdXJuaW5nRXZlbnRUaW1pbmcgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3BhZ2VUdXJuaW5nRXZlbnRUaW1pbmcgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogVGhlIFBhZ2UgVmlldyBJbmRpY2F0b3IuXHJcbiAgICAgKlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDpobXpnaLop4blm77mjIfnpLrlmajnu4Tku7ZcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0eXBlOiBQYWdlVmlld0luZGljYXRvckNvbXBvbmVudCxcclxuICAgICAgICB0b29sdGlwOiAn6aG16Z2i6KeG5Zu+5oyH56S65Zmo57uE5Lu2JyxcclxuICAgIH0pXHJcbiAgICBnZXQgaW5kaWNhdG9yKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pbmRpY2F0b3I7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGluZGljYXRvcih2YWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9pbmRpY2F0b3IgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2luZGljYXRvciA9IHZhbHVlO1xyXG4gICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLmluZGljYXRvci5zZXRQYWdlVmlldyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGN1clBhZ2VJZHgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1clBhZ2VJZHg7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTaXplTW9kZSA9IFNpemVNb2RlO1xyXG4gICAgcHVibGljIHN0YXRpYyBEaXJlY3Rpb24gPSBEaXJlY3Rpb247XHJcbiAgICBwdWJsaWMgc3RhdGljIEV2ZW50VHlwZSA9IGV4dGVuZHNFbnVtKEV2ZW50VHlwZSwgU2Nyb2xsRXZlbnRUeXBlKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQXV0byBwYWdlIHR1cm5pbmcgdmVsb2NpdHkgdGhyZXNob2xkLiBXaGVuIHVzZXJzIHN3aXBlIHRoZSBQYWdlVmlldyBxdWlja2x5LFxyXG4gICAgICogaXQgd2lsbCBjYWxjdWxhdGUgYSB2ZWxvY2l0eSBiYXNlZCBvbiB0aGUgc2Nyb2xsIGRpc3RhbmNlIGFuZCB0aW1lLFxyXG4gICAgICogaWYgdGhlIGNhbGN1bGF0ZWQgdmVsb2NpdHkgaXMgbGFyZ2VyIHRoYW4gdGhlIHRocmVzaG9sZCwgdGhlbiBpdCB3aWxsIHRyaWdnZXIgcGFnZSB0dXJuaW5nLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5b+r6YCf5ruR5Yqo57+76aG15Li055WM5YC844CCXHJcbiAgICAgKiDlvZPnlKjmiLflv6vpgJ/mu5Hliqjml7bvvIzkvJrmoLnmja7mu5HliqjlvIDlp4vlkoznu5PmnZ/nmoTot53nprvkuI7ml7bpl7TorqHnrpflh7rkuIDkuKrpgJ/luqblgLzvvIxcclxuICAgICAqIOivpeWAvOS4juatpOS4tOeVjOWAvOebuOavlOi+g++8jOWmguaenOWkp+S6juS4tOeVjOWAvO+8jOWImei/m+ihjOiHquWKqOe/u+mhteOAglxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHRvb2x0aXA6ICflv6vpgJ/mu5Hliqjnv7vpobXkuLTnlYzlgLxcXG7lvZPnlKjmiLflv6vpgJ/mu5Hliqjml7bvvIzkvJrmoLnmja7mu5HliqjlvIDlp4vlkoznu5PmnZ/nmoTot53nprvkuI7ml7bpl7TorqHnrpflh7rkuIDkuKrpgJ/luqblgLxcXG7or6XlgLzkuI7mraTkuLTnlYzlgLznm7jmr5TovoPvvIzlpoLmnpzlpKfkuo7kuLTnlYzlgLzvvIzliJnov5vooYzoh6rliqjnv7vpobUnXHJcbiAgICB9KVxyXG4gICAgcHVibGljIGF1dG9QYWdlVHVybmluZ1RocmVzaG9sZCA9IDEwMDtcclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFNjcm9sbEJhckNvbXBvbmVudCxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBvdmVycmlkZTogdHJ1ZSxcclxuICAgIH0pXHJcbiAgICBnZXQgdmVydGljYWxTY3JvbGxCYXIgKCkge1xyXG4gICAgICAgIHJldHVybiBzdXBlci52ZXJ0aWNhbFNjcm9sbEJhcjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgdmVydGljYWxTY3JvbGxCYXIgKHZhbHVlKSB7XHJcbiAgICAgICAgc3VwZXIudmVydGljYWxTY3JvbGxCYXIgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFNjcm9sbEJhckNvbXBvbmVudCxcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBvdmVycmlkZTogdHJ1ZSxcclxuICAgIH0pXHJcbiAgICBnZXQgaG9yaXpvbnRhbFNjcm9sbEJhciAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHN1cGVyLmhvcml6b250YWxTY3JvbGxCYXI7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGhvcml6b250YWxTY3JvbGxCYXIgKHZhbHVlKSB7XHJcbiAgICAgICAgc3VwZXIuaG9yaXpvbnRhbFNjcm9sbEJhciA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAgb3ZlcnJpZGU6IHRydWUsXHJcbiAgICB9KVxyXG4gICAgcHVibGljIGhvcml6b250YWwgPSB0cnVlO1xyXG5cclxuICAgIEBwcm9wZXJ0eSh7XHJcbiAgICAgICAgdmlzaWJsZTogZmFsc2UsXHJcbiAgICAgICAgb3ZlcnJpZGU6IHRydWUsXHJcbiAgICB9KVxyXG4gICAgcHVibGljIHZlcnRpY2FsID0gdHJ1ZTtcclxuXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgIG92ZXJyaWRlOiB0cnVlLFxyXG4gICAgfSlcclxuICAgIHB1YmxpYyBjYW5jZWxJbm5lckV2ZW50cyA9IHRydWU7XHJcblxyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB2aXNpYmxlOiBmYWxzZSxcclxuICAgICAgICBvdmVycmlkZTogdHJ1ZSxcclxuICAgICAgICB0eXBlOiBbQ29tcG9uZW50RXZlbnRIYW5kbGVyXVxyXG4gICAgfSlcclxuICAgIHB1YmxpYyBzY3JvbGxFdmVudHM6IENvbXBvbmVudEV2ZW50SGFuZGxlcltdID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gVGhlIHRpbWUgcmVxdWlyZWQgdG8gdHVybiBvdmVyIGEgcGFnZS4gdW5pdDogc2Vjb25kXHJcbiAgICAgKiBAemgg5q+P5Liq6aG16Z2i57+76aG15pe25omA6ZyA5pe26Ze044CC5Y2V5L2N77ya56eSXHJcbiAgICAgKiBAcHJvcGVydHkge051bWJlcn0gcGFnZVR1cm5pbmdTcGVlZFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHlcclxuICAgIHB1YmxpYyBwYWdlVHVybmluZ1NwZWVkID0gMC4zO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuIFBhZ2VWaWV3IGV2ZW50cyBjYWxsYmFja1xyXG4gICAgICogQHpoIOa7muWKqOinhuWbvueahOS6i+S7tuWbnuiwg+WHveaVsFxyXG4gICAgICovXHJcbiAgICBAcHJvcGVydHkoe1xyXG4gICAgICAgIHR5cGU6IFtDb21wb25lbnRFdmVudEhhbmRsZXJdLFxyXG4gICAgICAgIHRvb2x0aXA6ICfmu5rliqjop4blm77nmoTkuovku7blm57osIPlh73mlbAnLFxyXG4gICAgfSlcclxuICAgIHB1YmxpYyBwYWdlRXZlbnRzOiBDb21wb25lbnRFdmVudEhhbmRsZXJbXSA9IFtdO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIF9zaXplTW9kZSA9IFNpemVNb2RlLlVuaWZpZWQ7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfZGlyZWN0aW9uID0gRGlyZWN0aW9uLkhvcml6b250YWw7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfc2Nyb2xsVGhyZXNob2xkID0gMC41O1xyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX3BhZ2VUdXJuaW5nRXZlbnRUaW1pbmcgPSAwLjE7XHJcbiAgICBAcHJvcGVydHlcclxuICAgIHByb3RlY3RlZCBfaW5kaWNhdG9yOiBQYWdlVmlld0luZGljYXRvckNvbXBvbmVudCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIHByb3RlY3RlZCBfY3VyUGFnZUlkeCA9IDA7XHJcbiAgICBwcm90ZWN0ZWQgX2xhc3RQYWdlSWR4ID0gMDtcclxuICAgIHByb3RlY3RlZCBfcGFnZXM6IE5vZGVbXSA9IFtdO1xyXG4gICAgcHJvdGVjdGVkIF9pbml0Q29udGVudFBvcyA9IG5ldyBWZWMzKCk7XHJcbiAgICBwcm90ZWN0ZWQgX3Njcm9sbENlbnRlck9mZnNldFg6IG51bWJlcltdID0gW107IC8vIOavj+S4gOS4qumhtemdouWxheS4reaXtumcgOimgeeahOWBj+enu+mHj++8iFjvvIlcclxuICAgIHByb3RlY3RlZCBfc2Nyb2xsQ2VudGVyT2Zmc2V0WTogbnVtYmVyW10gPSBbXTsgLy8g5q+P5LiA5Liq6aG16Z2i5bGF5Lit5pe26ZyA6KaB55qE5YGP56e76YeP77yIWe+8iVxyXG4gICAgcHJvdGVjdGVkIF90b3VjaEJlZ2FuUG9zaXRpb24gPSBuZXcgVmVjMygpO1xyXG4gICAgcHJvdGVjdGVkIF90b3VjaEVuZFBvc2l0aW9uID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICBwdWJsaWMgX19wcmVsb2FkKCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihTeXN0ZW1FdmVudFR5cGUuU0laRV9DSEFOR0VELCB0aGlzLl91cGRhdGVBbGxQYWdlc1NpemUsIHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkVuYWJsZSgpIHtcclxuICAgICAgICBzdXBlci5vbkVuYWJsZSgpO1xyXG4gICAgICAgIGlmICghRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5vbihQYWdlVmlld0NvbXBvbmVudC5FdmVudFR5cGUuU0NST0xMX0VOR19XSVRIX1RIUkVTSE9MRCwgdGhpcy5fZGlzcGF0Y2hQYWdlVHVybmluZ0V2ZW50LCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRGlzYWJsZSgpIHtcclxuICAgICAgICBzdXBlci5vbkRpc2FibGUoKTtcclxuICAgICAgICBpZiAoIUVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUub2ZmKFBhZ2VWaWV3Q29tcG9uZW50LkV2ZW50VHlwZS5TQ1JPTExfRU5HX1dJVEhfVEhSRVNIT0xELCB0aGlzLl9kaXNwYXRjaFBhZ2VUdXJuaW5nRXZlbnQsIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb25Mb2FkKCkge1xyXG4gICAgICAgIHRoaXMuX2luaXRQYWdlcygpO1xyXG4gICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLmluZGljYXRvci5zZXRQYWdlVmlldyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLm5vZGUub2ZmKFN5c3RlbUV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX3VwZGF0ZUFsbFBhZ2VzU2l6ZSwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFJldHVybnMgY3VycmVudCBwYWdlIGluZGV4LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6L+U5Zue5b2T5YmN6aG16Z2i57Si5byV44CCXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMg5b2T5YmN6aG16Z2i57Si5byV44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRDdXJyZW50UGFnZUluZGV4KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJQYWdlSWR4O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTZXQgY3VycmVudCBwYWdlIGluZGV4LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6K6+572u5b2T5YmN6aG16Z2i57Si5byV44CCXHJcbiAgICAgKiBAcGFyYW0gaW5kZXgg57Si5byV44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRDdXJyZW50UGFnZUluZGV4KGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvUGFnZShpbmRleCwgMSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFJldHVybnMgYWxsIHBhZ2VzIG9mIHBhZ2V2aWV3LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog6L+U5Zue6KeG5Zu+5Lit55qE5omA5pyJ6aG16Z2i44CCXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMg6L6TPeinhuWbvuaJgOaciemhtemdouOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0UGFnZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhZ2VzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBBdCB0aGUgZW5kIG9mIHRoZSBjdXJyZW50IHBhZ2UgdmlldyB0byBpbnNlcnQgYSBuZXcgdmlldy5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWcqOW9k+WJjemhtemdouinhuWbvueahOWwvumDqOaPkuWFpeS4gOS4quaWsOinhuWbvuOAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYWdlIOaWsOinhuWbvuOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYWRkUGFnZShwYWdlOiBOb2RlKSB7XHJcbiAgICAgICAgaWYgKCFwYWdlIHx8IHRoaXMuX3BhZ2VzLmluZGV4T2YocGFnZSkgIT09IC0xIHx8ICF0aGlzLmNvbnRlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbnRlbnQuYWRkQ2hpbGQocGFnZSk7XHJcbiAgICAgICAgdGhpcy5fcGFnZXMucHVzaChwYWdlKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVQYWdlVmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBJbnNlcnRzIGEgcGFnZSBpbiB0aGUgc3BlY2lmaWVkIGxvY2F0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog5bCG6aG16Z2i5o+S5YWl5oyH5a6a5L2N572u5Lit44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhZ2Ug5paw6KeG5Zu+44CCXHJcbiAgICAgKiBAcGFyYW0gaW5kZXgg5oyH5a6a5L2N572u44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpbnNlcnRQYWdlKHBhZ2U6IE5vZGUsIGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoaW5kZXggPCAwIHx8ICFwYWdlIHx8IHRoaXMuX3BhZ2VzLmluZGV4T2YocGFnZSkgIT09IC0xIHx8ICF0aGlzLmNvbnRlbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYWdlQ291bnQgPSB0aGlzLl9wYWdlcy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGluZGV4ID49IHBhZ2VDb3VudCkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZFBhZ2UocGFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9wYWdlcy5zcGxpY2UoaW5kZXgsIDAsIHBhZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuaW5zZXJ0Q2hpbGQocGFnZSwgaW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVQYWdlVmlldygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogUmVtb3ZlcyBhIHBhZ2UgZnJvbSBQYWdlVmlldy5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOenu+mZpOaMh+WumumhtemdouOAglxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYWdlIOaMh+WumumhtemdouOAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVtb3ZlUGFnZShwYWdlOiBOb2RlKSB7XHJcbiAgICAgICAgaWYgKCFwYWdlIHx8ICF0aGlzLmNvbnRlbnQpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLl9wYWdlcy5pbmRleE9mKHBhZ2UpO1xyXG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgd2FybklEKDQzMDAsIHBhZ2UubmFtZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW1vdmVQYWdlQXRJbmRleChpbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFJlbW92ZXMgYSBwYWdlIGF0IGluZGV4IG9mIFBhZ2VWaWV3LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog56e76Zmk5oyH5a6a5LiL5qCH55qE6aG16Z2i44CCXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGluZGV4IOmhtemdouS4i+agh+OAglxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVtb3ZlUGFnZUF0SW5kZXgoaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHBhZ2VMaXN0ID0gdGhpcy5fcGFnZXM7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBwYWdlTGlzdC5sZW5ndGgpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgY29uc3QgcGFnZSA9IHBhZ2VMaXN0W2luZGV4XTtcclxuICAgICAgICBpZiAoIXBhZ2UgfHwgIXRoaXMuY29udGVudCkgeyByZXR1cm47IH1cclxuICAgICAgICB0aGlzLmNvbnRlbnQucmVtb3ZlQ2hpbGQocGFnZSk7XHJcbiAgICAgICAgcGFnZUxpc3Quc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB0aGlzLl91cGRhdGVQYWdlVmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBSZW1vdmVzIGFsbCBwYWdlcyBmcm9tIFBhZ2VWaWV3LlxyXG4gICAgICpcclxuICAgICAqIEB6aFxyXG4gICAgICog56e76Zmk5omA5pyJ6aG16Z2i44CCXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZW1vdmVBbGxQYWdlcygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY29udGVudCkgeyByZXR1cm47IH1cclxuICAgICAgICBjb25zdCBsb2NQYWdlcyA9IHRoaXMuX3BhZ2VzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBsb2NQYWdlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQucmVtb3ZlQ2hpbGQobG9jUGFnZXNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9wYWdlcy5sZW5ndGggPSAwO1xyXG4gICAgICAgIHRoaXMuX3VwZGF0ZVBhZ2VWaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFNjcm9sbCBQYWdlVmlldyB0byBpbmRleC5cclxuICAgICAqXHJcbiAgICAgKiBAemhcclxuICAgICAqIOa7muWKqOWIsOaMh+WumumhtemdolxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZHggaW5kZXggb2YgcGFnZS5cclxuICAgICAqIEBwYXJhbSB0aW1lSW5TZWNvbmQgc2Nyb2xsaW5nIHRpbWUuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzY3JvbGxUb1BhZ2UoaWR4OiBudW1iZXIsIHRpbWVJblNlY29uZCA9IDAuMykge1xyXG4gICAgICAgIGlmIChpZHggPCAwIHx8IGlkeCA+PSB0aGlzLl9wYWdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fY3VyUGFnZUlkeCA9IGlkeDtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvT2Zmc2V0KHRoaXMuX21vdmVPZmZzZXRWYWx1ZShpZHgpLCB0aW1lSW5TZWNvbmQsIHRydWUpO1xyXG4gICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLmluZGljYXRvci5fY2hhbmdlZFN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIG92ZXJyaWRlIHRoZSBtZXRob2Qgb2YgU2Nyb2xsVmlld1xyXG4gICAgcHVibGljIGdldFNjcm9sbEVuZGVkRXZlbnRUaW1pbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGFnZVR1cm5pbmdFdmVudFRpbWluZztcclxuICAgIH1cclxuXHJcbiAgICAvLyDliLfmlrDpobXpnaLop4blm75cclxuICAgIHByb3RlY3RlZCBfdXBkYXRlUGFnZVZpZXcoKSB7XHJcbiAgICAgICAgLy8g5b2T6aG16Z2i5pWw57uE5Y+Y5YyW5pe25L+u5pS5IGNvbnRlbnQg5aSn5bCPXHJcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5jb250ZW50IS5nZXRDb21wb25lbnQoTGF5b3V0Q29tcG9uZW50KTtcclxuICAgICAgICBpZiAobGF5b3V0ICYmIGxheW91dC5lbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGxheW91dC51cGRhdGVMYXlvdXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHBhZ2VDb3VudCA9IHRoaXMuX3BhZ2VzLmxlbmd0aDtcclxuICAgICAgICBpZiAodGhpcy5fY3VyUGFnZUlkeCA+PSBwYWdlQ291bnQpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VyUGFnZUlkeCA9IHBhZ2VDb3VudCA9PT0gMCA/IDAgOiBwYWdlQ291bnQgLSAxO1xyXG4gICAgICAgICAgICB0aGlzLl9sYXN0UGFnZUlkeCA9IHRoaXMuX2N1clBhZ2VJZHg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/m+ihjOaOkuW6j1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRQb3MgPSB0aGlzLl9pbml0Q29udGVudFBvcztcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZ2VDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZ2UgPSB0aGlzLl9wYWdlc1tpXTtcclxuICAgICAgICAgICAgLy8gcGFnZS5zZXRTaWJsaW5nSW5kZXgoaSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHBvcyA9IHBhZ2UucG9zaXRpb247XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkhvcml6b250YWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Njcm9sbENlbnRlck9mZnNldFhbaV0gPSBNYXRoLmFicyhjb250ZW50UG9zLnggKyBwb3MueCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zY3JvbGxDZW50ZXJPZmZzZXRZW2ldID0gTWF0aC5hYnMoY29udGVudFBvcy55ICsgcG9zLnkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDliLfmlrAgaW5kaWNhdG9yIOS/oeaBr+S4jueKtuaAgVxyXG4gICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLmluZGljYXRvci5fcmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDliLfmlrDmiYDmnInpobXpnaLnmoTlpKflsI9cclxuICAgIHByb3RlY3RlZCBfdXBkYXRlQWxsUGFnZXNTaXplKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jb250ZW50IHx8ICF0aGlzLnZpZXcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3NpemVNb2RlICE9PSBTaXplTW9kZS5VbmlmaWVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbG9jUGFnZXMgPSBFRElUT1IgPyB0aGlzLmNvbnRlbnQuY2hpbGRyZW4gOiB0aGlzLl9wYWdlcztcclxuICAgICAgICBjb25zdCBzZWxmU2l6ZSA9IHRoaXMudmlldy5nZXRDb250ZW50U2l6ZSgpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBsb2NQYWdlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBsb2NQYWdlc1tpXS5zZXRDb250ZW50U2l6ZShzZWxmU2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfaGFuZGxlUmVsZWFzZUxvZ2ljKCkge1xyXG4gICAgICAgIHRoaXMuX2F1dG9TY3JvbGxUb1BhZ2UoKTtcclxuICAgICAgICBpZiAodGhpcy5fc2Nyb2xsaW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Njcm9sbGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2F1dG9TY3JvbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoRXZlbnQoUGFnZVZpZXdDb21wb25lbnQuRXZlbnRUeXBlLlNDUk9MTF9FTkRFRCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9vblRvdWNoQmVnYW4oZXZlbnQ6IEV2ZW50VG91Y2gsIGNhcHR1cmVMaXN0ZW5lcnM6IGFueSkge1xyXG4gICAgICAgIGV2ZW50LnRvdWNoIS5nZXRVSUxvY2F0aW9uKF90ZW1wX3ZlYzIpO1xyXG4gICAgICAgIFZlYzMuc2V0KHRoaXMuX3RvdWNoQmVnYW5Qb3NpdGlvbiwgX3RlbXBfdmVjMi54LCBfdGVtcF92ZWMyLnksIDApO1xyXG4gICAgICAgIHN1cGVyLl9vblRvdWNoQmVnYW4oZXZlbnQsIGNhcHR1cmVMaXN0ZW5lcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfb25Ub3VjaE1vdmVkKGV2ZW50OiBFdmVudFRvdWNoLCBjYXB0dXJlTGlzdGVuZXJzOiBhbnkpIHtcclxuICAgICAgICBzdXBlci5fb25Ub3VjaE1vdmVkKGV2ZW50LCBjYXB0dXJlTGlzdGVuZXJzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX29uVG91Y2hFbmRlZChldmVudDogRXZlbnRUb3VjaCwgY2FwdHVyZUxpc3RlbmVyczogYW55KSB7XHJcbiAgICAgICAgZXZlbnQudG91Y2ghLmdldFVJTG9jYXRpb24oX3RlbXBfdmVjMik7XHJcbiAgICAgICAgVmVjMy5zZXQodGhpcy5fdG91Y2hFbmRQb3NpdGlvbiwgX3RlbXBfdmVjMi54LCBfdGVtcF92ZWMyLnksIDApO1xyXG4gICAgICAgIHN1cGVyLl9vblRvdWNoRW5kZWQoZXZlbnQsIGNhcHR1cmVMaXN0ZW5lcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfb25Ub3VjaENhbmNlbGxlZChldmVudDogRXZlbnRUb3VjaCwgY2FwdHVyZUxpc3RlbmVyczogYW55KSB7XHJcbiAgICAgICAgZXZlbnQudG91Y2ghLmdldFVJTG9jYXRpb24oX3RlbXBfdmVjMik7XHJcbiAgICAgICAgVmVjMy5zZXQodGhpcy5fdG91Y2hFbmRQb3NpdGlvbiwgX3RlbXBfdmVjMi54LCBfdGVtcF92ZWMyLnksIDApO1xyXG4gICAgICAgIHN1cGVyLl9vblRvdWNoQ2FuY2VsbGVkKGV2ZW50LCBjYXB0dXJlTGlzdGVuZXJzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX29uTW91c2VXaGVlbCgpIHsgfVxyXG5cclxuICAgIHByb3RlY3RlZCBfc3luY1Njcm9sbERpcmVjdGlvbigpIHtcclxuICAgICAgICB0aGlzLmhvcml6b250YWwgPSB0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkhvcml6b250YWw7XHJcbiAgICAgICAgdGhpcy52ZXJ0aWNhbCA9IHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uVmVydGljYWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9zeW5jU2l6ZU1vZGUoKSB7XHJcbiAgICAgICAgY29uc3QgdmlldyA9IHRoaXMudmlldztcclxuICAgICAgICBpZiAoIXRoaXMuY29udGVudCB8fCAhdmlldykgeyByZXR1cm47IH1cclxuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmNvbnRlbnQuZ2V0Q29tcG9uZW50KExheW91dENvbXBvbmVudCk7XHJcblxyXG4gICAgICAgIGlmIChsYXlvdXQpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3NpemVNb2RlID09PSBTaXplTW9kZS5GcmVlICYmIHRoaXMuX3BhZ2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RQYWdlID0gdGhpcy5fcGFnZXNbdGhpcy5fcGFnZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5Ib3Jpem9udGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0LnBhZGRpbmdMZWZ0ID0gKHZpZXcud2lkdGggLSB0aGlzLl9wYWdlc1swXS53aWR0aCkgLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dC5wYWRkaW5nUmlnaHQgPSAodmlldy53aWR0aCAtIGxhc3RQYWdlLndpZHRoKSAvIDI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLlZlcnRpY2FsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0LnBhZGRpbmdUb3AgPSAodmlldy5oZWlnaHQgLSB0aGlzLl9wYWdlc1swXS5oZWlnaHQpIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXQucGFkZGluZ0JvdHRvbSA9ICh2aWV3LmhlaWdodCAtIGxhc3RQYWdlLmhlaWdodCkgLyAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxheW91dC51cGRhdGVMYXlvdXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yid5aeL5YyW6aG16Z2iXHJcbiAgICBwcm90ZWN0ZWQgX2luaXRQYWdlcygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY29udGVudCkgeyByZXR1cm47IH1cclxuICAgICAgICB0aGlzLl9pbml0Q29udGVudFBvcyA9IHRoaXMuY29udGVudC5wb3NpdGlvbjtcclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY29udGVudC5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZ2UgPSBjaGlsZHJlbltpXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhZ2VzLmluZGV4T2YocGFnZSkgPj0gMCkgeyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICB0aGlzLl9wYWdlcy5wdXNoKHBhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zeW5jU2Nyb2xsRGlyZWN0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5fc3luY1NpemVNb2RlKCk7XHJcbiAgICAgICAgdGhpcy5fdXBkYXRlUGFnZVZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2Rpc3BhdGNoUGFnZVR1cm5pbmdFdmVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5fbGFzdFBhZ2VJZHggPT09IHRoaXMuX2N1clBhZ2VJZHgpIHsgcmV0dXJuOyB9XHJcbiAgICAgICAgdGhpcy5fbGFzdFBhZ2VJZHggPSB0aGlzLl9jdXJQYWdlSWR4O1xyXG4gICAgICAgIENvbXBvbmVudEV2ZW50SGFuZGxlci5lbWl0RXZlbnRzKHRoaXMucGFnZUV2ZW50cywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ub2RlLmVtaXQoRXZlbnRUeXBlLlBBR0VfVFVSTklORywgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5b+r6YCf5ruR5YqoXHJcbiAgICBwcm90ZWN0ZWQgX2lzUXVpY2tseVNjcm9sbGFibGUodG91Y2hNb3ZlVmVsb2NpdHk6IFZlYzMpIHtcclxuICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5Ib3Jpem9udGFsKSB7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0b3VjaE1vdmVWZWxvY2l0eS54KSA+IHRoaXMuYXV0b1BhZ2VUdXJuaW5nVGhyZXNob2xkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLlZlcnRpY2FsKSB7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0b3VjaE1vdmVWZWxvY2l0eS55KSA+IHRoaXMuYXV0b1BhZ2VUdXJuaW5nVGhyZXNob2xkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g6YCa6L+HIGlkeCDojrflj5blgY/np7vlgLzmlbDlgLxcclxuICAgIHByb3RlY3RlZCBfbW92ZU9mZnNldFZhbHVlKGlkeDogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gbmV3IFZlYzMoKTtcclxuICAgICAgICBpZiAodGhpcy5fc2l6ZU1vZGUgPT09IFNpemVNb2RlLkZyZWUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uSG9yaXpvbnRhbCkge1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0LnggPSB0aGlzLl9zY3JvbGxDZW50ZXJPZmZzZXRYW2lkeF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5WZXJ0aWNhbCkge1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0LnkgPSB0aGlzLl9zY3JvbGxDZW50ZXJPZmZzZXRZW2lkeF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy52aWV3O1xyXG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvZmZzZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uSG9yaXpvbnRhbCkge1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0LnggPSBpZHggKiB2aWV3LndpZHRoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uVmVydGljYWwpIHtcclxuICAgICAgICAgICAgICAgIG9mZnNldC55ID0gaWR4ICogdmlldy5oZWlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBvZmZzZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIF9nZXREcmFnRGlyZWN0aW9uKG1vdmVPZmZzZXQ6IFZlYzMpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uSG9yaXpvbnRhbCkge1xyXG4gICAgICAgICAgICBpZiAobW92ZU9mZnNldC54ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIChtb3ZlT2Zmc2V0LnggPiAwID8gMSA6IC0xKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOeUseS6jua7muWKqCBZIOi9tOeahOWOn+eCueWcqOWcqOWPs+S4iuinkuaJgOS7peW6lOivpeaYr+Wwj+S6jiAwXHJcbiAgICAgICAgICAgIGlmIChtb3ZlT2Zmc2V0LnkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gKG1vdmVPZmZzZXQueSA8IDAgPyAxIDogLTEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDmmK/lkKbotoXov4foh6rliqjmu5rliqjkuLTnlYzlgLxcclxuICAgIHByb3RlY3RlZCBfaXNTY3JvbGxhYmxlKG9mZnNldDogVmVjMywgaW5kZXg6IG51bWJlciwgbmV4dEluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2l6ZU1vZGUgPT09IFNpemVNb2RlLkZyZWUpIHtcclxuICAgICAgICAgICAgbGV0IGN1clBhZ2VDZW50ZXIgPSAwO1xyXG4gICAgICAgICAgICBsZXQgbmV4dFBhZ2VDZW50ZXIgPSAwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5Ib3Jpem9udGFsKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJQYWdlQ2VudGVyID0gdGhpcy5fc2Nyb2xsQ2VudGVyT2Zmc2V0WFtpbmRleF07XHJcbiAgICAgICAgICAgICAgICBuZXh0UGFnZUNlbnRlciA9IHRoaXMuX3Njcm9sbENlbnRlck9mZnNldFhbbmV4dEluZGV4XTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhvZmZzZXQueCkgPj0gTWF0aC5hYnMoY3VyUGFnZUNlbnRlciAtIG5leHRQYWdlQ2VudGVyKSAqIHRoaXMuc2Nyb2xsVGhyZXNob2xkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uVmVydGljYWwpIHtcclxuICAgICAgICAgICAgICAgIGN1clBhZ2VDZW50ZXIgPSB0aGlzLl9zY3JvbGxDZW50ZXJPZmZzZXRZW2luZGV4XTtcclxuICAgICAgICAgICAgICAgIG5leHRQYWdlQ2VudGVyID0gdGhpcy5fc2Nyb2xsQ2VudGVyT2Zmc2V0WVtuZXh0SW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKG9mZnNldC55KSA+PSBNYXRoLmFicyhjdXJQYWdlQ2VudGVyIC0gbmV4dFBhZ2VDZW50ZXIpICogdGhpcy5zY3JvbGxUaHJlc2hvbGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLnZpZXc7XHJcbiAgICAgICAgICAgIGlmICghdmlldykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkhvcml6b250YWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhvZmZzZXQueCkgPj0gdmlldy53aWR0aCAqIHRoaXMuc2Nyb2xsVGhyZXNob2xkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uVmVydGljYWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhvZmZzZXQueSkgPj0gdmlldy5oZWlnaHQgKiB0aGlzLnNjcm9sbFRocmVzaG9sZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgX2F1dG9TY3JvbGxUb1BhZ2UoKSB7XHJcbiAgICAgICAgY29uc3QgYm91bmNlQmFja1N0YXJ0ZWQgPSB0aGlzLl9zdGFydEJvdW5jZUJhY2tJZk5lZWRlZCgpO1xyXG4gICAgICAgIC8vIE5vdGU6XHJcbiAgICAgICAgY29uc3QgbW92ZU9mZnNldCA9IG5ldyBWZWMzKCk7XHJcbiAgICAgICAgVmVjMy5zdWJ0cmFjdChtb3ZlT2Zmc2V0LCB0aGlzLl90b3VjaEJlZ2FuUG9zaXRpb24sIHRoaXMuX3RvdWNoRW5kUG9zaXRpb24pO1xyXG4gICAgICAgIC8vIHRoaXMuX3RvdWNoQmVnYW5Qb3NpdGlvbi5zdWJ0cmFjdCh0aGlzLl90b3VjaEVuZFBvc2l0aW9uKTtcclxuICAgICAgICBpZiAoYm91bmNlQmFja1N0YXJ0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgZHJhZ0RpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdEaXJlY3Rpb24obW92ZU9mZnNldCk7XHJcbiAgICAgICAgICAgIGlmIChkcmFnRGlyZWN0aW9uID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRyYWdEaXJlY3Rpb24gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJQYWdlSWR4ID0gdGhpcy5fcGFnZXMubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1clBhZ2VJZHggPSAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmRpY2F0b3IuX2NoYW5nZWRTdGF0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuX2N1clBhZ2VJZHg7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRJbmRleCA9IGluZGV4ICsgdGhpcy5fZ2V0RHJhZ0RpcmVjdGlvbihtb3ZlT2Zmc2V0KTtcclxuICAgICAgICAgICAgY29uc3QgdGltZUluU2Vjb25kID0gdGhpcy5wYWdlVHVybmluZ1NwZWVkICogTWF0aC5hYnMoaW5kZXggLSBuZXh0SW5kZXgpO1xyXG4gICAgICAgICAgICBpZiAobmV4dEluZGV4IDwgdGhpcy5fcGFnZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNTY3JvbGxhYmxlKG1vdmVPZmZzZXQsIGluZGV4LCBuZXh0SW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb1BhZ2UobmV4dEluZGV4LCB0aW1lSW5TZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvdWNoTW92ZVZlbG9jaXR5ID0gdGhpcy5fY2FsY3VsYXRlVG91Y2hNb3ZlVmVsb2NpdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNRdWlja2x5U2Nyb2xsYWJsZSh0b3VjaE1vdmVWZWxvY2l0eSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb1BhZ2UobmV4dEluZGV4LCB0aW1lSW5TZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsVG9QYWdlKGluZGV4LCB0aW1lSW5TZWNvbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmNjLlBhZ2VWaWV3Q29tcG9uZW50ID0gUGFnZVZpZXdDb21wb25lbnQ7XHJcblxyXG4vKipcclxuICogQGVuXHJcbiAqIE5vdGU6IFRoaXMgZXZlbnQgaXMgZW1pdHRlZCBmcm9tIHRoZSBub2RlIHRvIHdoaWNoIHRoZSBjb21wb25lbnQgYmVsb25ncy5cclxuICogQHpoXHJcbiAqIOazqOaEj++8muatpOS6i+S7tuaYr+S7juivpee7hOS7tuaJgOWxnueahCBOb2RlIOS4iumdoua0vuWPkeWHuuadpeeahO+8jOmcgOimgeeUqCBub2RlLm9uIOadpeebkeWQrOOAglxyXG4gKiBAZXZlbnQgcGFnZS10dXJuaW5nXHJcbiAqIEBwYXJhbSB7RXZlbnQuRXZlbnRDdXN0b219IGV2ZW50XHJcbiAqIEBwYXJhbSB7UGFnZVZpZXd9IHBhZ2VWaWV3IC0gVGhlIFBhZ2VWaWV3IGNvbXBvbmVudC5cclxuICovXHJcbiJdfQ==