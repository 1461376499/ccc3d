(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "../../../../core/data/class-decorator.js", "../../../../core/event/index.js", "../../../../core/math/index.js", "../../assets/physic-material.js", "../../physics-system.js", "../../../../core/index.js", "../../../../core/default-constants.js"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("../../../../core/data/class-decorator.js"), require("../../../../core/event/index.js"), require("../../../../core/math/index.js"), require("../../assets/physic-material.js"), require("../../physics-system.js"), require("../../../../core/index.js"), require("../../../../core/default-constants.js"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.classDecorator, global.index, global.index, global.physicMaterial, global.physicsSystem, global.index, global.defaultConstants);
    global.colliderComponent = mod.exports;
  }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (_exports, _classDecorator, _index, _index2, _physicMaterial, _physicsSystem, _index3, _defaultConstants) {
  "use strict";

  Object.defineProperty(_exports, "__esModule", {
    value: true
  });
  _exports.ColliderComponent = void 0;

  var _dec, _dec2, _dec3, _dec4, _dec5, _class, _class2, _descriptor, _descriptor2, _descriptor3, _temp;

  function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

  function _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }

  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

  function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

  function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

  function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

  function _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }

  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }

  /**
   * @en
   * Base class of collider.
   * @zh
   * 碰撞器的基类。
   */
  var ColliderComponent = (_dec = (0, _classDecorator.ccclass)('cc.ColliderComponent'), _dec2 = (0, _classDecorator.property)({
    type: _physicMaterial.PhysicMaterial,
    displayName: 'Material',
    displayOrder: -1,
    tooltip: '源材质'
  }), _dec3 = (0, _classDecorator.property)({
    displayOrder: 0,
    tooltip: '是否与其它碰撞器产生碰撞，并产生物理行为'
  }), _dec4 = (0, _classDecorator.property)({
    type: _index2.Vec3,
    displayOrder: 1,
    tooltip: '形状的中心点（与所在 Node 中心点的相对位置）'
  }), _dec5 = (0, _classDecorator.property)({
    type: _physicMaterial.PhysicMaterial
  }), _dec(_class = (_class2 = (_temp = /*#__PURE__*/function (_Eventify) {
    _inherits(ColliderComponent, _Eventify);

    _createClass(ColliderComponent, [{
      key: "sharedMaterial",
      /// PUBLIC PROPERTY GETTER\SETTER ///

      /**
       * @en
       * Gets or sets the physical material for this collider.
       * @zh
       * 获取或设置此碰撞器的物理材质。
       */
      get: function get() {
        return this._material;
      },
      set: function set(value) {
        if (_defaultConstants.EDITOR) {
          this._material = value;
        } else {
          this.material = value;
        }
      }
      /**
       * @en
       * Gets or sets the physics material for this collider, which in Shared state will generate a new instance.
       * @zh
       * 获取或设置此碰撞器的物理材质，共享状态下获取将会生成新的实例。
       */

    }, {
      key: "material",
      get: function get() {
        if (!_defaultConstants.PHYSICS_BUILTIN) {
          if (this._isSharedMaterial && this._material != null) {
            this._material.off('physics_material_update', this._updateMaterial, this);

            this._material = this._material.clone();

            this._material.on('physics_material_update', this._updateMaterial, this);

            this._isSharedMaterial = false;
          }
        }

        return this._material;
      },
      set: function set(value) {
        if (!_defaultConstants.EDITOR) {
          if (!_defaultConstants.PHYSICS_BUILTIN) {
            if (value != null && this._material != null) {
              if (this._material._uuid != value._uuid) {
                this._material.off('physics_material_update', this._updateMaterial, this);

                value.on('physics_material_update', this._updateMaterial, this);
                this._isSharedMaterial = false;
                this._material = value;
              }
            } else if (value != null && this._material == null) {
              value.on('physics_material_update', this._updateMaterial, this);
              this._material = value;
            } else if (value == null && this._material != null) {
              this._material.off('physics_material_update', this._updateMaterial, this);

              this._material = value;
            }

            this._updateMaterial();
          } else {
            this._material = value;
          }
        }
      }
      /**
       * @en
       * Gets or sets the collider is trigger, this will be always trigger if using builtin.
       * @zh
       * 获取或设置碰撞器是否为触发器，若使用 builtin ，属性值无论真假 ，此碰撞器都为触发器。
       */

    }, {
      key: "isTrigger",
      get: function get() {
        return this._isTrigger;
      },
      set: function set(value) {
        this._isTrigger = value;

        if (!_defaultConstants.EDITOR) {
          this._shape.setAsTrigger(this._isTrigger);
        }
      }
      /**
       * @en
       * Gets or sets the center of the collider, in local space.
       * @zh
       * 获取或设置碰撞器的中心点。
       */

    }, {
      key: "center",
      get: function get() {
        return this._center;
      },
      set: function set(value) {
        _index2.Vec3.copy(this._center, value);

        if (!_defaultConstants.EDITOR) {
          this._shape.setCenter(this._center);
        }
      }
      /**
       * @en
       * Gets the collider attached rigid-body, this may be null
       * @zh
       * 获取碰撞器所绑定的刚体组件，可能为 null
       */

    }, {
      key: "attachedRigidBody",
      get: function get() {
        return this.shape.attachedRigidBody;
      }
      /**
       * @en
       * Gets the wrapper object, through which the lowLevel instance can be accessed.
       * @zh
       * 获取封装对象，通过此对象可以访问到底层实例。
       */

    }, {
      key: "shape",
      get: function get() {
        return this._shape;
      } /// PRIVATE PROPERTY ///

    }, {
      key: "_assertOnload",
      get: function get() {
        var r = this._isOnLoadCalled == 0;

        if (r) {
          (0, _index3.error)('Physics Error: Please make sure that the node has been added to the scene');
        }

        return !r;
      }
    }]);

    function ColliderComponent() {
      var _this;

      _classCallCheck(this, ColliderComponent);

      _this = _possibleConstructorReturn(this, _getPrototypeOf(ColliderComponent).call(this));
      _this._isSharedMaterial = true;

      _initializerDefineProperty(_this, "_material", _descriptor, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_isTrigger", _descriptor2, _assertThisInitialized(_this));

      _initializerDefineProperty(_this, "_center", _descriptor3, _assertThisInitialized(_this));

      return _this;
    }
    /**
     * @en
     * Registers callbacks associated with triggered or collision events.
     * @zh
     * 注册触发或碰撞事件相关的回调。
     * @param type - The event type, onTriggerEnter|onTriggerStay|onTriggerExit|onCollisionEnter|onCollisionStay|onCollisionExit;
     * @param callback - The event callback, signature:`(event?:ICollisionEvent|ITriggerEvent)=>void`.
     * @param target - The event callback target.
     */


    _createClass(ColliderComponent, [{
      key: "on",
      value: function on(type, callback, target, once) {
        _get(_getPrototypeOf(ColliderComponent.prototype), "on", this).call(this, type, callback, target, once);
      }
      /**
       * @en
       * Unregisters callbacks associated with trigger or collision events that have been registered.
       * @zh
       * 取消已经注册的触发或碰撞事件相关的回调。
       * @param type - The event type, onTriggerEnter|onTriggerStay|onTriggerExit|onCollisionEnter|onCollisionStay|onCollisionExit;
       * @param callback - The event callback, signature:`(event?:ICollisionEvent|ITriggerEvent)=>void`.
       * @param target - The event callback target.
       */

    }, {
      key: "off",
      value: function off(type, callback, target) {
        _get(_getPrototypeOf(ColliderComponent.prototype), "off", this).call(this, type, callback, target);
      }
      /**
       * @en
       * Registers a callback associated with a trigger or collision event, which is automatically unregistered once executed.
       * @zh
       * 注册触发或碰撞事件相关的回调，执行一次后会自动取消注册。
       * @param type - The event type, onTriggerEnter|onTriggerStay|onTriggerExit|onCollisionEnter|onCollisionStay|onCollisionExit;
       * @param callback - The event callback, signature:`(event?:ICollisionEvent|ITriggerEvent)=>void`.
       * @param target - The event callback target.
       */

    }, {
      key: "once",
      value: function once(type, callback, target) {
        _get(_getPrototypeOf(ColliderComponent.prototype), "once", this).call(this, type, callback, target);
      } /// GROUP MASK ///

      /**
       * @en
       * Sets the group value.
       * @zh
       * 设置分组值。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "setGroup",
      value: function setGroup(v) {
        this._shape.setGroup(v);
      }
      /**
       * @en
       * Gets the group value.
       * @zh
       * 获取分组值。
       * @returns 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "getGroup",
      value: function getGroup() {
        return this._shape.getGroup();
      }
      /**
       * @en
       * Add a grouping value to fill in the group you want to join.
       * @zh
       * 添加分组值，可填要加入的 group。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "addGroup",
      value: function addGroup(v) {
        this._shape.addGroup(v);
      }
      /**
       * @en
       * Subtract the grouping value to fill in the group to be removed.
       * @zh
       * 减去分组值，可填要移除的 group。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "removeGroup",
      value: function removeGroup(v) {
        this._shape.removeGroup(v);
      }
      /**
       * @en
       * Gets the mask value.
       * @zh
       * 获取掩码值。
       * @returns 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "getMask",
      value: function getMask() {
        return this._shape.getMask();
      }
      /**
       * @en
       * Sets the mask value.
       * @zh
       * 设置掩码值。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "setMask",
      value: function setMask(v) {
        this._shape.setMask(v);
      }
      /**
       * @en
       * Add mask values to fill in groups that need to be checked.
       * @zh
       * 添加掩码值，可填入需要检查的 group。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "addMask",
      value: function addMask(v) {
        this._shape.addMask(v);
      }
      /**
       * @en
       * Subtract the mask value to fill in the group that does not need to be checked.
       * @zh
       * 减去掩码值，可填入不需要检查的 group。
       * @param v - 整数，范围为 2 的 0 次方 到 2 的 31 次方
       */

    }, {
      key: "removeMask",
      value: function removeMask(v) {
        this._shape.removeMask(v);
      } /// COMPONENT LIFECYCLE ///

    }, {
      key: "__preload",
      value: function __preload() {
        if (!_defaultConstants.EDITOR) {
          this._shape.initialize(this);
        }
      }
    }, {
      key: "onLoad",
      value: function onLoad() {
        if (!_defaultConstants.EDITOR) {
          if (!_defaultConstants.PHYSICS_BUILTIN) {
            this.sharedMaterial = this._material == null ? _physicsSystem.PhysicsSystem.instance.defaultMaterial : this._material;
          }

          this._shape.onLoad();
        }
      }
    }, {
      key: "onEnable",
      value: function onEnable() {
        if (!_defaultConstants.EDITOR) {
          this._shape.onEnable();
        }
      }
    }, {
      key: "onDisable",
      value: function onDisable() {
        if (!_defaultConstants.EDITOR) {
          this._shape.onDisable();
        }
      }
    }, {
      key: "onDestroy",
      value: function onDestroy() {
        if (!_defaultConstants.EDITOR) {
          if (this._material) {
            this._material.off('physics_material_update', this._updateMaterial, this);
          }

          this._shape.onDestroy();
        }
      }
    }, {
      key: "_updateMaterial",
      value: function _updateMaterial() {
        if (!_defaultConstants.EDITOR) {
          this._shape.setMaterial(this._material);
        }
      }
    }]);

    return ColliderComponent;
  }((0, _index.Eventify)(_index3.Component)), _temp), (_applyDecoratedDescriptor(_class2.prototype, "sharedMaterial", [_dec2], Object.getOwnPropertyDescriptor(_class2.prototype, "sharedMaterial"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "isTrigger", [_dec3], Object.getOwnPropertyDescriptor(_class2.prototype, "isTrigger"), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, "center", [_dec4], Object.getOwnPropertyDescriptor(_class2.prototype, "center"), _class2.prototype), _descriptor = _applyDecoratedDescriptor(_class2.prototype, "_material", [_dec5], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return null;
    }
  }), _descriptor2 = _applyDecoratedDescriptor(_class2.prototype, "_isTrigger", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return false;
    }
  }), _descriptor3 = _applyDecoratedDescriptor(_class2.prototype, "_center", [_classDecorator.property], {
    configurable: true,
    enumerable: true,
    writable: true,
    initializer: function initializer() {
      return new _index2.Vec3();
    }
  })), _class2)) || _class);
  _exports.ColliderComponent = ColliderComponent;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkY6L2plbmtpbnMvd29ya3NwYWNlL0NyZWF0b3JfM0QvZWRpdG9yLTNkL3Jlc291cmNlcy8zZC9lbmdpbmUvY29jb3MvcGh5c2ljcy9mcmFtZXdvcmsvY29tcG9uZW50cy9jb2xsaWRlci9jb2xsaWRlci1jb21wb25lbnQudHMiXSwibmFtZXMiOlsiQ29sbGlkZXJDb21wb25lbnQiLCJ0eXBlIiwiUGh5c2ljTWF0ZXJpYWwiLCJkaXNwbGF5TmFtZSIsImRpc3BsYXlPcmRlciIsInRvb2x0aXAiLCJWZWMzIiwiX21hdGVyaWFsIiwidmFsdWUiLCJFRElUT1IiLCJtYXRlcmlhbCIsIlBIWVNJQ1NfQlVJTFRJTiIsIl9pc1NoYXJlZE1hdGVyaWFsIiwib2ZmIiwiX3VwZGF0ZU1hdGVyaWFsIiwiY2xvbmUiLCJvbiIsIl91dWlkIiwiX2lzVHJpZ2dlciIsIl9zaGFwZSIsInNldEFzVHJpZ2dlciIsIl9jZW50ZXIiLCJjb3B5Iiwic2V0Q2VudGVyIiwic2hhcGUiLCJhdHRhY2hlZFJpZ2lkQm9keSIsInIiLCJfaXNPbkxvYWRDYWxsZWQiLCJjYWxsYmFjayIsInRhcmdldCIsIm9uY2UiLCJ2Iiwic2V0R3JvdXAiLCJnZXRHcm91cCIsImFkZEdyb3VwIiwicmVtb3ZlR3JvdXAiLCJnZXRNYXNrIiwic2V0TWFzayIsImFkZE1hc2siLCJyZW1vdmVNYXNrIiwiaW5pdGlhbGl6ZSIsInNoYXJlZE1hdGVyaWFsIiwiUGh5c2ljc1N5c3RlbSIsImluc3RhbmNlIiwiZGVmYXVsdE1hdGVyaWFsIiwib25Mb2FkIiwib25FbmFibGUiLCJvbkRpc2FibGUiLCJvbkRlc3Ryb3kiLCJzZXRNYXRlcmlhbCIsIkNvbXBvbmVudCIsInByb3BlcnR5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWVBOzs7Ozs7TUFPYUEsaUIsV0FEWiw2QkFBUSxzQkFBUixDLFVBV0ksOEJBQVM7QUFDTkMsSUFBQUEsSUFBSSxF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N0Y7QUFDSDs7QUFDRCxlQUFLWSxNQUFMLENBQVkwQixNQUFaO0FBQ0g7QUFFSjs7O2lDQUVxQjtBQUNsQixZQUFJLENBQUNwQyx3QkFBTCxFQUFhO0FBQ1QsZUFBS1UsTUFBTCxDQUFZMkIsUUFBWjtBQUNIO0FBQ0o7OztrQ0FFc0I7QUFDbkIsWUFBSSxDQUFDckMsd0JBQUwsRUFBYTtBQUNULGVBQUtVLE1BQUwsQ0FBWTRCLFNBQVo7QUFDSDtBQUNKOzs7a0NBRXNCO0FBQ25CLFlBQUksQ0FBQ3RDLHdCQUFMLEVBQWE7QUFDVCxjQUFJLEtBQUtGLFNBQVQsRUFBb0I7QUFDaEIsaUJBQUtBLFNBQUwsQ0FBZU0sR0FBZixDQUFtQix5QkFBbkIsRUFBOEMsS0FBS0MsZUFBbkQsRUFBb0UsSUFBcEU7QUFDSDs7QUFDRCxlQUFLSyxNQUFMLENBQVk2QixTQUFaO0FBQ0g7QUFDSjs7O3dDQUUwQjtBQUN2QixZQUFJLENBQUN2Qyx3QkFBTCxFQUFhO0FBQ1QsZUFBS1UsTUFBTCxDQUFZOEIsV0FBWixDQUF3QixLQUFLMUMsU0FBN0I7QUFDSDtBQUNKOzs7O0lBeFVrQyxxQkFBUzJDLGlCQUFULEM7Ozs7O2FBNElVLEk7O2lGQUU1Q0Msd0I7Ozs7O2FBQytCLEs7OzhFQUUvQkEsd0I7Ozs7O2FBQ2tDLElBQUk3QyxZQUFKLEUiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGNhdGVnb3J5IHBoeXNpY3NcclxuICovXHJcblxyXG5pbXBvcnQgeyBjY2NsYXNzLCBwcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uLy4uL2NvcmUvZGF0YS9jbGFzcy1kZWNvcmF0b3InO1xyXG5pbXBvcnQgeyBFdmVudGlmeSB9IGZyb20gJy4uLy4uLy4uLy4uL2NvcmUvZXZlbnQnO1xyXG5pbXBvcnQgeyBWZWMzIH0gZnJvbSAnLi4vLi4vLi4vLi4vY29yZS9tYXRoJztcclxuaW1wb3J0IHsgQ29sbGlzaW9uQ2FsbGJhY2ssIENvbGxpc2lvbkV2ZW50VHlwZSwgVHJpZ2dlckNhbGxiYWNrLCBUcmlnZ2VyRXZlbnRUeXBlIH0gZnJvbSAnLi4vLi4vcGh5c2ljcy1pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBSaWdpZEJvZHlDb21wb25lbnQgfSBmcm9tICcuLi9yaWdpZC1ib2R5LWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFBoeXNpY01hdGVyaWFsIH0gZnJvbSAnLi4vLi4vYXNzZXRzL3BoeXNpYy1tYXRlcmlhbCc7XHJcbmltcG9ydCB7IFBoeXNpY3NTeXN0ZW0gfSBmcm9tICcuLi8uLi9waHlzaWNzLXN5c3RlbSc7XHJcbmltcG9ydCB7IENvbXBvbmVudCwgZXJyb3IgfSBmcm9tICcuLi8uLi8uLi8uLi9jb3JlJztcclxuaW1wb3J0IHsgSUJhc2VTaGFwZSB9IGZyb20gJy4uLy4uLy4uL3NwZWMvaS1waHlzaWNzLXNoYXBlJztcclxuaW1wb3J0IHsgRURJVE9SLCBQSFlTSUNTX0JVSUxUSU4gfSBmcm9tICdpbnRlcm5hbDpjb25zdGFudHMnO1xyXG5cclxuLyoqXHJcbiAqIEBlblxyXG4gKiBCYXNlIGNsYXNzIG9mIGNvbGxpZGVyLlxyXG4gKiBAemhcclxuICog56Kw5pKe5Zmo55qE5Z+657G744CCXHJcbiAqL1xyXG5AY2NjbGFzcygnY2MuQ29sbGlkZXJDb21wb25lbnQnKVxyXG5leHBvcnQgY2xhc3MgQ29sbGlkZXJDb21wb25lbnQgZXh0ZW5kcyBFdmVudGlmeShDb21wb25lbnQpIHtcclxuXHJcbiAgICAvLy8gUFVCTElDIFBST1BFUlRZIEdFVFRFUlxcU0VUVEVSIC8vL1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBHZXRzIG9yIHNldHMgdGhlIHBoeXNpY2FsIG1hdGVyaWFsIGZvciB0aGlzIGNvbGxpZGVyLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDojrflj5bmiJborr7nva7mraTnorDmkp7lmajnmoTniannkIbmnZDotKjjgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0eXBlOiBQaHlzaWNNYXRlcmlhbCxcclxuICAgICAgICBkaXNwbGF5TmFtZTogJ01hdGVyaWFsJyxcclxuICAgICAgICBkaXNwbGF5T3JkZXI6IC0xLFxyXG4gICAgICAgIHRvb2x0aXA6ICfmupDmnZDotKgnLFxyXG4gICAgfSlcclxuICAgIHB1YmxpYyBnZXQgc2hhcmVkTWF0ZXJpYWwgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXRlcmlhbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IHNoYXJlZE1hdGVyaWFsICh2YWx1ZSkge1xyXG4gICAgICAgIGlmIChFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fbWF0ZXJpYWwgPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1hdGVyaWFsID0gdmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBHZXRzIG9yIHNldHMgdGhlIHBoeXNpY3MgbWF0ZXJpYWwgZm9yIHRoaXMgY29sbGlkZXIsIHdoaWNoIGluIFNoYXJlZCBzdGF0ZSB3aWxsIGdlbmVyYXRlIGEgbmV3IGluc3RhbmNlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDojrflj5bmiJborr7nva7mraTnorDmkp7lmajnmoTniannkIbmnZDotKjvvIzlhbHkuqvnirbmgIHkuIvojrflj5blsIbkvJrnlJ/miJDmlrDnmoTlrp7kvovjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBtYXRlcmlhbCAoKSB7XHJcbiAgICAgICAgaWYgKCFQSFlTSUNTX0JVSUxUSU4pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzU2hhcmVkTWF0ZXJpYWwgJiYgdGhpcy5fbWF0ZXJpYWwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWF0ZXJpYWwub2ZmKCdwaHlzaWNzX21hdGVyaWFsX3VwZGF0ZScsIHRoaXMuX3VwZGF0ZU1hdGVyaWFsLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsID0gdGhpcy5fbWF0ZXJpYWwuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsLm9uKCdwaHlzaWNzX21hdGVyaWFsX3VwZGF0ZScsIHRoaXMuX3VwZGF0ZU1hdGVyaWFsLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2lzU2hhcmVkTWF0ZXJpYWwgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fbWF0ZXJpYWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBtYXRlcmlhbCAodmFsdWUpIHtcclxuICAgICAgICBpZiAoIUVESVRPUikge1xyXG4gICAgICAgICAgICBpZiAoIVBIWVNJQ1NfQlVJTFRJTikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9IG51bGwgJiYgdGhpcy5fbWF0ZXJpYWwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tYXRlcmlhbC5fdXVpZCAhPSB2YWx1ZS5fdXVpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXRlcmlhbC5vZmYoJ3BoeXNpY3NfbWF0ZXJpYWxfdXBkYXRlJywgdGhpcy5fdXBkYXRlTWF0ZXJpYWwsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5vbigncGh5c2ljc19tYXRlcmlhbF91cGRhdGUnLCB0aGlzLl91cGRhdGVNYXRlcmlhbCwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzU2hhcmVkTWF0ZXJpYWwgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWF0ZXJpYWwgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlICE9IG51bGwgJiYgdGhpcy5fbWF0ZXJpYWwgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlLm9uKCdwaHlzaWNzX21hdGVyaWFsX3VwZGF0ZScsIHRoaXMuX3VwZGF0ZU1hdGVyaWFsLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXRlcmlhbCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBudWxsICYmIHRoaXMuX21hdGVyaWFsICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXRlcmlhbCEub2ZmKCdwaHlzaWNzX21hdGVyaWFsX3VwZGF0ZScsIHRoaXMuX3VwZGF0ZU1hdGVyaWFsLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXRlcmlhbCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlTWF0ZXJpYWwoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEdldHMgb3Igc2V0cyB0aGUgY29sbGlkZXIgaXMgdHJpZ2dlciwgdGhpcyB3aWxsIGJlIGFsd2F5cyB0cmlnZ2VyIGlmIHVzaW5nIGJ1aWx0aW4uXHJcbiAgICAgKiBAemhcclxuICAgICAqIOiOt+WPluaIluiuvue9rueisOaSnuWZqOaYr+WQpuS4uuinpuWPkeWZqO+8jOiLpeS9v+eUqCBidWlsdGluIO+8jOWxnuaAp+WAvOaXoOiuuuecn+WBhyDvvIzmraTnorDmkp7lmajpg73kuLrop6blj5HlmajjgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICBkaXNwbGF5T3JkZXI6IDAsXHJcbiAgICAgICAgdG9vbHRpcDogJ+aYr+WQpuS4juWFtuWug+eisOaSnuWZqOS6p+eUn+eisOaSnu+8jOW5tuS6p+eUn+eJqeeQhuihjOS4uicsXHJcbiAgICB9KVxyXG4gICAgcHVibGljIGdldCBpc1RyaWdnZXIgKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc1RyaWdnZXI7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBpc1RyaWdnZXIgKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5faXNUcmlnZ2VyID0gdmFsdWU7XHJcbiAgICAgICAgaWYgKCFFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUuc2V0QXNUcmlnZ2VyKHRoaXMuX2lzVHJpZ2dlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBHZXRzIG9yIHNldHMgdGhlIGNlbnRlciBvZiB0aGUgY29sbGlkZXIsIGluIGxvY2FsIHNwYWNlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDojrflj5bmiJborr7nva7norDmkp7lmajnmoTkuK3lv4PngrnjgIJcclxuICAgICAqL1xyXG4gICAgQHByb3BlcnR5KHtcclxuICAgICAgICB0eXBlOiBWZWMzLFxyXG4gICAgICAgIGRpc3BsYXlPcmRlcjogMSxcclxuICAgICAgICB0b29sdGlwOiAn5b2i54q255qE5Lit5b+D54K577yI5LiO5omA5ZyoIE5vZGUg5Lit5b+D54K555qE55u45a+55L2N572u77yJJyxcclxuICAgIH0pXHJcbiAgICBwdWJsaWMgZ2V0IGNlbnRlciAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NlbnRlcjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IGNlbnRlciAodmFsdWU6IFZlYzMpIHtcclxuICAgICAgICBWZWMzLmNvcHkodGhpcy5fY2VudGVyLCB2YWx1ZSk7XHJcbiAgICAgICAgaWYgKCFFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUuc2V0Q2VudGVyKHRoaXMuX2NlbnRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBHZXRzIHRoZSBjb2xsaWRlciBhdHRhY2hlZCByaWdpZC1ib2R5LCB0aGlzIG1heSBiZSBudWxsXHJcbiAgICAgKiBAemhcclxuICAgICAqIOiOt+WPlueisOaSnuWZqOaJgOe7keWumueahOWImuS9k+e7hOS7tu+8jOWPr+iDveS4uiBudWxsXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgYXR0YWNoZWRSaWdpZEJvZHkgKCk6IFJpZ2lkQm9keUNvbXBvbmVudCB8IG51bGwge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNoYXBlLmF0dGFjaGVkUmlnaWRCb2R5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBHZXRzIHRoZSB3cmFwcGVyIG9iamVjdCwgdGhyb3VnaCB3aGljaCB0aGUgbG93TGV2ZWwgaW5zdGFuY2UgY2FuIGJlIGFjY2Vzc2VkLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDojrflj5blsIHoo4Xlr7nosaHvvIzpgJrov4fmraTlr7nosaHlj6/ku6Xorr/pl67liLDlupXlsYLlrp7kvovjgIJcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBzaGFwZSAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NoYXBlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vLyBQUklWQVRFIFBST1BFUlRZIC8vL1xyXG5cclxuICAgIHByb3RlY3RlZCBfc2hhcGUhOiBJQmFzZVNoYXBlO1xyXG5cclxuICAgIHByb3RlY3RlZCBfaXNTaGFyZWRNYXRlcmlhbDogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gICAgQHByb3BlcnR5KHsgdHlwZTogUGh5c2ljTWF0ZXJpYWwgfSlcclxuICAgIHByb3RlY3RlZCBfbWF0ZXJpYWw6IFBoeXNpY01hdGVyaWFsIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgQHByb3BlcnR5XHJcbiAgICBwcm90ZWN0ZWQgX2lzVHJpZ2dlcjogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIEBwcm9wZXJ0eVxyXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IF9jZW50ZXI6IFZlYzMgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHByb3RlY3RlZCBnZXQgX2Fzc2VydE9ubG9hZCAoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgY29uc3QgciA9IHRoaXMuX2lzT25Mb2FkQ2FsbGVkID09IDA7XHJcbiAgICAgICAgaWYgKHIpIHsgZXJyb3IoJ1BoeXNpY3MgRXJyb3I6IFBsZWFzZSBtYWtlIHN1cmUgdGhhdCB0aGUgbm9kZSBoYXMgYmVlbiBhZGRlZCB0byB0aGUgc2NlbmUnKTsgfVxyXG4gICAgICAgIHJldHVybiAhcjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7IHN1cGVyKCkgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBSZWdpc3RlcnMgY2FsbGJhY2tzIGFzc29jaWF0ZWQgd2l0aCB0cmlnZ2VyZWQgb3IgY29sbGlzaW9uIGV2ZW50cy5cclxuICAgICAqIEB6aFxyXG4gICAgICog5rOo5YaM6Kem5Y+R5oiW56Kw5pKe5LqL5Lu255u45YWz55qE5Zue6LCD44CCXHJcbiAgICAgKiBAcGFyYW0gdHlwZSAtIFRoZSBldmVudCB0eXBlLCBvblRyaWdnZXJFbnRlcnxvblRyaWdnZXJTdGF5fG9uVHJpZ2dlckV4aXR8b25Db2xsaXNpb25FbnRlcnxvbkNvbGxpc2lvblN0YXl8b25Db2xsaXNpb25FeGl0O1xyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gVGhlIGV2ZW50IGNhbGxiYWNrLCBzaWduYXR1cmU6YChldmVudD86SUNvbGxpc2lvbkV2ZW50fElUcmlnZ2VyRXZlbnQpPT52b2lkYC5cclxuICAgICAqIEBwYXJhbSB0YXJnZXQgLSBUaGUgZXZlbnQgY2FsbGJhY2sgdGFyZ2V0LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb24gKHR5cGU6IFRyaWdnZXJFdmVudFR5cGUgfCBDb2xsaXNpb25FdmVudFR5cGUsIGNhbGxiYWNrOiBGdW5jdGlvbiwgdGFyZ2V0PzogT2JqZWN0LCBvbmNlPzogYm9vbGVhbik6IGFueSB7XHJcbiAgICAgICAgc3VwZXIub24odHlwZSwgY2FsbGJhY2ssIHRhcmdldCwgb25jZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFVucmVnaXN0ZXJzIGNhbGxiYWNrcyBhc3NvY2lhdGVkIHdpdGggdHJpZ2dlciBvciBjb2xsaXNpb24gZXZlbnRzIHRoYXQgaGF2ZSBiZWVuIHJlZ2lzdGVyZWQuXHJcbiAgICAgKiBAemhcclxuICAgICAqIOWPlua2iOW3sue7j+azqOWGjOeahOinpuWPkeaIlueisOaSnuS6i+S7tuebuOWFs+eahOWbnuiwg+OAglxyXG4gICAgICogQHBhcmFtIHR5cGUgLSBUaGUgZXZlbnQgdHlwZSwgb25UcmlnZ2VyRW50ZXJ8b25UcmlnZ2VyU3RheXxvblRyaWdnZXJFeGl0fG9uQ29sbGlzaW9uRW50ZXJ8b25Db2xsaXNpb25TdGF5fG9uQ29sbGlzaW9uRXhpdDtcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayAtIFRoZSBldmVudCBjYWxsYmFjaywgc2lnbmF0dXJlOmAoZXZlbnQ/OklDb2xsaXNpb25FdmVudHxJVHJpZ2dlckV2ZW50KT0+dm9pZGAuXHJcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IC0gVGhlIGV2ZW50IGNhbGxiYWNrIHRhcmdldC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG9mZiAodHlwZTogVHJpZ2dlckV2ZW50VHlwZSB8IENvbGxpc2lvbkV2ZW50VHlwZSwgY2FsbGJhY2s/OiBGdW5jdGlvbiwgdGFyZ2V0PzogT2JqZWN0KSB7XHJcbiAgICAgICAgc3VwZXIub2ZmKHR5cGUsIGNhbGxiYWNrLCB0YXJnZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBSZWdpc3RlcnMgYSBjYWxsYmFjayBhc3NvY2lhdGVkIHdpdGggYSB0cmlnZ2VyIG9yIGNvbGxpc2lvbiBldmVudCwgd2hpY2ggaXMgYXV0b21hdGljYWxseSB1bnJlZ2lzdGVyZWQgb25jZSBleGVjdXRlZC5cclxuICAgICAqIEB6aFxyXG4gICAgICog5rOo5YaM6Kem5Y+R5oiW56Kw5pKe5LqL5Lu255u45YWz55qE5Zue6LCD77yM5omn6KGM5LiA5qyh5ZCO5Lya6Ieq5Yqo5Y+W5raI5rOo5YaM44CCXHJcbiAgICAgKiBAcGFyYW0gdHlwZSAtIFRoZSBldmVudCB0eXBlLCBvblRyaWdnZXJFbnRlcnxvblRyaWdnZXJTdGF5fG9uVHJpZ2dlckV4aXR8b25Db2xsaXNpb25FbnRlcnxvbkNvbGxpc2lvblN0YXl8b25Db2xsaXNpb25FeGl0O1xyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gVGhlIGV2ZW50IGNhbGxiYWNrLCBzaWduYXR1cmU6YChldmVudD86SUNvbGxpc2lvbkV2ZW50fElUcmlnZ2VyRXZlbnQpPT52b2lkYC5cclxuICAgICAqIEBwYXJhbSB0YXJnZXQgLSBUaGUgZXZlbnQgY2FsbGJhY2sgdGFyZ2V0LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgb25jZSAodHlwZTogVHJpZ2dlckV2ZW50VHlwZSB8IENvbGxpc2lvbkV2ZW50VHlwZSwgY2FsbGJhY2s6IEZ1bmN0aW9uLCB0YXJnZXQ/OiBPYmplY3QpOiBhbnkge1xyXG4gICAgICAgIHN1cGVyLm9uY2UodHlwZSwgY2FsbGJhY2ssIHRhcmdldCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8vIEdST1VQIE1BU0sgLy8vXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFNldHMgdGhlIGdyb3VwIHZhbHVlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDorr7nva7liIbnu4TlgLzjgIJcclxuICAgICAqIEBwYXJhbSB2IC0g5pW05pWw77yM6IyD5Zu05Li6IDIg55qEIDAg5qyh5pa5IOWIsCAyIOeahCAzMSDmrKHmlrlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldEdyb3VwICh2OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9zaGFwZSEuc2V0R3JvdXAodik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEdldHMgdGhlIGdyb3VwIHZhbHVlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDojrflj5bliIbnu4TlgLzjgIJcclxuICAgICAqIEByZXR1cm5zIOaVtOaVsO+8jOiMg+WbtOS4uiAyIOeahCAwIOasoeaWuSDliLAgMiDnmoQgMzEg5qyh5pa5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRHcm91cCAoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hhcGUuZ2V0R3JvdXAoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogQWRkIGEgZ3JvdXBpbmcgdmFsdWUgdG8gZmlsbCBpbiB0aGUgZ3JvdXAgeW91IHdhbnQgdG8gam9pbi5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5YiG57uE5YC877yM5Y+v5aGr6KaB5Yqg5YWl55qEIGdyb3Vw44CCXHJcbiAgICAgKiBAcGFyYW0gdiAtIOaVtOaVsO+8jOiMg+WbtOS4uiAyIOeahCAwIOasoeaWuSDliLAgMiDnmoQgMzEg5qyh5pa5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRHcm91cCAodjogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc2hhcGUuYWRkR3JvdXAodik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIFN1YnRyYWN0IHRoZSBncm91cGluZyB2YWx1ZSB0byBmaWxsIGluIHRoZSBncm91cCB0byBiZSByZW1vdmVkLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDlh4/ljrvliIbnu4TlgLzvvIzlj6/loavopoHnp7vpmaTnmoQgZ3JvdXDjgIJcclxuICAgICAqIEBwYXJhbSB2IC0g5pW05pWw77yM6IyD5Zu05Li6IDIg55qEIDAg5qyh5pa5IOWIsCAyIOeahCAzMSDmrKHmlrlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZUdyb3VwICh2OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zaGFwZS5yZW1vdmVHcm91cCh2KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBlblxyXG4gICAgICogR2V0cyB0aGUgbWFzayB2YWx1ZS5cclxuICAgICAqIEB6aFxyXG4gICAgICog6I635Y+W5o6p56CB5YC844CCXHJcbiAgICAgKiBAcmV0dXJucyDmlbTmlbDvvIzojIPlm7TkuLogMiDnmoQgMCDmrKHmlrkg5YiwIDIg55qEIDMxIOasoeaWuVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0TWFzayAoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hhcGUuZ2V0TWFzaygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTZXRzIHRoZSBtYXNrIHZhbHVlLlxyXG4gICAgICogQHpoXHJcbiAgICAgKiDorr7nva7mjqnnoIHlgLzjgIJcclxuICAgICAqIEBwYXJhbSB2IC0g5pW05pWw77yM6IyD5Zu05Li6IDIg55qEIDAg5qyh5pa5IOWIsCAyIOeahCAzMSDmrKHmlrlcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldE1hc2sgKHY6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX3NoYXBlLnNldE1hc2sodik7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW5cclxuICAgICAqIEFkZCBtYXNrIHZhbHVlcyB0byBmaWxsIGluIGdyb3VwcyB0aGF0IG5lZWQgdG8gYmUgY2hlY2tlZC5cclxuICAgICAqIEB6aFxyXG4gICAgICog5re75Yqg5o6p56CB5YC877yM5Y+v5aGr5YWl6ZyA6KaB5qOA5p+l55qEIGdyb3Vw44CCXHJcbiAgICAgKiBAcGFyYW0gdiAtIOaVtOaVsO+8jOiMg+WbtOS4uiAyIOeahCAwIOasoeaWuSDliLAgMiDnmoQgMzEg5qyh5pa5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGRNYXNrICh2OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zaGFwZS5hZGRNYXNrKHYpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuXHJcbiAgICAgKiBTdWJ0cmFjdCB0aGUgbWFzayB2YWx1ZSB0byBmaWxsIGluIHRoZSBncm91cCB0aGF0IGRvZXMgbm90IG5lZWQgdG8gYmUgY2hlY2tlZC5cclxuICAgICAqIEB6aFxyXG4gICAgICog5YeP5Y675o6p56CB5YC877yM5Y+v5aGr5YWl5LiN6ZyA6KaB5qOA5p+l55qEIGdyb3Vw44CCXHJcbiAgICAgKiBAcGFyYW0gdiAtIOaVtOaVsO+8jOiMg+WbtOS4uiAyIOeahCAwIOasoeaWuSDliLAgMiDnmoQgMzEg5qyh5pa5XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZW1vdmVNYXNrICh2OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zaGFwZS5yZW1vdmVNYXNrKHYpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vLyBDT01QT05FTlQgTElGRUNZQ0xFIC8vL1xyXG5cclxuICAgIHByb3RlY3RlZCBfX3ByZWxvYWQgKCkge1xyXG4gICAgICAgIGlmICghRURJVE9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NoYXBlLmluaXRpYWxpemUodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBvbkxvYWQgKCkge1xyXG4gICAgICAgIGlmICghRURJVE9SKSB7XHJcbiAgICAgICAgICAgIGlmICghUEhZU0lDU19CVUlMVElOKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZE1hdGVyaWFsID0gdGhpcy5fbWF0ZXJpYWwgPT0gbnVsbCA/IFBoeXNpY3NTeXN0ZW0uaW5zdGFuY2UuZGVmYXVsdE1hdGVyaWFsIDogdGhpcy5fbWF0ZXJpYWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUub25Mb2FkISgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9uRW5hYmxlICgpIHtcclxuICAgICAgICBpZiAoIUVESVRPUikge1xyXG4gICAgICAgICAgICB0aGlzLl9zaGFwZS5vbkVuYWJsZSEoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIG9uRGlzYWJsZSAoKSB7XHJcbiAgICAgICAgaWYgKCFFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUub25EaXNhYmxlISgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgb25EZXN0cm95ICgpIHtcclxuICAgICAgICBpZiAoIUVESVRPUikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbWF0ZXJpYWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21hdGVyaWFsLm9mZigncGh5c2ljc19tYXRlcmlhbF91cGRhdGUnLCB0aGlzLl91cGRhdGVNYXRlcmlhbCwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUub25EZXN0cm95ISgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF91cGRhdGVNYXRlcmlhbCAoKSB7XHJcbiAgICAgICAgaWYgKCFFRElUT1IpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hhcGUuc2V0TWF0ZXJpYWwodGhpcy5fbWF0ZXJpYWwpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuIl19